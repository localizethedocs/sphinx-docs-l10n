<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>HTML theme development &#8212; Sphinx documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=29da98fa" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx13.css?v=ba1752c5" />
    <script src="../../_static/documentation_options.js?v=cafd1c67"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=beaddf03"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/sphinx-docs-l10n/development/html_themes/index.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Sphinx documentation 中搜索"
          href="../../_static/opensearch.xml"/>
    <link rel="icon" href="../../_static/favicon.svg"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="Templating" href="templating.html" />
    <link rel="prev" title="Configuring builders" href="../howtos/builders.html" />

 

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="github" viewBox="0 0 16 16">
    <title>GitHub</title>
    <svg
      stroke="currentColor"
      fill="currentColor"
      stroke-width="0"
      viewBox="0 0 16 16"
    >
      <path
        fill-rule="evenodd"
        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
      ></path>
    </svg>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<div class="pageheader">
  <div class="brand">
    <a href="../../index.html">
      <img src="../../_static/sphinx-logo.svg" alt="logo" />
      <span>Sphinx</span>
    </a>
  </div>
  <div class="icons">
    <a href="https://github.com/sphinx-doc/sphinx" title="Source Code" target="_blank">
      <svg><use href="#github"></use></svg>
    </a>
  </div>
</div>

<div class="related" role="navigation" aria-label="Related">
  <h3>导航</h3>
  <ul>
    <li><a href="../../index.html">Documentation</a> &raquo;</li>
      <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Extending Sphinx</a> &#187;</li>
    <li class="nav-item nav-item-this"><a href="">HTML theme development</a></li>
  </ul>
</div>

<div class="document">
  <div class="sphinxsidebar" role="navigation" aria-label="Main">
<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
      <div class="sphinxsidebar-navigation__contents">
        <h3>On this page</h3>
        <ul>
<li><a class="reference internal" href="#">HTML theme development</a><ul>
<li><a class="reference internal" href="#creating-themes">Creating themes</a><ul>
<li><a class="reference internal" href="#theme-configuration-theme-toml">Theme configuration (<code class="docutils literal notranslate"><span class="pre">theme.toml</span></code>)</a></li>
<li><a class="reference internal" href="#theme-configuration-theme-conf">Theme configuration (<code class="docutils literal notranslate"><span class="pre">theme.conf</span></code>)</a></li>
<li><a class="reference internal" href="#convert-theme-conf-to-theme-toml">Convert <code class="docutils literal notranslate"><span class="pre">theme.conf</span></code> to <code class="docutils literal notranslate"><span class="pre">theme.toml</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#distribute-your-theme-as-a-python-package">Distribute your theme as a Python package</a></li>
<li><a class="reference internal" href="#styling-with-css">Styling with CSS</a><ul>
<li><a class="reference internal" href="#styling-search-result-entries-by-category">Styling search result entries by category</a></li>
</ul>
</li>
<li><a class="reference internal" href="#templating">Templating</a><ul>
<li><a class="reference internal" href="#static-templates">Static templates</a></li>
<li><a class="reference internal" href="#use-custom-page-metadata-in-html-templates">Use custom page metadata in HTML templates</a></li>
<li><a class="reference internal" href="#defining-custom-template-functions">Defining custom template functions</a></li>
<li><a class="reference internal" href="#add-your-own-static-files-to-the-build-assets">Add your own static files to the build assets</a></li>
<li><a class="reference internal" href="#inject-javascript-based-on-user-configuration">Inject JavaScript based on user configuration</a></li>
</ul>
</li>
</ul>
</li>
</ul>

      </div>
    <div class="sphinxsidebar-navigation__pages">
      <p class="caption" role="heading"><span class="caption-text">The Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/installation.html">Installing Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/quickstart.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Build your first project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../usage/index.html">Using Sphinx</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Extending Sphinx</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../howtos/index.html">How-tos</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">HTML theme development</a><ul>
<li class="toctree-l3"><a class="reference internal" href="templating.html">Templating</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../extdev/index.html">Sphinx API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../latex.html">LaTeX customization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Get support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internals/index.html">Contribute to Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Sphinx FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Sphinx authors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../man/index.html">Command-line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/extensions/index.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/restructuredtext/index.html">reStructuredText</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Projects using Sphinx</a></li>
</ul>

    </div>
  </div>
  <div class="body" role="main">
    
  <section id="html-theme-development">
<span id="extension-html-theme"></span><h1>HTML theme development<a class="headerlink" href="#html-theme-development" title="Link to this heading">¶</a></h1>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 0.6.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>This document provides information about creating your own theme. If you
simply wish to use a pre-existing HTML themes, refer to
<a class="reference internal" href="../../usage/theming.html"><span class="doc">HTML theming</span></a>.</p>
</div>
<p>Sphinx supports changing the appearance of its HTML output via <em>themes</em>.  A
theme is a collection of HTML templates, stylesheet(s) and other static files.
Additionally, it has a configuration file which specifies from which theme to
inherit, which highlighting style to use, and what options exist for customizing
the theme's look and feel.</p>
<p>Themes are meant to be project-unaware, so they can be used for different
projects without change.</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>See <a class="reference internal" href="../../extdev/index.html#dev-extensions"><span class="std std-ref">Sphinx API</span></a> for more information that may
be helpful in developing themes.</p>
</div>
<section id="creating-themes">
<h2>Creating themes<a class="headerlink" href="#creating-themes" title="Link to this heading">¶</a></h2>
<p>Themes take the form of either a directory or a zipfile (whose name is the
theme name), containing the following:</p>
<ul class="simple">
<li><p>Either a <code class="file docutils literal notranslate"><span class="pre">theme.toml</span></code> file (preferred) or a <code class="file docutils literal notranslate"><span class="pre">theme.conf</span></code> file.</p></li>
<li><p>HTML templates, if needed.</p></li>
<li><p>A <code class="docutils literal notranslate"><span class="pre">static/</span></code> directory containing any static files that will be copied to the
output static directory on build.  These can be images, styles, script files.</p></li>
</ul>
<section id="theme-configuration-theme-toml">
<h3>Theme configuration (<code class="docutils literal notranslate"><span class="pre">theme.toml</span></code>)<a class="headerlink" href="#theme-configuration-theme-toml" title="Link to this heading">¶</a></h3>
<p>The <code class="file docutils literal notranslate"><span class="pre">theme.toml</span></code> file is a <a class="reference external" href="https://toml.io/en/">TOML</a> document,
containing two tables: <code class="docutils literal notranslate"><span class="pre">[theme]</span></code> and <code class="docutils literal notranslate"><span class="pre">[options]</span></code>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">[theme]</span></code> table defines the theme's settings:</p>
<ul>
<li><p><strong>inherit</strong> (string): The name of the base theme from which to inherit
settings, options, templates, and static files.
All static files from theme 'ancestors' will be used.
The theme will use all options defined in inherited themes.
Finally, inherited themes will be used to locate missing templates
(for example, if <code class="docutils literal notranslate"><span class="pre">&quot;basic&quot;</span></code> is used as the base theme, most templates will
already be defined).</p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">&quot;none&quot;</span></code>, the theme will not inherit from any other theme.
Inheritance is recursive, forming a chain of inherited themes
(e.g. <code class="docutils literal notranslate"><span class="pre">default</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">classic</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">basic</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">none</span></code>).</p>
</li>
<li><p><strong>stylesheets</strong> (list of strings): A list of CSS filenames which will be
included in generated HTML header.
Setting the   <a class="reference internal" href="../../usage/configuration.html#confval-html_style"><code class="xref std std-confval docutils literal notranslate"><span class="pre">html_style</span></code></a> config value will override this setting.</p>
<p>Other mechanisms for including multiple stylesheets include <code class="docutils literal notranslate"><span class="pre">&#64;import</span></code> in CSS
or using a custom HTML template with appropriate <code class="docutils literal notranslate"><span class="pre">&lt;link</span> <span class="pre">rel=&quot;stylesheet&quot;&gt;</span></code> tags.</p>
</li>
<li><p><strong>sidebars</strong> (list of strings): A list of sidebar templates.
This can be overridden by the user via the <a class="reference internal" href="../../usage/configuration.html#confval-html_sidebars"><code class="xref std std-confval docutils literal notranslate"><span class="pre">html_sidebars</span></code></a> config value.</p></li>
<li><p><strong>pygments_style</strong> (table): A TOML table defining the names of Pygments styles
to use for highlighting syntax.
The table has two recognised keys: <code class="docutils literal notranslate"><span class="pre">default</span></code> and <code class="docutils literal notranslate"><span class="pre">dark</span></code>.
The style defined in the <code class="docutils literal notranslate"><span class="pre">dark</span></code> key will be used when
the CSS media query <code class="docutils literal notranslate"><span class="pre">(prefers-color-scheme:</span> <span class="pre">dark)</span></code> evaluates to true.</p>
<p><code class="docutils literal notranslate"><span class="pre">[theme.pygments_style.default]</span></code> can be overridden by the user via the
<a class="reference internal" href="../../usage/configuration.html#confval-pygments_style"><code class="xref std std-confval docutils literal notranslate"><span class="pre">pygments_style</span></code></a> config value.</p>
</li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">[options]</span></code> table defines the options for the theme.
It is structured such that each key-value pair corresponds to a variable name
and the corresponding default value.
These options can be overridden by the user in <a class="reference internal" href="../../usage/configuration.html#confval-html_theme_options"><code class="xref std std-confval docutils literal notranslate"><span class="pre">html_theme_options</span></code></a>
and are accessible from all templates as <code class="docutils literal notranslate"><span class="pre">theme_&lt;name&gt;</span></code>.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 7.3: </span><code class="docutils literal notranslate"><span class="pre">theme.toml</span></code> support.</p>
</div>
<p>Exemplar <code class="file docutils literal notranslate"><span class="pre">theme.toml</span></code> file:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[theme]</span>
<span class="n">inherit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;basic&quot;</span>
<span class="n">stylesheets</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;main-CSS-stylesheet.css&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="n">sidebars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="s2">&quot;localtoc.html&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;relations.html&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;sourcelink.html&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s2">&quot;searchbox.html&quot;</span><span class="p">,</span>
<span class="p">]</span>
<span class="c1"># Style names from https://pygments.org/styles/</span>
<span class="n">pygments_style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">default</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;style_name&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dark</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;dark_style&quot;</span><span class="w"> </span><span class="p">}</span>

<span class="k">[options]</span>
<span class="n">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;default value&quot;</span>
</pre></div>
</div>
</section>
<section id="theme-configuration-theme-conf">
<h3>Theme configuration (<code class="docutils literal notranslate"><span class="pre">theme.conf</span></code>)<a class="headerlink" href="#theme-configuration-theme-conf" title="Link to this heading">¶</a></h3>
<p>The <code class="file docutils literal notranslate"><span class="pre">theme.conf</span></code> file is in INI format <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> (readable by the standard
Python <a class="reference external" href="https://docs.python.org/3/library/configparser.html#module-configparser" title="（在 Python v3.14）"><code class="xref py py-mod docutils literal notranslate"><span class="pre">configparser</span></code></a> module) and has the following structure:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[theme]</span>
<span class="na">inherit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">base theme</span>
<span class="na">stylesheet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">main CSS name</span>
<span class="na">pygments_style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">stylename</span>
<span class="na">sidebars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">localtoc.html, relations.html, sourcelink.html, searchbox.html</span>

<span class="k">[options]</span>
<span class="na">variable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">default value</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The <strong>inherit</strong> setting gives the name of a &quot;base theme&quot;, or <code class="docutils literal notranslate"><span class="pre">none</span></code>.  The
base theme will be used to locate missing templates (most themes will not have
to supply most templates if they use <code class="docutils literal notranslate"><span class="pre">basic</span></code> as the base theme), its options
will be inherited, and all of its static files will be used as well. If you
want to also inherit the stylesheet, include it via CSS' <code class="docutils literal notranslate"><span class="pre">&#64;import</span></code> in your
own.</p></li>
<li><p>The <strong>stylesheet</strong> setting gives a list of CSS filenames separated commas which
will be referenced in the HTML header.  You can also use CSS' <code class="docutils literal notranslate"><span class="pre">&#64;import</span></code>
technique to include one from the other, or use a custom HTML template that
adds <code class="docutils literal notranslate"><span class="pre">&lt;link</span> <span class="pre">rel=&quot;stylesheet&quot;&gt;</span></code> tags as necessary.  Setting the
<a class="reference internal" href="../../usage/configuration.html#confval-html_style"><code class="xref std std-confval docutils literal notranslate"><span class="pre">html_style</span></code></a> config value will override this setting.</p></li>
<li><p>The <strong>pygments_style</strong> setting gives the name of a Pygments style to use for
highlighting.  This can be overridden by the user in the
<a class="reference internal" href="../../usage/configuration.html#confval-pygments_style"><code class="xref std std-confval docutils literal notranslate"><span class="pre">pygments_style</span></code></a> config value.</p></li>
<li><p>The <strong>pygments_dark_style</strong> setting gives the name of a Pygments style to use
for highlighting when the CSS media query <code class="docutils literal notranslate"><span class="pre">(prefers-color-scheme:</span> <span class="pre">dark)</span></code>
evaluates to true. It is injected into the page using
<a class="reference internal" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_css_file" title="sphinx.application.Sphinx.add_css_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_css_file()</span></code></a>.</p></li>
<li><p>The <strong>sidebars</strong> setting gives the comma separated list of sidebar templates
for constructing sidebars.  This can be overridden by the user in the
<a class="reference internal" href="../../usage/configuration.html#confval-html_sidebars"><code class="xref std std-confval docutils literal notranslate"><span class="pre">html_sidebars</span></code></a> config value.</p></li>
<li><p>The <strong>options</strong> section contains pairs of variable names and default values.
These options can be overridden by the user in <a class="reference internal" href="../../usage/configuration.html#confval-html_theme_options"><code class="xref std std-confval docutils literal notranslate"><span class="pre">html_theme_options</span></code></a>
and are accessible from all templates as <code class="docutils literal notranslate"><span class="pre">theme_&lt;name&gt;</span></code>.</p></li>
</ul>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.7: </span>sidebar settings</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified changed">在 5.1 版本发生变更: </span>The stylesheet setting accepts multiple CSS filenames</p>
</div>
</section>
<section id="convert-theme-conf-to-theme-toml">
<h3>Convert <code class="docutils literal notranslate"><span class="pre">theme.conf</span></code> to <code class="docutils literal notranslate"><span class="pre">theme.toml</span></code><a class="headerlink" href="#convert-theme-conf-to-theme-toml" title="Link to this heading">¶</a></h3>
<p>INI-style theme configuration files (<code class="docutils literal notranslate"><span class="pre">theme.conf</span></code>) can be converted to TOML
via a helper programme distributed with Sphinx.
This is intended for one-time use, and may be removed without notice in a future
version of Sphinx.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>sphinx.theming<span class="w"> </span>conf_to_toml<span class="w"> </span><span class="o">[</span>THEME<span class="w"> </span>DIRECTORY<span class="w"> </span>PATH<span class="o">]</span>
</pre></div>
</div>
<p>The required argument is a path to a directory containing a <code class="docutils literal notranslate"><span class="pre">theme.conf</span></code> file.
The programme will write a <code class="docutils literal notranslate"><span class="pre">theme.toml</span></code> file in the same directory,
and will not modify the original <code class="docutils literal notranslate"><span class="pre">theme.conf</span></code> file.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 7.3.</span></p>
</div>
</section>
</section>
<section id="distribute-your-theme-as-a-python-package">
<span id="distribute-your-theme"></span><h2>Distribute your theme as a Python package<a class="headerlink" href="#distribute-your-theme-as-a-python-package" title="Link to this heading">¶</a></h2>
<p>As a way to distribute your theme, you can use a Python package.  This makes it
easier for users to set up your theme.</p>
<p>To distribute your theme as a Python package, please define an entry point
called <code class="docutils literal notranslate"><span class="pre">sphinx.html_themes</span></code> in your <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> file,
and write a <code class="docutils literal notranslate"><span class="pre">setup()</span></code> function to register your theme
using the <a class="reference internal" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_html_theme" title="sphinx.application.Sphinx.add_html_theme"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_html_theme()</span></code></a> API:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="c1"># pyproject.toml</span>

<span class="k">[project.entry-points.</span><span class="s2">&quot;sphinx.html_themes&quot;</span><span class="k">]</span>
<span class="n">name_of_theme</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;your_theme_package&quot;</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># your_theme_package.py</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>

<span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_html_theme</span><span class="p">(</span><span class="s1">&#39;name_of_theme&#39;</span><span class="p">,</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
</pre></div>
</div>
<p>If your theme package contains two or more themes, please call
<code class="docutils literal notranslate"><span class="pre">add_html_theme()</span></code> twice or more.</p>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.2: </span>'sphinx_themes' entry_points feature.</p>
</div>
<div class="deprecated">
<p><span class="versionmodified deprecated">自 1.6 版本弃用: </span><code class="docutils literal notranslate"><span class="pre">sphinx_themes</span></code> entry_points has been deprecated.</p>
</div>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 1.6: </span><code class="docutils literal notranslate"><span class="pre">sphinx.html_themes</span></code> entry_points feature.</p>
</div>
</section>
<section id="styling-with-css">
<h2>Styling with CSS<a class="headerlink" href="#styling-with-css" title="Link to this heading">¶</a></h2>
<p>The <code class="xref std std-confval docutils literal notranslate"><span class="pre">stylesheets</span></code> setting can be used to add custom CSS files to a theme.</p>
<div class="admonition caution">
<p class="admonition-title">小心</p>
<p>The structure of the HTML elements and their classes are currently not a
well-defined public API. Please infer them from inspecting the built HTML
pages. While we cannot guarantee full stability, they tend to be fairly
stable.</p>
</div>
<section id="styling-search-result-entries-by-category">
<h3>Styling search result entries by category<a class="headerlink" href="#styling-search-result-entries-by-category" title="Link to this heading">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified added">Added in version 8.0.</span></p>
</div>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The CSS classes named below are generated by Sphinx's standalone search
code.  If you are using a third-party search provider, such as
<a class="reference external" href="https://docs.readthedocs.io/">ReadTheDocs</a>, to provide search results, then the theming options available
may vary.</p>
</div>
<p>The search result items have classes indicating the context in which the
search term was found. You can use the CSS selectors:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ul.search</span> <span class="pre">li.kind-index</span></code>:
For results in an index, such as the glossary</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ul.search</span> <span class="pre">li.kind-object</span></code>:
For results in source code, like Python function definitions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ul.search</span> <span class="pre">li.kind-title</span></code>:
For results found in section headings</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ul.search</span> <span class="pre">li.kind-text</span></code>:
For results found anywhere else in the documentation text</p></li>
</ul>
<p>As a base for inheritance by other themes, the <code class="docutils literal notranslate"><span class="pre">basic</span></code> theme is
intentionally minimal and does not define CSS rules using these.
Derived themes are encouraged to use these selectors as they see fit.
For example, the following stylesheet adds contextual icons to the
search result list:</p>
<div class="highlight-css notranslate"><div class="highlight"><pre><span></span><span class="nt">ul</span><span class="p">.</span><span class="nc">search</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding-left</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
<span class="nt">ul</span><span class="p">.</span><span class="nc">search</span><span class="w"> </span><span class="nt">li</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">padding</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">5</span><span class="kt">px</span><span class="w"> </span><span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="w">    </span><span class="k">list-style-type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\25A1&quot;</span><span class="p">;</span><span class="w">  </span><span class="c">/* Unicode: White Square */</span>
<span class="p">}</span>
<span class="nt">ul</span><span class="p">.</span><span class="nc">search</span><span class="w"> </span><span class="nt">li</span><span class="p">.</span><span class="nc">kind-index</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">list-style-type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\1F4D1&quot;</span><span class="p">;</span><span class="w">  </span><span class="c">/* Unicode: Bookmark Tabs */</span>
<span class="p">}</span>
<span class="nt">ul</span><span class="p">.</span><span class="nc">search</span><span class="w"> </span><span class="nt">li</span><span class="p">.</span><span class="nc">kind-object</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">list-style-type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\1F4E6&quot;</span><span class="p">;</span><span class="w">  </span><span class="c">/* Unicode: Package */</span>
<span class="p">}</span>
<span class="nt">ul</span><span class="p">.</span><span class="nc">search</span><span class="w"> </span><span class="nt">li</span><span class="p">.</span><span class="nc">kind-title</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">list-style-type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\1F4C4&quot;</span><span class="p">;</span><span class="w">  </span><span class="c">/* Unicode: Page Facing Up */</span>
<span class="p">}</span>
<span class="nt">ul</span><span class="p">.</span><span class="nc">search</span><span class="w"> </span><span class="nt">li</span><span class="p">.</span><span class="nc">kind-text</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">list-style-type</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;\1F4C4&quot;</span><span class="p">;</span><span class="w">  </span><span class="c">/* Unicode: Page Facing Up */</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="templating">
<h2>Templating<a class="headerlink" href="#templating" title="Link to this heading">¶</a></h2>
<div class="toctree-wrapper compound">
</div>
<p>The <a class="reference internal" href="templating.html"><span class="doc">guide to templating</span></a> is helpful if you want to write your
own templates.  What is important to keep in mind is the order in which Sphinx
searches for templates:</p>
<ul class="simple">
<li><p>First, in the user's <code class="docutils literal notranslate"><span class="pre">templates_path</span></code> directories.</p></li>
<li><p>Then, in the selected theme.</p></li>
<li><p>Then, in its base theme, its base's base theme, etc.</p></li>
</ul>
<p>When extending a template in the base theme with the same name, use the theme
name as an explicit directory: <code class="docutils literal notranslate"><span class="pre">{%</span> <span class="pre">extends</span> <span class="pre">&quot;basic/layout.html&quot;</span> <span class="pre">%}</span></code>.  From a
user <code class="docutils literal notranslate"><span class="pre">templates_path</span></code> template, you can still use the &quot;exclamation mark&quot;
syntax as <a class="reference internal" href="templating.html#templating-primer"><span class="std std-ref">described in the templating document</span></a>.</p>
<section id="static-templates">
<span id="theming-static-templates"></span><h3>Static templates<a class="headerlink" href="#static-templates" title="Link to this heading">¶</a></h3>
<p>Since theme options are meant for the user to configure a theme more easily,
without having to write a custom stylesheet, it is necessary to be able to
template static files as well as HTML files.  Therefore, Sphinx supports
so-called &quot;static templates&quot;, like this:</p>
<p>If the name of a file in the <code class="docutils literal notranslate"><span class="pre">static/</span></code> directory of a theme (or in the user's
static path) ends with <code class="docutils literal notranslate"><span class="pre">.jinja</span></code> or <code class="docutils literal notranslate"><span class="pre">_t</span></code>, it will be processed by the
template engine.  The suffix will be removed from the final file name.</p>
<p>For example, a theme with a <code class="docutils literal notranslate"><span class="pre">static/theme_styles.css.jinja</span></code> file could use
templating to put options into the stylesheet.
When a documentation project is built with that theme,
the output directory will contain a <code class="docutils literal notranslate"><span class="pre">_static/theme_styles.css</span></code> file
where all template tags have been processed.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">在 7.4 版本发生变更: </span></p>
<blockquote>
<div><p>The preferred suffix for static templates is now <code class="docutils literal notranslate"><span class="pre">.jinja</span></code>, in line with
the Jinja project's <a class="reference external" href="https://jinja.palletsprojects.com/en/latest/templates/#template-file-extension">recommended file extension</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">_t</span></code> file suffix for static templates is now considered 'legacy', and
support may eventually be removed.</p>
<p>If a static template with either a <code class="docutils literal notranslate"><span class="pre">_t</span></code> suffix or a <code class="docutils literal notranslate"><span class="pre">.jinja</span></code> suffix is
detected, it will be processed by the template engine, with the suffix
removed from the final file name.</p>
</div></blockquote>
</div>
</section>
<section id="use-custom-page-metadata-in-html-templates">
<h3>Use custom page metadata in HTML templates<a class="headerlink" href="#use-custom-page-metadata-in-html-templates" title="Link to this heading">¶</a></h3>
<p>Any key / value pairs in <a class="reference internal" href="../../usage/restructuredtext/field-lists.html"><span class="doc">field lists</span></a>
that are placed <em>before</em> the page's title will be available to the Jinja
template when building the page within the <a class="reference internal" href="templating.html#meta" title="meta"><code class="xref py py-data docutils literal notranslate"><span class="pre">meta</span></code></a> attribute. For example,
if a page had the following text before its first title:</p>
<div class="highlight-rst notranslate"><div class="highlight"><pre><span></span><span class="nc">:mykey:</span> My value

<span class="gh">My first title</span>
<span class="gh">--------------</span>
</pre></div>
</div>
<p>Then it could be accessed within a Jinja template like so:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="cp">{%</span>- <span class="k">if</span> <span class="nv">meta</span> <span class="k">is</span> <span class="nf">mapping</span> <span class="cp">%}</span>
<span class="x">    </span><span class="cp">{{</span> <span class="nv">meta.get</span><span class="o">(</span><span class="s2">&quot;mykey&quot;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="cp">{%</span>- <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>Note the check that <code class="docutils literal notranslate"><span class="pre">meta</span></code> is a dictionary (&quot;mapping&quot; in Jinja
terminology) to ensure that using it in this way is valid.</p>
</section>
<section id="defining-custom-template-functions">
<h3>Defining custom template functions<a class="headerlink" href="#defining-custom-template-functions" title="Link to this heading">¶</a></h3>
<p>Sometimes it is useful to define your own function in Python that you wish to
then use in a template. For example, if you'd like to insert a template value
with logic that depends on the user's configuration in the project, or if you'd
like to include non-trivial checks and provide friendly error messages for
incorrect configuration in the template.</p>
<p>To define your own template function, you'll need to define two functions
inside your module:</p>
<ul class="simple">
<li><p>A <strong>page context event handler</strong> (or <strong>registration</strong>) function. This is
connected to the <a class="reference internal" href="../../extdev/appapi.html#sphinx.application.Sphinx" title="sphinx.application.Sphinx"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sphinx</span></code></a> application via an event callback.</p></li>
<li><p>A <strong>template function</strong> that you will use in your Jinja template.</p></li>
</ul>
<p>First, define the registration function, which accepts the arguments for
<a class="reference internal" href="../../extdev/event_callbacks.html#event-html-page-context"><code class="xref std std-event docutils literal notranslate"><span class="pre">html-page-context</span></code></a>.</p>
<p>Within the registration function, define the template function that you'd like to
use within Jinja. The template function should return a string or Python objects
(lists, dictionaries) with strings inside that Jinja uses in the templating process</p>
<div class="admonition note">
<p class="admonition-title">备注</p>
<p>The template function will have access to all of the variables that
are passed to the registration function.</p>
</div>
<p>At the end of the registration function, add the template function to the
Sphinx application's context with <code class="docutils literal notranslate"><span class="pre">context['template_func']</span> <span class="pre">=</span> <span class="pre">template_func</span></code>.</p>
<p>Finally, in your extension's <code class="docutils literal notranslate"><span class="pre">setup()</span></code> function, add your registration
function as a callback for <a class="reference internal" href="../../extdev/event_callbacks.html#event-html-page-context"><code class="xref std std-event docutils literal notranslate"><span class="pre">html-page-context</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The registration function</span>
 <span class="k">def</span><span class="w"> </span><span class="nf">setup_my_func</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">pagename</span><span class="p">,</span> <span class="n">templatename</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">doctree</span><span class="p">):</span>
     <span class="c1"># The template function</span>
     <span class="k">def</span><span class="w"> </span><span class="nf">my_func</span><span class="p">(</span><span class="n">mystring</span><span class="p">):</span>
         <span class="k">return</span> <span class="s2">&quot;Your string is </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">mystring</span>
     <span class="c1"># Add it to the page&#39;s context</span>
     <span class="n">context</span><span class="p">[</span><span class="s1">&#39;my_func&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_func</span>

 <span class="c1"># Your extension&#39;s setup function</span>
 <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
     <span class="n">app</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;html-page-context&quot;</span><span class="p">,</span> <span class="n">setup_my_func</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, you will have access to this function in jinja like so:</p>
<div class="highlight-jinja notranslate"><div class="highlight"><pre><span></span><span class="x">&lt;div&gt;</span>
<span class="cp">{{</span> <span class="nv">my_func</span><span class="o">(</span><span class="s2">&quot;some string&quot;</span><span class="o">)</span> <span class="cp">}}</span>
<span class="x">&lt;/div&gt;</span>
</pre></div>
</div>
</section>
<section id="add-your-own-static-files-to-the-build-assets">
<h3>Add your own static files to the build assets<a class="headerlink" href="#add-your-own-static-files-to-the-build-assets" title="Link to this heading">¶</a></h3>
<p>By default, Sphinx copies static files on the <code class="docutils literal notranslate"><span class="pre">static/</span></code> directory of the template
directory.  However, if your package needs to place static files outside of the
<code class="docutils literal notranslate"><span class="pre">static/</span></code> directory for some reasons, you need to copy them to the <code class="docutils literal notranslate"><span class="pre">_static/</span></code>
directory of HTML outputs manually at the build via an event hook.  Here is an
example of code to accomplish this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">shutil</span>

<span class="k">def</span><span class="w"> </span><span class="nf">copy_custom_files</span><span class="p">(</span><span class="n">app</span><span class="p">,</span> <span class="n">exc</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">app</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">format</span> <span class="o">==</span> <span class="s1">&#39;html&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">exc</span><span class="p">:</span>
        <span class="n">static_dir</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">outdir</span> <span class="o">/</span> <span class="s1">&#39;_static&#39;</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">copyfile</span><span class="p">(</span><span class="s1">&#39;path/to/myextension/_static/myjsfile.js&#39;</span><span class="p">,</span> <span class="n">static_dir</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="n">app</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;build-finished&#39;</span><span class="p">,</span> <span class="n">copy_custom_files</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="inject-javascript-based-on-user-configuration">
<h3>Inject JavaScript based on user configuration<a class="headerlink" href="#inject-javascript-based-on-user-configuration" title="Link to this heading">¶</a></h3>
<p>If your extension makes use of JavaScript, it can be useful to allow users
to control its behavior using their Sphinx configuration. However, this can
be difficult to do if your JavaScript comes in the form of a static library
(which will not be built with Jinja).</p>
<p>There are two ways to inject variables into the JavaScript space based on user
configuration.</p>
<p>First, you may append <code class="docutils literal notranslate"><span class="pre">_t</span></code> to the end of any static files included with your
extension. This will cause Sphinx to process these files with the templating
engine, allowing you to embed variables and control behavior.</p>
<p>For example, the following JavaScript structure:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>mymodule/
├── _static
│   └── myjsfile.js_t
└── mymodule.py
</pre></div>
</div>
<p>Will result in the following static file placed in your HTML's build output:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>_build/
└── html
    └── _static
        └── myjsfile.js
</pre></div>
</div>
<p>See <a class="reference internal" href="#theming-static-templates"><span class="std std-ref">Static templates</span></a> for more information.</p>
<p>Second, you may use the <a class="reference internal" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_js_file" title="sphinx.application.Sphinx.add_js_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Sphinx.add_js_file()</span></code></a> method without pointing it
to a file. Normally, this method is used to insert a new JavaScript file
into your site. However, if you do <em>not</em> pass a file path, but instead pass
a string to the &quot;body&quot; argument, then this text will be inserted as JavaScript
into your site's head. This allows you to insert variables into your project's
JavaScript from Python.</p>
<p>For example, the following code will read in a user-configured value and then
insert this value as a JavaScript variable, which your extension's JavaScript
code may use:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This function reads in a variable and inserts it into JavaScript</span>
<span class="k">def</span><span class="w"> </span><span class="nf">add_js_variable</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="c1"># This is a configuration that you&#39;ve specified for users in `conf.py`</span>
    <span class="n">js_variable</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;my_javascript_variable&#39;</span><span class="p">]</span>
    <span class="n">js_text</span> <span class="o">=</span> <span class="s2">&quot;var my_variable = &#39;</span><span class="si">%s</span><span class="s2">&#39;;&quot;</span> <span class="o">%</span> <span class="n">js_variable</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_js_file</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">body</span><span class="o">=</span><span class="n">js_text</span><span class="p">)</span>
<span class="c1"># We connect this function to the step after the builder is initialized</span>
<span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="n">app</span><span class="p">):</span>
    <span class="c1"># Tell Sphinx about this configuration variable</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span><span class="s1">&#39;my_javascript_variable&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;html&#39;</span><span class="p">)</span>
    <span class="c1"># Run the function after the builder is initialized</span>
    <span class="n">app</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s1">&#39;builder-inited&#39;</span><span class="p">,</span> <span class="n">add_js_variable</span><span class="p">)</span>
</pre></div>
</div>
<p>As a result, in your theme you can use code that depends on the presence of
this variable. Users can control the variable's value by defining it in their
<code class="file docutils literal notranslate"><span class="pre">conf.py</span></code> file.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>It is not an executable Python file, as opposed to <code class="file docutils literal notranslate"><span class="pre">conf.py</span></code>,
because that would pose an unnecessary security risk if themes are
shared.</p>
</aside>
</aside>
</section>
</section>
</section>


    
  <div class="related-pages" role="navigation" aria-label="Related">
    <a class="prev-page" href="../howtos/builders.html">
        <svg><use href="#svg-arrow-right"></use></svg>
        <div class="page-info">
          <div class="context">
            <span>Previous</span>
          </div>
          
          <div class="title">Configuring builders</div>
          
        </div>
      </a>
    <a class="next-page" href="templating.html">
        <div class="page-info">
          <div class="context">
            <span>Next</span>
          </div>
          <div class="title">Templating</div>
        </div>
        <svg><use href="#svg-arrow-right"></use></svg>
      </a>
  </div>

  </div>
</div>
<div class="footer" role="contentinfo">
  
    &#169; 版权所有 2007-2025, the Sphinx developers.
  由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3创建。
</div>
  </body>
</html>