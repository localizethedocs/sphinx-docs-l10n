<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sphinx.application &#8212; Sphinx documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/basic.css?v=29da98fa" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx13.css?v=ba1752c5" />
    <script src="../../_static/documentation_options.js?v=fbcd4929"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../_static/translations.js?v=540d3cec"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/sphinx-docs-l10n/_modules/sphinx/application.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Sphinx documentation 中搜索"
          href="../../_static/opensearch.xml"/>
    <link rel="icon" href="../../_static/favicon.svg"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />

 

<script type="text/javascript" src="../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../ltd-flyout.js"></script>

  </head><body>

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="github" viewBox="0 0 16 16">
    <title>GitHub</title>
    <svg
      stroke="currentColor"
      fill="currentColor"
      stroke-width="0"
      viewBox="0 0 16 16"
    >
      <path
        fill-rule="evenodd"
        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
      ></path>
    </svg>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<div class="pageheader">
  <div class="brand">
    <a href="../../index.html">
      <img src="../../_static/sphinx-logo.svg" alt="logo" />
      <span>Sphinx</span>
    </a>
  </div>
  <div class="icons">
    <a href="https://github.com/sphinx-doc/sphinx" title="Source Code" target="_blank">
      <svg><use href="#github"></use></svg>
    </a>
  </div>
</div>

<div class="related" role="navigation" aria-label="Related">
  <h3>导航</h3>
  <ul>
    <li><a href="../../index.html">Documentation</a> &raquo;</li>
      <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">模块代码</a> &#187;</li>
    <li class="nav-item nav-item-this"><a href="">sphinx.application</a></li>
  </ul>
</div>

<div class="document">
  <div class="sphinxsidebar" role="navigation" aria-label="Main">
<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="提交" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
    <div class="sphinxsidebar-navigation__pages">
      <p class="caption" role="heading"><span class="caption-text">The Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/installation.html">Installing Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/quickstart.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial/index.html">Build your first project</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usage/index.html">Using Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../development/index.html">Extending Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extdev/index.html">Sphinx API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../latex.html">LaTeX customization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Community</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../support.html">Get support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../internals/index.html">Contribute to Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Sphinx FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Sphinx authors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../man/index.html">Command-line tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/extensions/index.html">Extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage/restructuredtext/index.html">reStructuredText</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changes/index.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples.html">Projects using Sphinx</a></li>
</ul>

    </div>
  </div>
  <div class="body" role="main">
    
  <h1>sphinx.application 源代码</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Sphinx application class and extensibility interface.</span>

<span class="sd">Gracefully adapted from the TextPress system by Armin.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">contextlib</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pickle</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">io</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringIO</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">overload</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">docutils.parsers.rst</span><span class="w"> </span><span class="kn">import</span> <span class="n">roles</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sphinx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx</span><span class="w"> </span><span class="kn">import</span> <span class="n">locale</span><span class="p">,</span> <span class="n">package_dir</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx._cli.util.colour</span><span class="w"> </span><span class="kn">import</span> <span class="n">bold</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">Config</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.environment</span><span class="w"> </span><span class="kn">import</span> <span class="n">BuildEnvironment</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.errors</span><span class="w"> </span><span class="kn">import</span> <span class="n">ApplicationError</span><span class="p">,</span> <span class="n">ConfigError</span><span class="p">,</span> <span class="n">VersionRequirementError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.events</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.highlighting</span><span class="w"> </span><span class="kn">import</span> <span class="n">lexer_classes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.locale</span><span class="w"> </span><span class="kn">import</span> <span class="n">__</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.project</span><span class="w"> </span><span class="kn">import</span> <span class="n">Project</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">SphinxComponentRegistry</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">docutils</span><span class="p">,</span> <span class="n">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util._pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">_StrPath</span><span class="p">,</span> <span class="n">_StrPathProperty</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.build_phase</span><span class="w"> </span><span class="kn">import</span> <span class="n">BuildPhase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.display</span><span class="w"> </span><span class="kn">import</span> <span class="n">progress_message</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.i18n</span><span class="w"> </span><span class="kn">import</span> <span class="n">CatalogRepository</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.logging</span><span class="w"> </span><span class="kn">import</span> <span class="n">prefixed_warnings</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.osutil</span><span class="w"> </span><span class="kn">import</span> <span class="n">ensuredir</span><span class="p">,</span> <span class="n">relpath</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.tags</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tags</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Collection</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">,</span> <span class="n">Sequence</span><span class="p">,</span> <span class="n">Set</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">IO</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Final</span><span class="p">,</span> <span class="n">Literal</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">docutils</span><span class="w"> </span><span class="kn">import</span> <span class="n">nodes</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">docutils.nodes</span><span class="w"> </span><span class="kn">import</span> <span class="n">Element</span><span class="p">,</span> <span class="n">Node</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">docutils.parsers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Parser</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">docutils.parsers.rst</span><span class="w"> </span><span class="kn">import</span> <span class="n">Directive</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">docutils.transforms</span><span class="w"> </span><span class="kn">import</span> <span class="n">Transform</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">pygments.lexer</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lexer</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx</span><span class="w"> </span><span class="kn">import</span> <span class="n">addnodes</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.builders</span><span class="w"> </span><span class="kn">import</span> <span class="n">Builder</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ENUM</span><span class="p">,</span> <span class="n">_ConfigRebuild</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.domains</span><span class="w"> </span><span class="kn">import</span> <span class="n">Domain</span><span class="p">,</span> <span class="n">Index</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.environment.collectors</span><span class="w"> </span><span class="kn">import</span> <span class="n">EnvironmentCollector</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.ext.autodoc._event_listeners</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
        <span class="n">_AutodocBeforeProcessSignatureListener</span><span class="p">,</span>
        <span class="n">_AutodocProcessBasesListener</span><span class="p">,</span>
        <span class="n">_AutodocProcessDocstringListener</span><span class="p">,</span>
        <span class="n">_AutodocProcessSignatureListener</span><span class="p">,</span>
        <span class="n">_AutodocSkipMemberListener</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.ext.autodoc._legacy_class_based._documenters</span><span class="w"> </span><span class="kn">import</span> <span class="n">Documenter</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.ext.todo</span><span class="w"> </span><span class="kn">import</span> <span class="n">todo_node</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.extension</span><span class="w"> </span><span class="kn">import</span> <span class="n">Extension</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.registry</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
        <span class="n">_MathsBlockRenderers</span><span class="p">,</span>
        <span class="n">_MathsInlineRenderers</span><span class="p">,</span>
        <span class="n">_NodeHandler</span><span class="p">,</span>
        <span class="n">_NodeHandlerPair</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.roles</span><span class="w"> </span><span class="kn">import</span> <span class="n">XRefRole</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.search</span><span class="w"> </span><span class="kn">import</span> <span class="n">SearchLanguage</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.theming</span><span class="w"> </span><span class="kn">import</span> <span class="n">Theme</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.docfields</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">RoleFunction</span><span class="p">,</span> <span class="n">TitleGetter</span>


<span class="n">builtin_extensions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;sphinx.addnodes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.changes&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.epub3&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.dirhtml&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.dummy&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.gettext&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.html&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.latex&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.linkcheck&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.manpage&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.singlehtml&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.texinfo&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.text&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.builders.xml&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.config&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.changeset&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.citation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.cpp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.index&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.javascript&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.math&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.python&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.rst&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.domains.std&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.directives&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.directives.admonitions&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.directives.code&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.directives.other&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.directives.patches&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.extension&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.parsers&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.registry&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.roles&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.transforms&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.transforms.compact_bullet_list&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.transforms.i18n&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.transforms.references&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.transforms.post_transforms&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.transforms.post_transforms.code&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.transforms.post_transforms.images&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.versioning&#39;</span><span class="p">,</span>
    <span class="c1"># collectors should be loaded by specific order</span>
    <span class="s1">&#39;sphinx.environment.collectors.dependencies&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.environment.collectors.asset&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.environment.collectors.metadata&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.environment.collectors.title&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinx.environment.collectors.toctree&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">_first_party_extensions</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># 1st party extensions</span>
    <span class="s1">&#39;sphinxcontrib.applehelp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinxcontrib.devhelp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinxcontrib.htmlhelp&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinxcontrib.serializinghtml&#39;</span><span class="p">,</span>
    <span class="s1">&#39;sphinxcontrib.qthelp&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">_first_party_themes</span> <span class="o">=</span> <span class="p">(</span>
    <span class="c1"># Alabaster is loaded automatically to be used as the default theme</span>
    <span class="s1">&#39;alabaster&#39;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">builtin_extensions</span> <span class="o">+=</span> <span class="n">_first_party_themes</span>
<span class="n">builtin_extensions</span> <span class="o">+=</span> <span class="n">_first_party_extensions</span>

<span class="n">ENV_PICKLE_FILENAME</span> <span class="o">=</span> <span class="s1">&#39;environment.pickle&#39;</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<div class="viewcode-block" id="Sphinx">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx">[文档]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Sphinx</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The main application class and extensibility interface.</span>

<span class="sd">    :ivar srcdir: Directory containing source.</span>
<span class="sd">    :ivar confdir: Directory containing ``conf.py``.</span>
<span class="sd">    :ivar doctreedir: Directory for storing pickled doctrees.</span>
<span class="sd">    :ivar outdir: Directory for storing build documents.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">warningiserror</span><span class="p">:</span> <span class="n">Final</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">_warncount</span><span class="p">:</span> <span class="nb">int</span>

    <span class="n">srcdir</span> <span class="o">=</span> <span class="n">_StrPathProperty</span><span class="p">()</span>
    <span class="n">confdir</span> <span class="o">=</span> <span class="n">_StrPathProperty</span><span class="p">()</span>
    <span class="n">outdir</span> <span class="o">=</span> <span class="n">_StrPathProperty</span><span class="p">()</span>
    <span class="n">doctreedir</span> <span class="o">=</span> <span class="n">_StrPathProperty</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">srcdir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">confdir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">outdir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">doctreedir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">buildername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">confoverrides</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">status</span><span class="p">:</span> <span class="n">IO</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span>
        <span class="n">warning</span><span class="p">:</span> <span class="n">IO</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
        <span class="n">freshenv</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">warningiserror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">tags</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">verbosity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">parallel</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">keep_going</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">pdb</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">exception_on_warning</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the Sphinx application.</span>

<span class="sd">        :param srcdir: The path to the source directory.</span>
<span class="sd">        :param confdir: The path to the configuration directory.</span>
<span class="sd">            If not given, it is assumed to be the same as ``srcdir``.</span>
<span class="sd">        :param outdir: Directory for storing build documents.</span>
<span class="sd">        :param doctreedir: Directory for caching pickled doctrees.</span>
<span class="sd">        :param buildername: The name of the builder to use.</span>
<span class="sd">        :param confoverrides: A dictionary of configuration settings that override the</span>
<span class="sd">            settings in the configuration file.</span>
<span class="sd">        :param status: A file-like object to write status messages to.</span>
<span class="sd">        :param warning: A file-like object to write warnings to.</span>
<span class="sd">        :param freshenv: If true, clear the cached environment.</span>
<span class="sd">        :param warningiserror: If true, warnings become errors.</span>
<span class="sd">        :param tags: A list of tags to apply.</span>
<span class="sd">        :param verbosity: The verbosity level.</span>
<span class="sd">        :param parallel: The maximum number of parallel jobs to use</span>
<span class="sd">            when reading/writing documents.</span>
<span class="sd">        :param keep_going: Unused.</span>
<span class="sd">        :param pdb: If true, enable the Python debugger on an exception.</span>
<span class="sd">        :param exception_on_warning: If true, raise an exception on warnings.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span> <span class="o">=</span> <span class="n">verbosity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fresh_env_used</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Extension</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span> <span class="o">=</span> <span class="n">SphinxComponentRegistry</span><span class="p">()</span>

        <span class="c1"># validate provided directories</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span> <span class="o">=</span> <span class="n">_StrPath</span><span class="p">(</span><span class="n">srcdir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span> <span class="o">=</span> <span class="n">_StrPath</span><span class="p">(</span><span class="n">outdir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">doctreedir</span> <span class="o">=</span> <span class="n">_StrPath</span><span class="p">(</span><span class="n">doctreedir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ApplicationError</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Cannot find source directory (</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="o">.</span><span class="n">exists</span><span class="p">()</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">ApplicationError</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Output directory (</span><span class="si">%s</span><span class="s1">) is not a directory&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ApplicationError</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Source directory and destination directory cannot be identical&#39;</span><span class="p">)</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">parallel</span> <span class="o">=</span> <span class="n">parallel</span>

        <span class="k">if</span> <span class="n">status</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_status</span><span class="p">:</span> <span class="n">IO</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_status</span> <span class="o">=</span> <span class="n">status</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">warning</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_warning</span><span class="p">:</span> <span class="n">IO</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">StringIO</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_warning</span> <span class="o">=</span> <span class="n">warning</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_warncount</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">keep_going</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">warningiserror</span><span class="p">)</span>  <span class="c1"># Unused</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fail_on_warnings</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">warningiserror</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pdb</span> <span class="o">=</span> <span class="n">pdb</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_exception_on_warning</span> <span class="o">=</span> <span class="n">exception_on_warning</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_status</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warning</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="n">verbosity</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">events</span> <span class="o">=</span> <span class="n">EventManager</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="c1"># keep last few messages for traceback</span>
        <span class="c1"># This will be filled by sphinx.util.logging.LastMessagesWriter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">messagelog</span><span class="p">:</span> <span class="n">deque</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="c1"># say hello to the world</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">bold</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;Running Sphinx v</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)),</span> <span class="n">sphinx</span><span class="o">.</span><span class="n">__display_version__</span><span class="p">)</span>

        <span class="c1"># status code for command-line application</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># read config</span>
        <span class="n">overrides</span> <span class="o">=</span> <span class="n">confoverrides</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tags</span> <span class="o">=</span> <span class="n">Tags</span><span class="p">(</span><span class="n">tags</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">confdir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># set confdir to srcdir if -C given (!= no confdir); a few pieces</span>
            <span class="c1"># of code expect a confdir to be set</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">({},</span> <span class="n">overrides</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">confdir</span> <span class="o">=</span> <span class="n">_StrPath</span><span class="p">(</span><span class="n">confdir</span><span class="p">)</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confdir</span><span class="p">,</span> <span class="n">overrides</span><span class="o">=</span><span class="n">overrides</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">tags</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">_verbosity</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbosity</span>

        <span class="c1"># set up translation infrastructure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_i18n</span><span class="p">()</span>

        <span class="c1"># check the Sphinx version if requested</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">needs_sphinx</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">needs_sphinx</span> <span class="o">&gt;</span> <span class="n">sphinx</span><span class="o">.</span><span class="n">__display_version__</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="n">VersionRequirementError</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span>
                    <span class="s1">&#39;This project needs at least Sphinx v</span><span class="si">%s</span><span class="s1"> and therefore cannot &#39;</span>
                    <span class="s1">&#39;be built with this version.&#39;</span>
                <span class="p">)</span>
                <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">needs_sphinx</span>
            <span class="p">)</span>

        <span class="c1"># load all built-in extension modules, first-party extension modules,</span>
        <span class="c1"># and first-party themes</span>
        <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">builtin_extensions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_extension</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>

        <span class="c1"># load all user-given extension modules</span>
        <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">extensions</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setup_extension</span><span class="p">(</span><span class="n">extension</span><span class="p">)</span>

        <span class="c1"># preload builder module (before init config values)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preload_builder</span><span class="p">(</span><span class="n">buildername</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="o">.</span><span class="n">is_dir</span><span class="p">():</span>
            <span class="k">with</span> <span class="n">progress_message</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;making output directory&#39;</span><span class="p">)):</span>
                <span class="n">ensuredir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">)</span>

        <span class="c1"># the config file itself can be an extension</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setup</span><span class="p">:</span>
            <span class="n">prefix</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span><span class="s1">&#39;while setting up extension </span><span class="si">%s</span><span class="s1">:&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="s1">&#39;conf.py&#39;</span>
            <span class="k">with</span> <span class="n">prefixed_warnings</span><span class="p">(</span><span class="n">prefix</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setup</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">ConfigError</span><span class="p">(</span>
                        <span class="n">__</span><span class="p">(</span>
                            <span class="s2">&quot;&#39;setup&#39; as currently defined in conf.py isn&#39;t a Python callable. &quot;</span>
                            <span class="s1">&#39;Please modify its definition to make it a callable function. &#39;</span>
                            <span class="s1">&#39;This is needed for conf.py to behave as a Sphinx extension.&#39;</span>
                        <span class="p">),</span>
                    <span class="p">)</span>

        <span class="c1"># Report any warnings for overrides.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">_report_override_warnings</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;config-inited&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">)</span>

        <span class="c1"># create the project</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="o">=</span> <span class="n">Project</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">source_suffix</span><span class="p">)</span>

        <span class="c1"># set up the build environment</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_init_env</span><span class="p">(</span><span class="n">freshenv</span><span class="p">)</span>

        <span class="c1"># create the builder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_builder</span><span class="p">(</span><span class="n">buildername</span><span class="p">)</span>

        <span class="c1"># build environment post-initialisation, after creating the builder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_post_init_env</span><span class="p">()</span>

        <span class="c1"># set up the builder</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_builder</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">fresh_env_used</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;True/False as to whether a new environment was created for this build,</span>
<span class="sd">        or None if the environment has not been initialised yet.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fresh_env_used</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">phase</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BuildPhase</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;builder&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">BuildPhase</span><span class="o">.</span><span class="n">INITIALIZATION</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">phase</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_i18n</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load translated strings from the configured localedirs if enabled in</span>
<span class="sd">        the configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="n">bold</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;loading translations [</span><span class="si">%s</span><span class="s1">]... &#39;</span><span class="p">)),</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">language</span><span class="p">,</span> <span class="n">nonl</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>

        <span class="c1"># compile mo files if sphinx.po file in user locale directories are updated</span>
        <span class="n">repo</span> <span class="o">=</span> <span class="n">CatalogRepository</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">srcdir</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">locale_dirs</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">language</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">source_encoding</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">catalog</span> <span class="ow">in</span> <span class="n">repo</span><span class="o">.</span><span class="n">catalogs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">catalog</span><span class="o">.</span><span class="n">domain</span> <span class="o">==</span> <span class="s1">&#39;sphinx&#39;</span> <span class="ow">and</span> <span class="n">catalog</span><span class="o">.</span><span class="n">is_outdated</span><span class="p">():</span>
                <span class="n">catalog</span><span class="o">.</span><span class="n">write_mo</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">language</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">gettext_allow_fuzzy_translations</span>
                <span class="p">)</span>

        <span class="n">locale_dirs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_StrPath</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">repo</span><span class="o">.</span><span class="n">locale_dirs</span><span class="p">)</span>
        <span class="n">locale_dirs</span> <span class="o">+=</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span>
        <span class="n">locale_dirs</span> <span class="o">+=</span> <span class="p">[</span><span class="n">package_dir</span> <span class="o">/</span> <span class="s1">&#39;locale&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">translator</span><span class="p">,</span> <span class="n">has_translation</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
            <span class="n">locale_dirs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">language</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">has_translation</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">language</span> <span class="o">==</span> <span class="s1">&#39;en&#39;</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;done&#39;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;not available for built-in messages&#39;</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_env</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">freshenv</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BuildEnvironment</span><span class="p">:</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doctreedir</span> <span class="o">/</span> <span class="n">ENV_PICKLE_FILENAME</span>
        <span class="k">if</span> <span class="n">freshenv</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_fresh_env</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_existing_env</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_create_fresh_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BuildEnvironment</span><span class="p">:</span>
        <span class="n">env</span> <span class="o">=</span> <span class="n">BuildEnvironment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fresh_env_used</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">env</span>

    <span class="nd">@progress_message</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;loading pickled environment&#39;</span><span class="p">))</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_load_existing_env</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="n">Path</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">BuildEnvironment</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">env</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
            <span class="n">env</span><span class="o">.</span><span class="n">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_fresh_env_used</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;failed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">err</span><span class="p">)</span>
            <span class="n">env</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_fresh_env</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">env</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_post_init_env</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fresh_env_used</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">find_files</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">_builder_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="vm">__class__</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">preload_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">preload_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Builder</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;No builder selected, using default: html&#39;</span><span class="p">))</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;html&#39;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">create_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_init_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;builder-inited&#39;</span><span class="p">)</span>

    <span class="c1"># ---- main &quot;build&quot; method -------------------------------------------------</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force_all</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">filenames</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="p">())</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">phase</span> <span class="o">=</span> <span class="n">BuildPhase</span><span class="o">.</span><span class="n">READING</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">force_all</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">build_all</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">filenames</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">build_specific</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">build_update</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;build-finished&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="c1"># delete the saved env to force a fresh build next time</span>
            <span class="n">envfile</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">doctreedir</span> <span class="o">/</span> <span class="n">ENV_PICKLE_FILENAME</span>
            <span class="k">if</span> <span class="n">envfile</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
                <span class="n">envfile</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;build-finished&#39;</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
            <span class="k">raise</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warncount</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">bold</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;build finished with problems.&#39;</span><span class="p">)))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">bold</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;build succeeded.&#39;</span><span class="p">)))</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warncount</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_on_warnings</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span>
                    <span class="s1">&#39;build finished with problems, 1 warning &#39;</span>
                    <span class="s1">&#39;(with warnings treated as errors).&#39;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span><span class="s1">&#39;build finished with problems, 1 warning.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span><span class="s1">&#39;build succeeded, 1 warning.&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">bold</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fail_on_warnings</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span>
                    <span class="s1">&#39;build finished with problems, </span><span class="si">%s</span><span class="s1"> warnings &#39;</span>
                    <span class="s1">&#39;(with warnings treated as errors).&#39;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span><span class="s1">&#39;build finished with problems, </span><span class="si">%s</span><span class="s1"> warnings.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span><span class="s1">&#39;build succeeded, </span><span class="si">%s</span><span class="s1"> warnings.&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">bold</span><span class="p">(</span><span class="n">msg</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warncount</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">statuscode</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">epilog</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">epilog</span><span class="p">,</span>
                <span class="p">{</span>
                    <span class="s1">&#39;outdir&#39;</span><span class="p">:</span> <span class="n">relpath</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdir</span><span class="p">),</span>
                    <span class="s1">&#39;project&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">project</span><span class="p">,</span>
                <span class="p">},</span>
            <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">cleanup</span><span class="p">()</span>

    <span class="c1"># ---- general extensibility interface -------------------------------------</span>

<div class="viewcode-block" id="Sphinx.setup_extension">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.setup_extension">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">setup_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Import and setup a Sphinx extension module.</span>

<span class="sd">        Load the extension given by the module *name*.  Use this if your</span>
<span class="sd">        extension needs the features provided by another extension.  No-op if</span>
<span class="sd">        called twice.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] setting up extension: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">extname</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">load_extension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">extname</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.require_sphinx">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.require_sphinx">[文档]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">require_sphinx</span><span class="p">(</span><span class="n">version</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the Sphinx version if requested.</span>

<span class="sd">        Compare *version* with the version of the running Sphinx, and abort the</span>
<span class="sd">        build when it is too old.</span>

<span class="sd">        :param version: The required version in the form of ``major.minor`` or</span>
<span class="sd">                        ``(major, minor)``.</span>

<span class="sd">        .. versionadded:: 1.0</span>
<span class="sd">        .. versionchanged:: 7.1</span>
<span class="sd">           Type of *version* now allows ``(major, minor)`` form.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">version</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="n">major</span><span class="p">,</span> <span class="n">minor</span> <span class="o">=</span> <span class="n">version</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">major</span><span class="p">,</span> <span class="n">minor</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[:</span><span class="mi">2</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">major</span><span class="p">,</span> <span class="n">minor</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">sphinx</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>
            <span class="n">req</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">major</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">minor</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">raise</span> <span class="n">VersionRequirementError</span><span class="p">(</span><span class="n">req</span><span class="p">)</span></div>


    <span class="c1"># ---- Core events -------------------------------------------------------</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;config-inited&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">Config</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;builder-inited&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;env-get-outdated&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
            <span class="p">[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
        <span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;env-before-read-docs&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;env-purge-doc&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;source-read&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;include-read&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">Path</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;doctree-read&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">document</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;env-merge-info&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
            <span class="p">[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">,</span> <span class="n">Set</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">BuildEnvironment</span><span class="p">],</span> <span class="kc">None</span>
        <span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;env-updated&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">],</span> <span class="nb">str</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;env-get-updated&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;env-check-consistency&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;write-started&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">Builder</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;doctree-resolved&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">document</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;missing-reference&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
            <span class="p">[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">BuildEnvironment</span><span class="p">,</span> <span class="n">addnodes</span><span class="o">.</span><span class="n">pending_xref</span><span class="p">,</span> <span class="n">nodes</span><span class="o">.</span><span class="n">TextElement</span><span class="p">],</span>
            <span class="n">nodes</span><span class="o">.</span><span class="n">reference</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;warn-missing-reference&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">Domain</span><span class="p">,</span> <span class="n">addnodes</span><span class="o">.</span><span class="n">pending_xref</span><span class="p">],</span> <span class="nb">bool</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;build-finished&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="ne">Exception</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># ---- Events from builtin builders --------------------------------------</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;html-collect-pages&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">],</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="nb">str</span><span class="p">]]],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;html-page-context&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
            <span class="p">[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">nodes</span><span class="o">.</span><span class="n">document</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;linkcheck-process-uri&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># ---- Events from builtin extensions-- ----------------------------------</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;object-description-transform&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">addnodes</span><span class="o">.</span><span class="n">desc_content</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># ---- Events from first-party extensions --------------------------------</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;autodoc-process-docstring&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">_AutodocProcessDocstringListener</span><span class="p">,</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">_AutodocBeforeProcessSignatureListener</span><span class="p">,</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;autodoc-process-signature&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">_AutodocProcessSignatureListener</span><span class="p">,</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;autodoc-process-bases&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">_AutodocProcessBasesListener</span><span class="p">,</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;autodoc-skip-member&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">_AutodocSkipMemberListener</span><span class="p">,</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;todo-defined&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">todo_node</span><span class="p">],</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;viewcode-find-source&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span>
            <span class="p">[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
            <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;def&#39;</span><span class="p">,</span> <span class="s1">&#39;other&#39;</span><span class="p">],</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]],</span>
        <span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;viewcode-follow-imported&#39;</span><span class="p">],</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># ---- Catch-all ---------------------------------------------------------</span>

    <span class="nd">@overload</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span> <span class="o">...</span>

    <span class="c1"># event interface</span>
<div class="viewcode-block" id="Sphinx.connect">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.connect">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">connect</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register *callback* to be called when *event* is emitted.</span>

<span class="sd">        For details on available core events and the arguments of callback</span>
<span class="sd">        functions, please see :ref:`events`.</span>

<span class="sd">        :param event: The name of target event</span>
<span class="sd">        :param callback: Callback function for the event</span>
<span class="sd">        :param priority: The priority of the callback.  The callbacks will be invoked</span>
<span class="sd">                         in order of *priority* (ascending).</span>
<span class="sd">        :return: A listener ID.  It can be used for :meth:`disconnect`.</span>

<span class="sd">        .. versionchanged:: 3.0</span>

<span class="sd">           Support *priority*</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">listener_id</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">callback</span><span class="p">,</span> <span class="n">priority</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s1">&#39;[app] connecting event </span><span class="si">%r</span><span class="s1"> (</span><span class="si">%d</span><span class="s1">): </span><span class="si">%r</span><span class="s1"> [id=</span><span class="si">%s</span><span class="s1">]&#39;</span><span class="p">,</span>
            <span class="n">event</span><span class="p">,</span>
            <span class="n">priority</span><span class="p">,</span>
            <span class="n">callback</span><span class="p">,</span>
            <span class="n">listener_id</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">listener_id</span></div>


<div class="viewcode-block" id="Sphinx.disconnect">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.disconnect">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">listener_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Unregister callback by *listener_id*.</span>

<span class="sd">        :param listener_id: A listener_id that :meth:`connect` returns</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] disconnecting event: [id=</span><span class="si">%s</span><span class="s1">]&#39;</span><span class="p">,</span> <span class="n">listener_id</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="n">listener_id</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.emit">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.emit">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">emit</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">allowed_exceptions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">Exception</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emit *event* and pass *arguments* to the callback functions.</span>

<span class="sd">        Return the return values of all callbacks as a list.  Do not emit core</span>
<span class="sd">        Sphinx events in extensions!</span>

<span class="sd">        :param event: The name of event that will be emitted</span>
<span class="sd">        :param args: The arguments for the event</span>
<span class="sd">        :param allowed_exceptions: The list of exceptions that are allowed in the callbacks</span>

<span class="sd">        .. versionchanged:: 3.1</span>

<span class="sd">           Added *allowed_exceptions* to specify path-through exceptions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">allowed_exceptions</span><span class="o">=</span><span class="n">allowed_exceptions</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.emit_firstresult">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.emit_firstresult">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">emit_firstresult</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">event</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">allowed_exceptions</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="ne">Exception</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Emit *event* and pass *arguments* to the callback functions.</span>

<span class="sd">        Return the result of the first callback that doesn&#39;t return ``None``.</span>

<span class="sd">        :param event: The name of event that will be emitted</span>
<span class="sd">        :param args: The arguments for the event</span>
<span class="sd">        :param allowed_exceptions: The list of exceptions that are allowed in the callbacks</span>

<span class="sd">        .. versionadded:: 0.5</span>
<span class="sd">        .. versionchanged:: 3.1</span>

<span class="sd">           Added *allowed_exceptions* to specify path-through exceptions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">emit_firstresult</span><span class="p">(</span>
            <span class="n">event</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">allowed_exceptions</span><span class="o">=</span><span class="n">allowed_exceptions</span>
        <span class="p">)</span></div>


    <span class="c1"># registering addon parts</span>

<div class="viewcode-block" id="Sphinx.add_builder">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_builder">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_builder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">builder</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Builder</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new builder.</span>

<span class="sd">        :param builder: A builder class</span>
<span class="sd">        :param override: If true, install the builder forcedly even if another builder</span>
<span class="sd">                         is already installed as the same name</span>

<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_builder</span><span class="p">(</span><span class="n">builder</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_config_value">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_config_value">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_config_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">rebuild</span><span class="p">:</span> <span class="n">_ConfigRebuild</span><span class="p">,</span>
        <span class="n">types</span><span class="p">:</span> <span class="nb">type</span> <span class="o">|</span> <span class="n">Collection</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span> <span class="o">|</span> <span class="n">ENUM</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a configuration value.</span>

<span class="sd">        This is necessary for Sphinx to recognize new values and set default</span>
<span class="sd">        values accordingly.</span>


<span class="sd">        :param name: The name of the configuration value.  It is recommended to be prefixed</span>
<span class="sd">                     with the extension name (ex. ``html_logo``, ``epub_title``)</span>
<span class="sd">        :param default: The default value of the configuration.</span>
<span class="sd">        :param rebuild: The condition of rebuild.  It must be one of those values:</span>

<span class="sd">                        * ``&#39;env&#39;`` if a change in the setting only takes effect when a</span>
<span class="sd">                          document is parsed -- this means that the whole environment must be</span>
<span class="sd">                          rebuilt.</span>
<span class="sd">                        * ``&#39;html&#39;`` if a change in the setting needs a full rebuild of HTML</span>
<span class="sd">                          documents.</span>
<span class="sd">                        * ``&#39;&#39;`` if a change in the setting will not need any special rebuild.</span>
<span class="sd">        :param types: The type of configuration value.  A list of types can be specified.  For</span>
<span class="sd">                      example, ``[str]`` is used to describe a configuration that takes string</span>
<span class="sd">                      value.</span>
<span class="sd">        :param description: A short description of the configuration value.</span>

<span class="sd">        .. versionchanged:: 0.4</span>
<span class="sd">           If the *default* value is a callable, it will be called with the</span>
<span class="sd">           config object as its argument in order to get the default value.</span>
<span class="sd">           This can be used to implement config values whose default depends on</span>
<span class="sd">           other values.</span>

<span class="sd">        .. versionchanged:: 0.6</span>
<span class="sd">           Changed *rebuild* from a simple boolean (equivalent to ``&#39;&#39;`` or</span>
<span class="sd">           ``&#39;env&#39;``) to a string.  However, booleans are still accepted and</span>
<span class="sd">           converted internally.</span>

<span class="sd">        .. versionadded:: 1.4</span>
<span class="sd">           The *types* parameter.</span>

<span class="sd">        .. versionadded:: 7.4</span>
<span class="sd">           The *description* parameter.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding config value: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">default</span><span class="p">,</span> <span class="n">rebuild</span><span class="p">,</span> <span class="n">types</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">add</span><span class="p">(</span>
            <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
            <span class="n">default</span><span class="o">=</span><span class="n">default</span><span class="p">,</span>
            <span class="n">rebuild</span><span class="o">=</span><span class="n">rebuild</span><span class="p">,</span>
            <span class="n">types</span><span class="o">=</span><span class="n">types</span><span class="p">,</span>
            <span class="n">description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_event">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_event">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_event</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register an event called *name*.</span>

<span class="sd">        This is needed to be able to emit it.</span>

<span class="sd">        :param name: The name of the event</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding event: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">events</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.set_translator">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.set_translator">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_translator</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">translator_class</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">NodeVisitor</span><span class="p">],</span>
        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register or override a Docutils translator class.</span>

<span class="sd">        This is used to register a custom output translator or to replace a</span>
<span class="sd">        builtin translator.  This allows extensions to use a custom translator</span>
<span class="sd">        and define custom nodes for the translator (see :meth:`add_node`).</span>

<span class="sd">        :param name: The name of the builder for the translator</span>
<span class="sd">        :param translator_class: A translator class</span>
<span class="sd">        :param override: If true, install the translator forcedly even if another translator</span>
<span class="sd">                         is already installed as the same name</span>

<span class="sd">        .. versionadded:: 1.3</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_translator</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">translator_class</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_node">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_node">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_node</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">node</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Element</span><span class="p">],</span>
        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">_NodeHandlerPair</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils node class.</span>

<span class="sd">        This is necessary for Docutils internals.  It may also be used in the</span>
<span class="sd">        future to validate nodes in the parsed documents.</span>

<span class="sd">        :param node: A node class</span>
<span class="sd">        :param kwargs: Visitor functions for each builder (see below)</span>
<span class="sd">        :param override: If true, install the node forcedly even if another node is already</span>
<span class="sd">                         installed as the same name</span>

<span class="sd">        Node visitor functions for the Sphinx HTML, LaTeX, text and manpage</span>
<span class="sd">        writers can be given as keyword arguments: the keyword should be one or</span>
<span class="sd">        more of ``&#39;html&#39;``, ``&#39;latex&#39;``, ``&#39;text&#39;``, ``&#39;man&#39;``, ``&#39;texinfo&#39;``</span>
<span class="sd">        or any other supported translators, the value a 2-tuple of ``(visit,</span>
<span class="sd">        depart)`` methods.  ``depart`` can be ``None`` if the ``visit``</span>
<span class="sd">        function raises :exc:`docutils.nodes.SkipNode`.  Example:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           class math(docutils.nodes.Element): ...</span>

<span class="sd">           def visit_math_html(self, node):</span>
<span class="sd">               self.body.append(self.starttag(node, &#39;math&#39;))</span>

<span class="sd">           def depart_math_html(self, node):</span>
<span class="sd">               self.body.append(&#39;&lt;/math&gt;&#39;)</span>

<span class="sd">           app.add_node(math, html=(visit_math_html, depart_math_html))</span>

<span class="sd">        Obviously, translators for which you don&#39;t specify visitor methods will</span>
<span class="sd">        choke on the node when encountered in a document to translate.</span>

<span class="sd">        .. versionchanged:: 0.5</span>
<span class="sd">           Added the support for keyword arguments giving visit functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding node: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="n">docutils</span><span class="o">.</span><span class="n">is_node_registered</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span>
                    <span class="s1">&#39;node class </span><span class="si">%r</span><span class="s1"> is already registered, &#39;</span>
                    <span class="s1">&#39;its visitors will be overridden&#39;</span>
                <span class="p">),</span>
                <span class="n">node</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;app&#39;</span><span class="p">,</span>
                <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;add_node&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">docutils</span><span class="o">.</span><span class="n">register_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_translation_handlers</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_enumerable_node">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_enumerable_node">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_enumerable_node</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">node</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Element</span><span class="p">],</span>
        <span class="n">figtype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">title_getter</span><span class="p">:</span> <span class="n">TitleGetter</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">_NodeHandler</span><span class="p">,</span> <span class="n">_NodeHandler</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils node class as a numfig target.</span>

<span class="sd">        Sphinx numbers the node automatically. And then the users can refer it</span>
<span class="sd">        using :rst:role:`numref`.</span>

<span class="sd">        :param node: A node class</span>
<span class="sd">        :param figtype: The type of enumerable nodes.  Each figtype has individual numbering</span>
<span class="sd">                        sequences.  As system figtypes, ``figure``, ``table`` and</span>
<span class="sd">                        ``code-block`` are defined.  It is possible to add custom nodes to</span>
<span class="sd">                        these default figtypes.  It is also possible to define new custom</span>
<span class="sd">                        figtype if a new figtype is given.</span>
<span class="sd">        :param title_getter: A getter function to obtain the title of node.  It takes an</span>
<span class="sd">                             instance of the enumerable node, and it must return its title as</span>
<span class="sd">                             string.  The title is used to the default title of references for</span>
<span class="sd">                             :rst:role:`ref`.  By default, Sphinx searches</span>
<span class="sd">                             ``docutils.nodes.caption`` or ``docutils.nodes.title`` from the</span>
<span class="sd">                             node as a title.</span>
<span class="sd">        :param kwargs: Visitor functions for each builder (same as :meth:`add_node`)</span>
<span class="sd">        :param override: If true, install the node forcedly even if another node is already</span>
<span class="sd">                         installed as the same name</span>

<span class="sd">        .. versionadded:: 1.4</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_enumerable_node</span><span class="p">(</span>
            <span class="n">node</span><span class="p">,</span> <span class="n">figtype</span><span class="p">,</span> <span class="n">title_getter</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_directive">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_directive">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils directive.</span>

<span class="sd">        :param name: The name of the directive</span>
<span class="sd">        :param cls: A directive class</span>
<span class="sd">        :param override: If false, do not install it if another directive</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the directive.</span>

<span class="sd">        For example, a custom directive named ``my-directive`` would be added</span>
<span class="sd">        like this:</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           from docutils.parsers.rst import Directive, directives</span>

<span class="sd">           class MyDirective(Directive):</span>
<span class="sd">               has_content = True</span>
<span class="sd">               required_arguments = 1</span>
<span class="sd">               optional_arguments = 0</span>
<span class="sd">               final_argument_whitespace = True</span>
<span class="sd">               option_spec = {</span>
<span class="sd">                   &#39;class&#39;: directives.class_option,</span>
<span class="sd">                   &#39;name&#39;: directives.unchanged,</span>
<span class="sd">               }</span>

<span class="sd">               def run(self):</span>
<span class="sd">                   pass</span>

<span class="sd">           def setup(app):</span>
<span class="sd">               app.add_directive(&#39;my-directive&#39;, MyDirective)</span>

<span class="sd">        For more details, see `the Docutils docs</span>
<span class="sd">        &lt;https://docutils.sourceforge.io/docs/howto/rst-directives.html&gt;`__ .</span>

<span class="sd">        .. versionchanged:: 0.6</span>
<span class="sd">           Docutils 0.5-style directive classes are now supported.</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Docutils 0.4-style (function based) directives support is deprecated.</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding directive: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="n">docutils</span><span class="o">.</span><span class="n">is_directive_registered</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;directive </span><span class="si">%r</span><span class="s1"> is already registered and will not be overridden&#39;</span><span class="p">),</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;app&#39;</span><span class="p">,</span>
                <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;add_directive&#39;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">docutils</span><span class="o">.</span><span class="n">register_directive</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_role">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_role">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">role</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils role.</span>

<span class="sd">        :param name: The name of role</span>
<span class="sd">        :param role: A role function</span>
<span class="sd">        :param override: If false, do not install it if another role</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the role.</span>

<span class="sd">        For more details about role functions, see `the Docutils docs</span>
<span class="sd">        &lt;https://docutils.sourceforge.io/docs/howto/rst-roles.html&gt;`__ .</span>

<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding role: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">role</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="n">docutils</span><span class="o">.</span><span class="n">is_role_registered</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;role </span><span class="si">%r</span><span class="s1"> is already registered and will not be overridden&#39;</span><span class="p">),</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;app&#39;</span><span class="p">,</span>
                <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;add_role&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">docutils</span><span class="o">.</span><span class="n">register_role</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">role</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_generic_role">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_generic_role">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_generic_role</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">nodeclass</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Node</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a generic Docutils role.</span>

<span class="sd">        Register a Docutils role that does nothing but wrap its contents in the</span>
<span class="sd">        node given by *nodeclass*.</span>

<span class="sd">        :param override: If false, do not install it if another role</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the role.</span>

<span class="sd">        .. versionadded:: 0.6</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Don&#39;t use ``roles.register_generic_role`` because it uses</span>
        <span class="c1"># ``register_canonical_role``.</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding generic role: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nodeclass</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">override</span> <span class="ow">and</span> <span class="n">docutils</span><span class="o">.</span><span class="n">is_role_registered</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;role </span><span class="si">%r</span><span class="s1"> is already registered and will not be overridden&#39;</span><span class="p">),</span>
                <span class="n">name</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;app&#39;</span><span class="p">,</span>
                <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;add_generic_role&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="n">role</span> <span class="o">=</span> <span class="n">roles</span><span class="o">.</span><span class="n">GenericRole</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">nodeclass</span><span class="p">)</span>
        <span class="n">docutils</span><span class="o">.</span><span class="n">register_role</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">role</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_domain">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_domain">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_domain</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Domain</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a domain.</span>

<span class="sd">        :param domain: A domain class</span>
<span class="sd">        :param override: If false, do not install it if another domain</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the domain.</span>

<span class="sd">        .. versionadded:: 1.0</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_domain</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_directive_to_domain">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_directive_to_domain">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_to_domain</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Directive</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils directive in a domain.</span>

<span class="sd">        Like :meth:`add_directive`, but the directive is added to the domain</span>
<span class="sd">        named *domain*.</span>

<span class="sd">        :param domain: The name of target domain</span>
<span class="sd">        :param name: A name of directive</span>
<span class="sd">        :param cls: A directive class</span>
<span class="sd">        :param override: If false, do not install it if another directive</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the directive.</span>

<span class="sd">        .. versionadded:: 1.0</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_directive_to_domain</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_role_to_domain">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_role_to_domain">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_role_to_domain</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">domain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">role</span><span class="p">:</span> <span class="n">RoleFunction</span> <span class="o">|</span> <span class="n">XRefRole</span><span class="p">,</span>
        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils role in a domain.</span>

<span class="sd">        Like :meth:`add_role`, but the role is added to the domain named</span>
<span class="sd">        *domain*.</span>

<span class="sd">        :param domain: The name of the target domain</span>
<span class="sd">        :param name: The name of the role</span>
<span class="sd">        :param role: The role function</span>
<span class="sd">        :param override: If false, do not install it if another role</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the role.</span>

<span class="sd">        .. versionadded:: 1.0</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_role_to_domain</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_index_to_domain">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_index_to_domain">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_index_to_domain</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">domain</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Index</span><span class="p">],</span> <span class="n">_override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a custom index for a domain.</span>

<span class="sd">        Add a custom *index* class to the domain named *domain*.</span>

<span class="sd">        :param domain: The name of the target domain</span>
<span class="sd">        :param index: The index class</span>
<span class="sd">        :param override: If false, do not install it if another index</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the index.</span>

<span class="sd">        .. versionadded:: 1.0</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_index_to_domain</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_object_type">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_object_type">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_object_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">directivename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">rolename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">indextemplate</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">parse_node</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">BuildEnvironment</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">addnodes</span><span class="o">.</span><span class="n">desc_signature</span><span class="p">],</span> <span class="nb">str</span><span class="p">]</span>
        <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">ref_nodeclass</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">TextElement</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">objname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">doc_field_types</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">Field</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new object type.</span>

<span class="sd">        This method is a very convenient way to add a new :term:`object` type</span>
<span class="sd">        that can be cross-referenced.  It will do this:</span>

<span class="sd">        - Create a new directive (called *directivename*) for documenting an</span>
<span class="sd">          object.  It will automatically add index entries if *indextemplate*</span>
<span class="sd">          is nonempty; if given, it must contain exactly one instance of</span>
<span class="sd">          ``%s``.  See the example below for how the template will be</span>
<span class="sd">          interpreted.</span>
<span class="sd">        - Create a new role (called *rolename*) to cross-reference to these</span>
<span class="sd">          object descriptions.</span>
<span class="sd">        - If you provide *parse_node*, it must be a function that takes a</span>
<span class="sd">          string and a docutils node, and it must populate the node with</span>
<span class="sd">          children parsed from the string.  It must then return the name of the</span>
<span class="sd">          item to be used in cross-referencing and index entries.  See the</span>
<span class="sd">          :file:`conf.py` file in the source for this documentation for an</span>
<span class="sd">          example.</span>
<span class="sd">        - The *objname* (if not given, will default to *directivename*) names</span>
<span class="sd">          the type of object.  It is used when listing objects, e.g. in search</span>
<span class="sd">          results.</span>

<span class="sd">        For example, if you have this call in a custom Sphinx extension::</span>

<span class="sd">           app.add_object_type(&#39;directive&#39;, &#39;dir&#39;, &#39;pair: %s; directive&#39;)</span>

<span class="sd">        you can use this markup in your documents::</span>

<span class="sd">           .. rst:directive:: function</span>

<span class="sd">              Document a function.</span>

<span class="sd">           &lt;...&gt;</span>

<span class="sd">           See also the :rst:dir:`function` directive.</span>

<span class="sd">        For the directive, an index entry will be generated as if you had prepended ::</span>

<span class="sd">           .. index:: pair: function; directive</span>

<span class="sd">        The reference node will be of class ``literal`` (so it will be rendered</span>
<span class="sd">        in a proportional font, as appropriate for code) unless you give the</span>
<span class="sd">        *ref_nodeclass* argument, which must be a docutils node class.  Most</span>
<span class="sd">        useful are ``docutils.nodes.emphasis`` or ``docutils.nodes.strong`` --</span>
<span class="sd">        you can also use ``docutils.nodes.generated`` if you want no further</span>
<span class="sd">        text decoration.  If the text should be treated as literal (e.g. no</span>
<span class="sd">        smart quote replacement), but not have typewriter styling, use</span>
<span class="sd">        ``sphinx.addnodes.literal_emphasis`` or</span>
<span class="sd">        ``sphinx.addnodes.literal_strong``.</span>

<span class="sd">        For the role content, you have the same syntactical possibilities as</span>
<span class="sd">        for standard Sphinx roles (see :ref:`xref-syntax`).</span>

<span class="sd">        If *override* is True, the given object_type is forcedly installed even if</span>
<span class="sd">        an object_type having the same name is already installed.</span>

<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_object_type</span><span class="p">(</span>
            <span class="n">directivename</span><span class="p">,</span>
            <span class="n">rolename</span><span class="p">,</span>
            <span class="n">indextemplate</span><span class="p">,</span>
            <span class="n">parse_node</span><span class="p">,</span>
            <span class="n">ref_nodeclass</span><span class="p">,</span>
            <span class="n">objname</span><span class="p">,</span>
            <span class="n">doc_field_types</span><span class="p">,</span>
            <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_crossref_type">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_crossref_type">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_crossref_type</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">directivename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">rolename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">indextemplate</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">ref_nodeclass</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">nodes</span><span class="o">.</span><span class="n">TextElement</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">objname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
        <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new crossref object type.</span>

<span class="sd">        This method is very similar to :meth:`~Sphinx.add_object_type` except that the</span>
<span class="sd">        directive it generates must be empty, and will produce no output.</span>

<span class="sd">        That means that you can add semantic targets to your sources, and refer</span>
<span class="sd">        to them using custom roles instead of generic ones (like</span>
<span class="sd">        :rst:role:`ref`).  Example call::</span>

<span class="sd">           app.add_crossref_type(</span>
<span class="sd">               &#39;topic&#39;, &#39;topic&#39;, &#39;single: %s&#39;, docutils.nodes.emphasis</span>
<span class="sd">           )</span>

<span class="sd">        Example usage::</span>

<span class="sd">           .. topic:: application API</span>

<span class="sd">           The application API</span>
<span class="sd">           -------------------</span>

<span class="sd">           Some random text here.</span>

<span class="sd">           See also :topic:`this section &lt;application API&gt;`.</span>

<span class="sd">        (Of course, the element following the ``topic`` directive needn&#39;t be a</span>
<span class="sd">        section.)</span>


<span class="sd">        :param override: If false, do not install it if another cross-reference type</span>
<span class="sd">                         is already installed as the same name</span>
<span class="sd">                         If true, unconditionally install the cross-reference type.</span>

<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_crossref_type</span><span class="p">(</span>
            <span class="n">directivename</span><span class="p">,</span>
            <span class="n">rolename</span><span class="p">,</span>
            <span class="n">indextemplate</span><span class="p">,</span>
            <span class="n">ref_nodeclass</span><span class="p">,</span>
            <span class="n">objname</span><span class="p">,</span>
            <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">,</span>
        <span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_transform">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_transform">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Transform</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils transform to be applied after parsing.</span>

<span class="sd">        Add the standard docutils :class:`~docutils.transforms.Transform`</span>
<span class="sd">        subclass *transform* to the list of transforms that are applied after</span>
<span class="sd">        Sphinx parses a reST document.</span>

<span class="sd">        :param transform: A transform class</span>

<span class="sd">        .. list-table:: priority range categories for Sphinx transforms</span>
<span class="sd">           :widths: 20,80</span>

<span class="sd">           * - Priority</span>
<span class="sd">             - Main purpose in Sphinx</span>
<span class="sd">           * - 0-99</span>
<span class="sd">             - Fix invalid nodes by docutils. Translate a doctree.</span>
<span class="sd">           * - 100-299</span>
<span class="sd">             - Preparation</span>
<span class="sd">           * - 300-399</span>
<span class="sd">             - early</span>
<span class="sd">           * - 400-699</span>
<span class="sd">             - main</span>
<span class="sd">           * - 700-799</span>
<span class="sd">             - Post processing. Deadline to modify text and referencing.</span>
<span class="sd">           * - 800-899</span>
<span class="sd">             - Collect referencing and referenced nodes. Domain processing.</span>
<span class="sd">           * - 900-999</span>
<span class="sd">             - Finalize and clean up.</span>

<span class="sd">        refs: `Transform Priority Range Categories`__</span>

<span class="sd">        __ https://docutils.sourceforge.io/docs/ref/transforms.html#transform-priority-range-categories</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_post_transform">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_post_transform">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_post_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">transform</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Transform</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a Docutils transform to be applied before writing.</span>

<span class="sd">        Add the standard docutils :class:`~docutils.transforms.Transform`</span>
<span class="sd">        subclass *transform* to the list of transforms that are applied before</span>
<span class="sd">        Sphinx writes a document.</span>

<span class="sd">        :param transform: A transform class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_post_transform</span><span class="p">(</span><span class="n">transform</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_js_file">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_js_file">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_js_file</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
        <span class="n">loading_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a JavaScript file to include in the HTML output.</span>

<span class="sd">        :param filename: The name of a JavaScript file that the default HTML</span>
<span class="sd">                         template will include. It must be relative to the HTML</span>
<span class="sd">                         static path, or a full URI with scheme, or ``None`` .</span>
<span class="sd">                         The ``None`` value is used to create an inline</span>
<span class="sd">                         ``&lt;script&gt;`` tag.  See the description of *kwargs*</span>
<span class="sd">                         below.</span>
<span class="sd">        :param priority: Files are included in ascending order of priority. If</span>
<span class="sd">                         multiple JavaScript files have the same priority,</span>
<span class="sd">                         those files will be included in order of registration.</span>
<span class="sd">                         See list of &quot;priority range for JavaScript files&quot; below.</span>
<span class="sd">        :param loading_method: The loading method for the JavaScript file.</span>
<span class="sd">                               Either ``&#39;async&#39;`` or ``&#39;defer&#39;`` are allowed.</span>
<span class="sd">        :param kwargs: Extra keyword arguments are included as attributes of the</span>
<span class="sd">                       ``&lt;script&gt;`` tag.  If the special keyword argument</span>
<span class="sd">                       ``body`` is given, its value will be added as the content</span>
<span class="sd">                       of the  ``&lt;script&gt;`` tag.</span>

<span class="sd">        Example::</span>

<span class="sd">            app.add_js_file(&#39;example.js&#39;)</span>
<span class="sd">            # =&gt; &lt;script src=&quot;_static/example.js&quot;&gt;&lt;/script&gt;</span>

<span class="sd">            app.add_js_file(&#39;example.js&#39;, loading_method=&#39;async&#39;)</span>
<span class="sd">            # =&gt; &lt;script src=&quot;_static/example.js&quot; async=&quot;async&quot;&gt;&lt;/script&gt;</span>

<span class="sd">            app.add_js_file(None, body=&quot;var myVariable = &#39;foo&#39;;&quot;)</span>
<span class="sd">            # =&gt; &lt;script&gt;var myVariable = &#39;foo&#39;;&lt;/script&gt;</span>

<span class="sd">        .. list-table:: priority range for JavaScript files</span>
<span class="sd">           :widths: 20,80</span>

<span class="sd">           * - Priority</span>
<span class="sd">             - Main purpose in Sphinx</span>
<span class="sd">           * - 200</span>
<span class="sd">             - default priority for built-in JavaScript files</span>
<span class="sd">           * - 500</span>
<span class="sd">             - default priority for extensions</span>
<span class="sd">           * - 800</span>
<span class="sd">             - default priority for :confval:`html_js_files`</span>

<span class="sd">        A JavaScript file can be added to the specific HTML page when an extension</span>
<span class="sd">        calls this method on :event:`html-page-context` event.</span>

<span class="sd">        .. seealso::</span>
<span class="sd">           :meth:`add_static_dir` for copying static files to the output directory</span>

<span class="sd">        .. versionadded:: 0.5</span>

<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Renamed from ``app.add_javascript()``.</span>
<span class="sd">           And it allows keyword arguments as attributes of script tag.</span>

<span class="sd">        .. versionchanged:: 3.5</span>
<span class="sd">           Take priority argument.  Allow to add a JavaScript file to the specific page.</span>
<span class="sd">        .. versionchanged:: 4.4</span>
<span class="sd">           Take loading_method argument.  Allow to change the loading method of the</span>
<span class="sd">           JavaScript file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">loading_method</span> <span class="o">==</span> <span class="s1">&#39;async&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;async&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;async&#39;</span>
        <span class="k">elif</span> <span class="n">loading_method</span> <span class="o">==</span> <span class="s1">&#39;defer&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;defer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;defer&#39;</span>

        <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_js_file</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">add_js_file</span><span class="p">(</span>  <span class="c1"># type: ignore[attr-defined]</span>
                <span class="n">filename</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_css_file">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_css_file">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_css_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">priority</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a stylesheet to include in the HTML output.</span>

<span class="sd">        :param filename: The name of a CSS file that the default HTML</span>
<span class="sd">                         template will include. It must be relative to the HTML</span>
<span class="sd">                         static path, or a full URI with scheme.</span>
<span class="sd">        :param priority: Files are included in ascending order of priority. If</span>
<span class="sd">                         multiple CSS files have the same priority,</span>
<span class="sd">                         those files will be included in order of registration.</span>
<span class="sd">                         See list of &quot;priority range for CSS files&quot; below.</span>
<span class="sd">        :param kwargs: Extra keyword arguments are included as attributes of the</span>
<span class="sd">                       ``&lt;link&gt;`` tag.</span>

<span class="sd">        Example::</span>

<span class="sd">            app.add_css_file(&#39;custom.css&#39;)</span>
<span class="sd">            # =&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/custom.css&quot; type=&quot;text/css&quot; /&gt;</span>

<span class="sd">            app.add_css_file(&#39;print.css&#39;, media=&#39;print&#39;)</span>
<span class="sd">            # =&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;_static/print.css&quot;</span>
<span class="sd">            #          type=&quot;text/css&quot; media=&quot;print&quot; /&gt;</span>

<span class="sd">            app.add_css_file(&#39;fancy.css&#39;, rel=&#39;alternate stylesheet&#39;, title=&#39;fancy&#39;)</span>
<span class="sd">            # =&gt; &lt;link rel=&quot;alternate stylesheet&quot; href=&quot;_static/fancy.css&quot;</span>
<span class="sd">            #          type=&quot;text/css&quot; title=&quot;fancy&quot; /&gt;</span>

<span class="sd">        .. list-table:: priority range for CSS files</span>
<span class="sd">           :widths: 20,80</span>

<span class="sd">           * - Priority</span>
<span class="sd">             - Main purpose in Sphinx</span>
<span class="sd">           * - 200</span>
<span class="sd">             - default priority for built-in CSS files</span>
<span class="sd">           * - 500</span>
<span class="sd">             - default priority for extensions</span>
<span class="sd">           * - 800</span>
<span class="sd">             - default priority for :confval:`html_css_files`</span>

<span class="sd">        A CSS file can be added to the specific HTML page when an extension calls</span>
<span class="sd">        this method on :event:`html-page-context` event.</span>

<span class="sd">        .. seealso::</span>
<span class="sd">           :meth:`add_static_dir` for copying static files to the output directory</span>

<span class="sd">        .. versionadded:: 1.0</span>

<span class="sd">        .. versionchanged:: 1.6</span>
<span class="sd">           Optional ``alternate`` and/or ``title`` attributes can be supplied</span>
<span class="sd">           with the arguments *alternate* (a Boolean) and *title* (a string).</span>
<span class="sd">           The default is no title and *alternate* = ``False``. For</span>
<span class="sd">           more information, refer to the `documentation</span>
<span class="sd">           &lt;https://mdn.io/Web/CSS/Alternative_style_sheets&gt;`__.</span>

<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Renamed from ``app.add_stylesheet()``.</span>
<span class="sd">           And it allows keyword arguments as attributes of link tag.</span>

<span class="sd">        .. versionchanged:: 3.5</span>
<span class="sd">           Take priority argument.  Allow to add a CSS file to the specific page.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding stylesheet: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_css_files</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">contextlib</span><span class="o">.</span><span class="n">suppress</span><span class="p">(</span><span class="ne">AttributeError</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">builder</span><span class="o">.</span><span class="n">add_css_file</span><span class="p">(</span>  <span class="c1"># type: ignore[attr-defined]</span>
                <span class="n">filename</span><span class="p">,</span> <span class="n">priority</span><span class="o">=</span><span class="n">priority</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_static_dir">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_static_dir">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_static_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a static directory to include in HTML output.</span>

<span class="sd">        The given directory&#39;s contents will be copied to the ``_static``</span>
<span class="sd">        directory during an HTML build. Files from extension static directories</span>
<span class="sd">        are copied after theme static files and before any directories from</span>
<span class="sd">        the user-configured ``html_static_path`` setting.</span>

<span class="sd">        Sphinx has built-in support for ``static/`` directories in themes;</span>
<span class="sd">        theme developers should only use this method to register further</span>
<span class="sd">        directories to be copied.</span>

<span class="sd">        :param path: The path to a directory containing static files.</span>
<span class="sd">                     This is typically relative to the extension&#39;s package</span>
<span class="sd">                     directory.</span>

<span class="sd">        Example::</span>

<span class="sd">            from pathlib import Path</span>

<span class="sd">            def setup(app):</span>
<span class="sd">                # All files in this directory are copied to _static/,</span>
<span class="sd">                # preserving the subdirectory structure</span>
<span class="sd">                app.add_static_dir(Path(__file__).parent / &#39;static&#39;)</span>

<span class="sd">                # Add JavaScript and CSS files to HTML pages,</span>
<span class="sd">                # the paths are relative to _static/</span>
<span class="sd">                app.add_js_file(&#39;js/my_extension.js&#39;)</span>
<span class="sd">                app.add_css_file(&#39;css/my_extension.css&#39;)</span>

<span class="sd">        .. versionadded:: 9.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;[app] adding static_dir: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_static_dir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_latex_package">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_latex_package">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_latex_package</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">packagename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">options</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">after_hyperref</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Register a package to include in the LaTeX source code.</span>

<span class="sd">        Add *packagename* to the list of packages that LaTeX source code will</span>
<span class="sd">        include.  If you provide *options*, it will be taken to the `\usepackage`</span>
<span class="sd">        declaration.  If you set *after_hyperref* truthy, the package will be</span>
<span class="sd">        loaded after ``hyperref`` package.</span>

<span class="sd">        .. code-block:: python</span>

<span class="sd">           app.add_latex_package(&#39;mypackage&#39;)</span>
<span class="sd">           # =&gt; \usepackage{mypackage}</span>
<span class="sd">           app.add_latex_package(&#39;mypackage&#39;, &#39;foo,bar&#39;)</span>
<span class="sd">           # =&gt; \usepackage[foo,bar]{mypackage}</span>

<span class="sd">        .. versionadded:: 1.3</span>
<span class="sd">        .. versionadded:: 3.1</span>

<span class="sd">           *after_hyperref* option.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_latex_package</span><span class="p">(</span><span class="n">packagename</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">after_hyperref</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_lexer">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_lexer">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_lexer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alias</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lexer</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Lexer</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new lexer for source code.</span>

<span class="sd">        Use *lexer* to highlight code blocks with the given language *alias*.</span>

<span class="sd">        .. versionadded:: 0.6</span>
<span class="sd">        .. versionchanged:: 2.1</span>
<span class="sd">           Take a lexer class as an argument.</span>
<span class="sd">        .. versionchanged:: 4.0</span>
<span class="sd">           Removed support for lexer instances as an argument.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding lexer: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="n">lexer</span><span class="p">))</span>
        <span class="n">lexer_classes</span><span class="p">[</span><span class="n">alias</span><span class="p">]</span> <span class="o">=</span> <span class="n">lexer</span></div>


<div class="viewcode-block" id="Sphinx.add_autodocumenter">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_autodocumenter">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_autodocumenter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new documenter class for the autodoc extension.</span>

<span class="sd">        Add *cls* as a new documenter class for the :mod:`sphinx.ext.autodoc`</span>
<span class="sd">        extension.  It must be a subclass of</span>
<span class="sd">        :class:`sphinx.ext.autodoc.Documenter`.  This allows auto-documenting</span>
<span class="sd">        new types of objects.  See the source of the autodoc module for</span>
<span class="sd">        examples on how to subclass :class:`~sphinx.ext.autodoc.Documenter`.</span>

<span class="sd">        If *override* is True, the given *cls* is forcedly installed even if</span>
<span class="sd">        a documenter having the same name is already installed.</span>

<span class="sd">        See :ref:`autodoc_ext_tutorial`.</span>

<span class="sd">        .. versionadded:: 0.6</span>
<span class="sd">        .. versionchanged:: 2.2</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding autodocumenter: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.ext.autodoc.directive</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutodocDirective</span>

        <span class="n">objtype</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">objtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_documenter</span><span class="p">(</span><span class="n">objtype</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_directive</span><span class="p">(</span><span class="s1">&#39;auto&#39;</span> <span class="o">+</span> <span class="n">objtype</span><span class="p">,</span> <span class="n">AutodocDirective</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_autodoc_attrgetter">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_autodoc_attrgetter">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_autodoc_attrgetter</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span> <span class="n">getter</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Any</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">Any</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new ``getattr``-like function for the autodoc extension.</span>

<span class="sd">        Add *getter*, which must be a function with an interface compatible to</span>
<span class="sd">        the :func:`getattr` builtin, as the autodoc attribute getter for</span>
<span class="sd">        objects that are instances of *typ*.  All cases where autodoc needs to</span>
<span class="sd">        get an attribute of a type are then handled by this function instead of</span>
<span class="sd">        :func:`getattr`.</span>

<span class="sd">        .. versionadded:: 0.6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding autodoc attrgetter: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">getter</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_autodoc_attrgetter</span><span class="p">(</span><span class="n">typ</span><span class="p">,</span> <span class="n">getter</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_search_language">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_search_language">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_search_language</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">SearchLanguage</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a new language for the HTML search index.</span>

<span class="sd">        Add *cls*, which must be a subclass of</span>
<span class="sd">        :class:`sphinx.search.SearchLanguage`, as a support language for</span>
<span class="sd">        building the HTML full-text search index.  The class must have a *lang*</span>
<span class="sd">        attribute that indicates the language it should be used for.  See</span>
<span class="sd">        :confval:`html_search_language`.</span>

<span class="sd">        .. versionadded:: 1.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding search language: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
        <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.search</span><span class="w"> </span><span class="kn">import</span> <span class="n">languages</span>

        <span class="n">languages</span><span class="p">[</span><span class="bp">cls</span><span class="o">.</span><span class="n">lang</span><span class="p">]</span> <span class="o">=</span> <span class="bp">cls</span></div>


<div class="viewcode-block" id="Sphinx.add_source_suffix">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_source_suffix">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_source_suffix</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a suffix of source files.</span>

<span class="sd">        Same as :confval:`source_suffix`.  The users can override this</span>
<span class="sd">        using the config setting.</span>

<span class="sd">        :param override: If false, do not install it the same suffix</span>
<span class="sd">                         is already installed.</span>
<span class="sd">                         If true, unconditionally install the suffix.</span>

<span class="sd">        .. versionadded:: 1.8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_source_suffix</span><span class="p">(</span><span class="n">suffix</span><span class="p">,</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_source_parser">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_source_parser">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_source_parser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parser</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Parser</span><span class="p">],</span> <span class="n">override</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a parser class.</span>

<span class="sd">        :param override: If false, do not install it if another parser</span>
<span class="sd">                         is already installed for the same suffix.</span>
<span class="sd">                         If true, unconditionally install the parser.</span>

<span class="sd">        .. versionadded:: 1.4</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           *suffix* argument is deprecated.  It only accepts *parser* argument.</span>
<span class="sd">           Use :meth:`add_source_suffix` API to register suffix instead.</span>
<span class="sd">        .. versionchanged:: 1.8</span>
<span class="sd">           Add *override* keyword.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_source_parser</span><span class="p">(</span><span class="n">parser</span><span class="p">,</span> <span class="n">override</span><span class="o">=</span><span class="n">override</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_env_collector">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_env_collector">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_env_collector</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">collector</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">EnvironmentCollector</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register an environment collector class.</span>

<span class="sd">        Refer to :ref:`collector-api`.</span>

<span class="sd">        .. versionadded:: 1.6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding environment collector: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">collector</span><span class="p">)</span>
        <span class="n">collector</span><span class="p">()</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_html_theme">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_html_theme">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_html_theme</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">theme_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a HTML Theme.</span>

<span class="sd">        The *name* is a name of theme, and *theme_path* is a full path to the</span>
<span class="sd">        theme (refs: :ref:`distribute-your-theme`).</span>

<span class="sd">        .. versionadded:: 1.6</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[app] adding HTML theme: </span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">theme_path</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_html_theme</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">theme_path</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_html_math_renderer">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_html_math_renderer">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_html_math_renderer</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">inline_renderers</span><span class="p">:</span> <span class="n">_MathsInlineRenderers</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">block_renderers</span><span class="p">:</span> <span class="n">_MathsBlockRenderers</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a math renderer for HTML.</span>

<span class="sd">        The *name* is a name of math renderer.  Both *inline_renderers* and</span>
<span class="sd">        *block_renderers* are used as visitor functions for the HTML writer:</span>
<span class="sd">        the former for inline math node (``nodes.math``), the latter for</span>
<span class="sd">        block math node (``nodes.math_block``).  Regarding visitor functions,</span>
<span class="sd">        see :meth:`add_node` for details.</span>

<span class="sd">        .. versionadded:: 1.8</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">add_html_math_renderer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">inline_renderers</span><span class="p">,</span> <span class="n">block_renderers</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sphinx.add_message_catalog">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.add_message_catalog">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">add_message_catalog</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">locale_dir</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">PathLike</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a message catalog.</span>

<span class="sd">        :param catalog: The name of the catalog</span>
<span class="sd">        :param locale_dir: The base path of the message catalog</span>

<span class="sd">        For more details, see :func:`sphinx.locale.get_translation()`.</span>

<span class="sd">        .. versionadded:: 1.8</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">locale</span><span class="o">.</span><span class="n">init</span><span class="p">([</span><span class="n">locale_dir</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">language</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)</span>
        <span class="n">locale</span><span class="o">.</span><span class="n">init_console</span><span class="p">(</span><span class="n">locale_dir</span><span class="p">,</span> <span class="n">catalog</span><span class="p">)</span></div>


    <span class="c1"># ---- other methods -------------------------------------------------</span>
<div class="viewcode-block" id="Sphinx.is_parallel_allowed">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.is_parallel_allowed">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_parallel_allowed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check whether parallel processing is allowed or not.</span>

<span class="sd">        :param typ: A type of processing; ``&#39;read&#39;`` or ``&#39;write&#39;``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;read&#39;</span><span class="p">:</span>
            <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;parallel_read_safe&#39;</span>
            <span class="n">message_not_declared</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span>
                <span class="s1">&#39;the </span><span class="si">%s</span><span class="s1"> extension does not declare if it &#39;</span>
                <span class="s1">&#39;is safe for parallel reading, assuming &#39;</span>
                <span class="s2">&quot;it isn&#39;t - please ask the extension author &quot;</span>
                <span class="s1">&#39;to check and make it explicit&#39;</span>
            <span class="p">)</span>
            <span class="n">message_not_safe</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span><span class="s1">&#39;the </span><span class="si">%s</span><span class="s1"> extension is not safe for parallel reading&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">typ</span> <span class="o">==</span> <span class="s1">&#39;write&#39;</span><span class="p">:</span>
            <span class="n">attrname</span> <span class="o">=</span> <span class="s1">&#39;parallel_write_safe&#39;</span>
            <span class="n">message_not_declared</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span>
                <span class="s1">&#39;the </span><span class="si">%s</span><span class="s1"> extension does not declare if it &#39;</span>
                <span class="s1">&#39;is safe for parallel writing, assuming &#39;</span>
                <span class="s2">&quot;it isn&#39;t - please ask the extension author &quot;</span>
                <span class="s1">&#39;to check and make it explicit&#39;</span>
            <span class="p">)</span>
            <span class="n">message_not_safe</span> <span class="o">=</span> <span class="n">__</span><span class="p">(</span><span class="s1">&#39;the </span><span class="si">%s</span><span class="s1"> extension is not safe for parallel writing&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;parallel type </span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="n">typ</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">extensions</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">allowed</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ext</span><span class="p">,</span> <span class="n">attrname</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">allowed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message_not_declared</span><span class="p">,</span> <span class="n">ext</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;doing serial </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">typ</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">allowed</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">message_not_safe</span><span class="p">,</span> <span class="n">ext</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;doing serial </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="n">typ</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="kc">True</span></div>


<div class="viewcode-block" id="Sphinx.set_html_assets_policy">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.Sphinx.set_html_assets_policy">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">set_html_assets_policy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">policy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;always&#39;</span><span class="p">,</span> <span class="s1">&#39;per_page&#39;</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the policy to include assets in HTML pages.</span>

<span class="sd">        - always: include the assets in all the pages</span>
<span class="sd">        - per_page: include the assets only in pages where they are used</span>

<span class="sd">        .. versionadded: 4.1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">policy</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;always&#39;</span><span class="p">,</span> <span class="s1">&#39;per_page&#39;</span><span class="p">}:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;policy </span><span class="si">%s</span><span class="s1"> is not supported&#39;</span> <span class="o">%</span> <span class="n">policy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">html_assets_policy</span> <span class="o">=</span> <span class="n">policy</span></div>
</div>



<div class="viewcode-block" id="TemplateBridge">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.TemplateBridge">[文档]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">TemplateBridge</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class defines the interface for a &quot;template bridge&quot;, that is, a class</span>
<span class="sd">    that renders templates given a template name and a context.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="TemplateBridge.init">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.TemplateBridge.init">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">init</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">builder</span><span class="p">:</span> <span class="n">Builder</span><span class="p">,</span>
        <span class="n">theme</span><span class="p">:</span> <span class="n">Theme</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dirs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called by the builder to initialize the template system.</span>

<span class="sd">        *builder* is the builder object; you&#39;ll probably want to look at the</span>
<span class="sd">        value of ``builder.config.templates_path``.</span>

<span class="sd">        *theme* is a :class:`sphinx.theming.Theme` object or None; in the latter</span>
<span class="sd">        case, *dirs* can be list of fixed directories to look for templates.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;must be implemented in subclasses&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TemplateBridge.newest_template_mtime">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.TemplateBridge.newest_template_mtime">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">newest_template_mtime</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called by the builder to determine if output files are outdated</span>
<span class="sd">        because of template changes.  Return the mtime of the newest template</span>
<span class="sd">        file that was changed.  The default implementation returns ``0``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="TemplateBridge.render">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.TemplateBridge.render">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called by the builder to render a template given as a filename with</span>
<span class="sd">        a specified context (a Python dictionary).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;must be implemented in subclasses&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TemplateBridge.render_string">
<a class="viewcode-back" href="../../extdev/appapi.html#sphinx.application.TemplateBridge.render_string">[文档]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">render_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">context</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called by the builder to render a template given as a string with a</span>
<span class="sd">        specified context (a Python dictionary).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;must be implemented in subclasses&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>
</div>

</pre></div>

    
  <div class="related-pages" role="navigation" aria-label="Related">
    
    <div></div>
    
  </div>

  </div>
</div>
<div class="footer" role="contentinfo">
  
    &#169; 版权所有 2007-2026, the Sphinx developers.
  由 <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.1.0创建。
</div>
  </body>
</html>