<!DOCTYPE html>

<html lang="zh-TW" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>sphinx.ext.autodoc &#8212; Sphinx documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/basic.css?v=29da98fa" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx13.css?v=ba1752c5" />
    <script src="../../../_static/documentation_options.js?v=bae23c90"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/translations.js?v=cbf116e0"></script>
    <link rel="canonical" href="https://projects.localizethedocs.org/sphinx-docs-l10n/_modules/sphinx/ext/autodoc.html" />
    <link rel="search" type="application/opensearchdescription+xml"
          title="在 Sphinx documentation 中搜尋"
          href="../../../_static/opensearch.xml"/>
    <link rel="icon" href="../../../_static/favicon.svg"/>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜尋" href="../../../search.html" />

 

<script type="text/javascript" src="../../../ltd-provenance.js"></script>
<script type="text/javascript" src="../../../ltd-current.js"></script>
<script type="text/javascript" src="../../../../../ltd-config.js"></script>
<script type="text/javascript" src="../../../../../ltd-flyout.js"></script>

  </head><body>

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="github" viewBox="0 0 16 16">
    <title>GitHub</title>
    <svg
      stroke="currentColor"
      fill="currentColor"
      stroke-width="0"
      viewBox="0 0 16 16"
    >
      <path
        fill-rule="evenodd"
        d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"
      ></path>
    </svg>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<div class="pageheader">
  <div class="brand">
    <a href="../../../index.html">
      <img src="../../../_static/sphinx-logo.svg" alt="logo" />
      <span>Sphinx</span>
    </a>
  </div>
  <div class="icons">
    <a href="https://github.com/sphinx-doc/sphinx" title="Source Code" target="_blank">
      <svg><use href="#github"></use></svg>
    </a>
  </div>
</div>

<div class="related" role="navigation" aria-label="Related">
  <h3>瀏覽</h3>
  <ul>
    <li><a href="../../../index.html">Documentation</a> &raquo;</li>
      <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">模組原始碼</a> &#187;</li>
    <li class="nav-item nav-item-this"><a href="">sphinx.ext.autodoc</a></li>
  </ul>
</div>

<div class="document">
  <div class="sphinxsidebar" role="navigation" aria-label="Main">
<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="前往" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
    <div class="sphinxsidebar-navigation__pages">
      <p class="caption" role="heading"><span class="caption-text">基礎知識</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/installation.html">安裝 Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/quickstart.html">開始使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial/index.html">建置您的第一個專案</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">使用者指南</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/index.html">使用 Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../development/index.html">擴充 Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../extdev/index.html">Sphinx API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../latex.html">LaTeX customization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">社群</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../support.html">獲取支援</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../internals/index.html">貢獻 Sphinx</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../faq.html">Sphinx 常見問題</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../authors.html">Sphinx 作者群</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">參考手冊</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../man/index.html">命令行工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/configuration.html">組態</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/extensions/index.html">擴充功能</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usage/restructuredtext/index.html">reStructuredText</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary.html">詞彙表</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../changes/index.html">變更日誌</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../examples.html">使用 Sphinx 的專案</a></li>
</ul>

    </div>
  </div>
  <div class="body" role="main">
    
  <h1>sphinx.ext.autodoc 的原始碼</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Extension to create automatic documentation from code docstrings.</span>

<span class="sd">Automatically insert docstrings for functions, classes or whole modules into</span>
<span class="sd">the doctree, thus avoiding duplication between docstrings and documentation</span>
<span class="sd">for those who like elaborate docstrings.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">__future__</span><span class="w"> </span><span class="kn">import</span> <span class="n">annotations</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">functools</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">operator</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">inspect</span><span class="w"> </span><span class="kn">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">Signature</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">NewType</span><span class="p">,</span> <span class="n">TypeVar</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">docutils.statemachine</span><span class="w"> </span><span class="kn">import</span> <span class="n">StringList</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">sphinx</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">ENUM</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.errors</span><span class="w"> </span><span class="kn">import</span> <span class="n">PycodeError</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.ext.autodoc.importer</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_class_members</span><span class="p">,</span> <span class="n">import_module</span><span class="p">,</span> <span class="n">import_object</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.ext.autodoc.mock</span><span class="w"> </span><span class="kn">import</span> <span class="n">ismock</span><span class="p">,</span> <span class="n">mock</span><span class="p">,</span> <span class="n">undecorate</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.locale</span><span class="w"> </span><span class="kn">import</span> <span class="n">_</span><span class="p">,</span> <span class="n">__</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.pycode</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModuleAnalyzer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util</span><span class="w"> </span><span class="kn">import</span> <span class="n">inspect</span><span class="p">,</span> <span class="n">logging</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.docstrings</span><span class="w"> </span><span class="kn">import</span> <span class="n">prepare_docstring</span><span class="p">,</span> <span class="n">separate_metadata</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.inspect</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">evaluate_signature</span><span class="p">,</span>
    <span class="n">getdoc</span><span class="p">,</span>
    <span class="n">object_description</span><span class="p">,</span>
    <span class="n">safe_getattr</span><span class="p">,</span>
    <span class="n">stringify_signature</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_type_hints</span><span class="p">,</span> <span class="n">restify</span><span class="p">,</span> <span class="n">stringify_annotation</span>

<span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">collections.abc</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Iterator</span><span class="p">,</span> <span class="n">Sequence</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">types</span><span class="w"> </span><span class="kn">import</span> <span class="n">ModuleType</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ClassVar</span><span class="p">,</span> <span class="n">Literal</span><span class="p">,</span> <span class="n">TypeAlias</span>

    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.application</span><span class="w"> </span><span class="kn">import</span> <span class="n">Sphinx</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">Config</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.environment</span><span class="w"> </span><span class="kn">import</span> <span class="n">BuildEnvironment</span><span class="p">,</span> <span class="n">_CurrentDocument</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.events</span><span class="w"> </span><span class="kn">import</span> <span class="n">EventManager</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.ext.autodoc.directive</span><span class="w"> </span><span class="kn">import</span> <span class="n">DocumenterBridge</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.registry</span><span class="w"> </span><span class="kn">import</span> <span class="n">SphinxComponentRegistry</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">sphinx.util.typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExtensionMetadata</span><span class="p">,</span> <span class="n">OptionSpec</span><span class="p">,</span> <span class="n">_RestifyMode</span>

    <span class="n">_AutodocObjType</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span>
        <span class="s1">&#39;module&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;exception&#39;</span><span class="p">,</span> <span class="s1">&#39;function&#39;</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">,</span> <span class="s1">&#39;attribute&#39;</span>
    <span class="p">]</span>
    <span class="n">_AutodocProcessDocstringListener</span><span class="p">:</span> <span class="n">TypeAlias</span> <span class="o">=</span> <span class="n">Callable</span><span class="p">[</span>
        <span class="p">[</span><span class="n">Sphinx</span><span class="p">,</span> <span class="n">_AutodocObjType</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]],</span> <span class="kc">None</span>
    <span class="p">]</span>

<span class="n">logger</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>


<span class="c1"># This type isn&#39;t exposed directly in any modules, but can be found</span>
<span class="c1"># here in most Python versions</span>
<span class="n">MethodDescriptorType</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="nb">type</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">)</span>


<span class="c1">#: extended signature RE: with explicit module name separated by ::</span>
<span class="n">py_ext_sig_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;^ ([\w.]+::)?            # explicit module name</span>
<span class="sd">          ([\w.]+\.)?            # module and/or class name(s)</span>
<span class="sd">          (\w+)  \s*             # thing name</span>
<span class="sd">          (?: \[\s*(.*?)\s*])?   # optional: type parameters list</span>
<span class="sd">          (?: \((.*)\)           # optional: arguments</span>
<span class="sd">           (?:\s* -&gt; \s* (.*))?  #           return annotation</span>
<span class="sd">          )? $                   # and nothing more</span>
<span class="sd">    &quot;&quot;&quot;</span><span class="p">,</span>
    <span class="n">re</span><span class="o">.</span><span class="n">VERBOSE</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">special_member_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^__\S+__$&#39;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">_get_render_mode</span><span class="p">(</span>
    <span class="n">typehints_format</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;fully-qualified&#39;</span><span class="p">,</span> <span class="s1">&#39;short&#39;</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_RestifyMode</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">typehints_format</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;smart&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;fully-qualified-except-typing&#39;</span>


<span class="k">def</span><span class="w"> </span><span class="nf">identity</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_All</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A special value for :*-members: that matches to any member.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>  <span class="c1"># nothing</span>


<span class="k">class</span><span class="w"> </span><span class="nc">_Empty</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A special value for :exclude-members: that never matches to any member.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__contains__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>


<span class="n">ALL</span> <span class="o">=</span> <span class="n">_All</span><span class="p">()</span>
<span class="n">EMPTY</span> <span class="o">=</span> <span class="n">_Empty</span><span class="p">()</span>
<span class="n">UNINITIALIZED_ATTR</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="n">INSTANCEATTR</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
<span class="n">SLOTSATTR</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">members_option</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to convert the :members: option to auto directives.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">{</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">}:</span>
        <span class="k">return</span> <span class="n">ALL</span>
    <span class="k">elif</span> <span class="n">arg</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">exclude_members_option</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">object</span> <span class="o">|</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to convert the :exclude-members: option.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">{</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">}:</span>
        <span class="k">return</span> <span class="n">EMPTY</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()}</span>


<span class="k">def</span><span class="w"> </span><span class="nf">inherited_members_option</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to convert the :inherited-members: option to auto directives.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">{</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">}:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;object&#39;</span><span class="p">}</span>
    <span class="k">elif</span> <span class="n">arg</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">x</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">arg</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">member_order_option</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to convert the :member-order: option to auto directives.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">{</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">}:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;alphabetical&#39;</span><span class="p">,</span> <span class="s1">&#39;bysource&#39;</span><span class="p">,</span> <span class="s1">&#39;groupwise&#39;</span><span class="p">}:</span>
        <span class="k">return</span> <span class="n">arg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;invalid value for member-order option: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">arg</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">class_doc_from_option</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to convert the :class-doc-from: option to autoclass directives.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">}:</span>
        <span class="k">return</span> <span class="n">arg</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">__</span><span class="p">(</span><span class="s1">&#39;invalid value for class-doc-from option: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">arg</span><span class="p">)</span>


<span class="n">SUPPRESS</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>


<span class="k">def</span><span class="w"> </span><span class="nf">annotation_option</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">arg</span> <span class="ow">in</span> <span class="p">{</span><span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">}:</span>
        <span class="c1"># suppress showing the representation of the object</span>
        <span class="k">return</span> <span class="n">SUPPRESS</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">arg</span>


<span class="k">def</span><span class="w"> </span><span class="nf">bool_option</span><span class="p">(</span><span class="n">arg</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Used to convert flag options to auto directives.  (Instead of</span>
<span class="sd">    directives.flag(), which returns None).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>


<span class="k">def</span><span class="w"> </span><span class="nf">merge_members_option</span><span class="p">(</span><span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Merge :private-members: and :special-members: options to the</span>
<span class="sd">    :members: option.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;members&#39;</span><span class="p">)</span> <span class="ow">is</span> <span class="n">ALL</span><span class="p">:</span>
        <span class="c1"># merging is not needed when members: ALL</span>
        <span class="k">return</span>

    <span class="n">members</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;members&#39;</span><span class="p">,</span> <span class="p">[])</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;private-members&#39;</span><span class="p">,</span> <span class="s1">&#39;special-members&#39;</span><span class="p">):</span>
        <span class="n">other_members</span> <span class="o">=</span> <span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">other_members</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other_members</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">ALL</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">other_members</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">member</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
                    <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>


<span class="c1"># Some useful event listener factories for autodoc-process-docstring.</span>


<div class="viewcode-block" id="cut_lines">
<a class="viewcode-back" href="../../../usage/extensions/autodoc.html#sphinx.ext.autodoc.cut_lines">[文件]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">cut_lines</span><span class="p">(</span>
    <span class="n">pre</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">post</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">what</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AutodocProcessDocstringListener</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a listener that removes the first *pre* and last *post*</span>
<span class="sd">    lines of every docstring.  If *what* is a sequence of strings,</span>
<span class="sd">    only docstrings of a type in *what* will be processed.</span>

<span class="sd">    Use like this (e.g. in the ``setup()`` function of :file:`conf.py`)::</span>

<span class="sd">       from sphinx.ext.autodoc import cut_lines</span>

<span class="sd">       app.connect(&#39;autodoc-process-docstring&#39;, cut_lines(4, what={&#39;module&#39;}))</span>

<span class="sd">    This can (and should) be used in place of :confval:`automodule_skip_lines`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">what</span><span class="p">:</span>
        <span class="n">what_unique</span><span class="p">:</span> <span class="nb">frozenset</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">what</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>  <span class="c1"># strongly discouraged</span>
        <span class="n">what_unique</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span><span class="n">what</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">what_unique</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">what</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span>
        <span class="n">app</span><span class="p">:</span> <span class="n">Sphinx</span><span class="p">,</span>
        <span class="n">what_</span><span class="p">:</span> <span class="n">_AutodocObjType</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">what_unique</span> <span class="ow">and</span> <span class="n">what_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">what_unique</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">del</span> <span class="n">lines</span><span class="p">[:</span><span class="n">pre</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">post</span><span class="p">:</span>
            <span class="c1"># remove one trailing blank line.</span>
            <span class="k">if</span> <span class="n">lines</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">del</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="n">post</span><span class="p">:]</span>
        <span class="c1"># make sure there is a blank line at the end</span>
        <span class="k">if</span> <span class="n">lines</span> <span class="ow">and</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">process</span></div>



<div class="viewcode-block" id="between">
<a class="viewcode-back" href="../../../usage/extensions/autodoc.html#sphinx.ext.autodoc.between">[文件]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">between</span><span class="p">(</span>
    <span class="n">marker</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">what</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">keepempty</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">exclude</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">_AutodocProcessDocstringListener</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a listener that either keeps, or if *exclude* is True excludes,</span>
<span class="sd">    lines between lines that match the *marker* regular expression.  If no line</span>
<span class="sd">    matches, the resulting docstring would be empty, so no change will be made</span>
<span class="sd">    unless *keepempty* is true.</span>

<span class="sd">    If *what* is a sequence of strings, only docstrings of a type in *what* will</span>
<span class="sd">    be processed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">marker_re</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">marker</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process</span><span class="p">(</span>
        <span class="n">app</span><span class="p">:</span> <span class="n">Sphinx</span><span class="p">,</span>
        <span class="n">what_</span><span class="p">:</span> <span class="n">_AutodocObjType</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">],</span>
        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">what</span> <span class="ow">and</span> <span class="n">what_</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">what</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">deleted</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">delete</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">exclude</span>
        <span class="n">orig_lines</span> <span class="o">=</span> <span class="n">lines</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">orig_lines</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">deleted</span><span class="p">)</span>
                <span class="n">deleted</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">marker_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
                <span class="n">delete</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">delete</span>
                <span class="k">if</span> <span class="n">delete</span><span class="p">:</span>
                    <span class="n">lines</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="n">deleted</span><span class="p">)</span>
                    <span class="n">deleted</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">keepempty</span><span class="p">:</span>
            <span class="n">lines</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">orig_lines</span>
        <span class="c1"># make sure there is a blank line at the end</span>
        <span class="k">if</span> <span class="n">lines</span> <span class="ow">and</span> <span class="n">lines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">process</span></div>



<span class="c1"># This class is used only in ``sphinx.ext.autodoc.directive``,</span>
<span class="c1"># But we define this class here to keep compatibility</span>
<span class="c1"># See: https://github.com/sphinx-doc/sphinx/issues/4538</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Options</span><span class="p">(</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]):</span>  <span class="c1"># NoQA: FURB189</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A dict/attribute hybrid that returns None on nonexisting keys.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Options</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Options</span><span class="p">(</span><span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ObjectMember</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A member of object.</span>

<span class="sd">    This is used for the result of `Documenter.get_module_members()` to</span>
<span class="sd">    represent each member of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;docstring&#39;</span><span class="p">,</span> <span class="s1">&#39;class_&#39;</span><span class="p">,</span> <span class="s1">&#39;skipped&#39;</span>

    <span class="vm">__name__</span><span class="p">:</span> <span class="nb">str</span>
    <span class="nb">object</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">docstring</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="n">class_</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">skipped</span><span class="p">:</span> <span class="nb">bool</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">docstring</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">class_</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skipped</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">docstring</span> <span class="o">=</span> <span class="n">docstring</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">class_</span> <span class="o">=</span> <span class="n">class_</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skipped</span> <span class="o">=</span> <span class="n">skipped</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;ObjectMember(&#39;</span>
            <span class="sa">f</span><span class="s1">&#39;name=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;obj=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="si">!r}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;docstring=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">docstring</span><span class="si">!r}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;class_=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">class_</span><span class="si">!r}</span><span class="s1">, &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;skipped=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">skipped</span><span class="si">!r}</span><span class="s1">&#39;</span>
            <span class="sa">f</span><span class="s1">&#39;)&#39;</span>
        <span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">Documenter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A Documenter knows how to autodocument a single object type.  When</span>
<span class="sd">    registered with the AutoDirective, it will be used to document objects</span>
<span class="sd">    of that type when needed by autodoc.</span>

<span class="sd">    Its *objtype* attribute selects what auto directive it is assigned to</span>
<span class="sd">    (the directive name is &#39;auto&#39; + objtype), and what directive it generates</span>
<span class="sd">    by default, though that can be overridden by an attribute called</span>
<span class="sd">    *directivetype*.</span>

<span class="sd">    A Documenter has an *option_spec* that works like a docutils directive&#39;s;</span>
<span class="sd">    in fact, it will be used to parse an auto directive&#39;s options that matches</span>
<span class="sd">    the Documenter.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1">#: name by which the directive is called (auto...) and the default</span>
    <span class="c1">#: generated directive name</span>
    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;object&#39;</span>
    <span class="c1">#: indentation by which to indent the directive content</span>
    <span class="n">content_indent</span> <span class="o">=</span> <span class="s1">&#39;   &#39;</span>
    <span class="c1">#: priority if multiple documenters return True from can_document_member</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#: order if autodoc_member_order is set to &#39;groupwise&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1">#: true if the generated content may contain titles</span>
    <span class="n">titles_allowed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">option_spec</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">OptionSpec</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;no-index&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;no-index-entry&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;noindex&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_attr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">defargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;getattr() override for types such as Zope interfaces.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">autodoc_attrgetter</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">defargs</span><span class="p">,</span> <span class="n">registry</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">_registry</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Called to see if a member can be documented by this Documenter.&quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;must be implemented in subclasses&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">directive</span><span class="p">:</span> <span class="n">DocumenterBridge</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">indent</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">directive</span> <span class="o">=</span> <span class="n">directive</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">:</span> <span class="n">Config</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="p">:</span> <span class="n">BuildEnvironment</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="p">:</span> <span class="n">_CurrentDocument</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">current_document</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="p">:</span> <span class="n">EventManager</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">genopt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">indent</span>
        <span class="c1"># the module and object path within the module, and the fully</span>
        <span class="c1"># qualified name (all set after resolve_name succeeds)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">:</span> <span class="n">ModuleType</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># extra signature items (arguments and return annotation,</span>
        <span class="c1"># also set after resolve_name succeeds)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retann</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># the object to document (set after import_object succeeds)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="c1"># the parent/owner of the object to document</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># the module analyzer to get at attribute docs, or None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">:</span> <span class="n">ModuleAnalyzer</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">documenters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns registered Documenter classes&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">_registry</span><span class="o">.</span><span class="n">documenters</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_line</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">lineno</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Append one line of generated reST to the output.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">():</span>  <span class="c1"># not a blank line</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">+</span> <span class="n">line</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="o">*</span><span class="n">lineno</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="o">*</span><span class="n">lineno</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_name</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Resolve the module and name of the object to document given by the</span>
<span class="sd">        arguments and the current module/class.</span>

<span class="sd">        Must return a pair of the module name and a chain of attributes; for</span>
<span class="sd">        example, it would return ``(&#39;zipfile&#39;, [&#39;ZipFile&#39;, &#39;open&#39;])`` for the</span>
<span class="sd">        ``zipfile.ZipFile.open`` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;must be implemented in subclasses&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determine what module to import and what attribute to document.</span>

<span class="sd">        Returns True and sets *self.modname*, *self.objpath*, *self.fullname*,</span>
<span class="sd">        *self.args* and *self.retann* if parsing and resolving was successful.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># first, parse the definition -- auto directives for classes and</span>
        <span class="c1"># functions can contain a signature which is then used instead of</span>
        <span class="c1"># an autogenerated one</span>
        <span class="n">matched</span> <span class="o">=</span> <span class="n">py_ext_sig_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">matched</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;invalid signature for auto</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%r</span><span class="s1">)&#39;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">explicit_modname</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">tp_list</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">retann</span> <span class="o">=</span> <span class="n">matched</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>

        <span class="c1"># support explicit module and class name separation via ::</span>
        <span class="k">if</span> <span class="n">explicit_modname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">modname</span> <span class="o">=</span> <span class="n">explicit_modname</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
            <span class="n">parents</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">path</span> <span class="k">else</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">modname</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">parents</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="n">mock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_mock_imports</span><span class="p">):</span>
            <span class="n">modname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_name</span><span class="p">(</span><span class="n">modname</span><span class="p">,</span> <span class="n">parents</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">base</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">modname</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">modname</span> <span class="o">=</span> <span class="n">modname</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">retann</span> <span class="o">=</span> <span class="n">retann</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">modname</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">))</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Import the object given by *self.modname* and *self.objpath* and set</span>
<span class="sd">        it as *self.object*.</span>

<span class="sd">        Returns True if successful, False if an error occurred.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">mock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_mock_imports</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">import_object</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">,</span> <span class="n">attrgetter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">ret</span>
                <span class="k">if</span> <span class="n">ismock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">undecorate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">raiseerror</span><span class="p">:</span>
                    <span class="k">raise</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;import_object&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">note_reread</span><span class="p">()</span>
                <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_real_modname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the real module name of an object to document.</span>

<span class="sd">        It can differ from the name of the module through which the object was</span>
<span class="sd">        imported.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">check_module</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check if *self.object* is really defined in the module given by</span>
<span class="sd">        *self.modname*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">imported_members</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>

        <span class="n">subject</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">unpartial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="n">modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">modname</span> <span class="ow">or</span> <span class="n">modname</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format the argument signature of *self.object*.</span>

<span class="sd">        Should return None if the object does not have a signature.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format the name of *self.object*.</span>

<span class="sd">        This normally should be something that can be parsed by the generated</span>
<span class="sd">        directive, but doesn&#39;t need to be (Sphinx will display it unparsed</span>
<span class="sd">        then).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># normally the name doesn&#39;t contain the module (except for module</span>
        <span class="c1"># directives of course)</span>
        <span class="k">return</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_call_format_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_args</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="c1"># avoid chaining exceptions, by putting nothing here</span>
                <span class="k">pass</span>

        <span class="c1"># retry without arguments for old documenters</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_args</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Format the signature (arguments and return annotation) of the object.</span>

<span class="sd">        Let the user process it via the ``autodoc-process-signature`` event.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># signature given explicitly</span>
            <span class="n">args</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="si">}</span><span class="s1">)&#39;</span>
            <span class="n">retann</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">retann</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># try to introspect the signature</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">retann</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_format_args</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">args</span><span class="p">:</span>
                    <span class="n">matched</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^(\(.*\))\s+-&gt;\s+(.*)$&#39;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">matched</span><span class="p">:</span>
                        <span class="n">args</span> <span class="o">=</span> <span class="n">matched</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                        <span class="n">retann</span> <span class="o">=</span> <span class="n">matched</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="n">__</span><span class="p">(</span><span class="s1">&#39;error while formatting arguments for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
                    <span class="n">exc</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">args</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit_firstresult</span><span class="p">(</span>
            <span class="s1">&#39;autodoc-process-signature&#39;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
            <span class="n">args</span><span class="p">,</span>
            <span class="n">retann</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
            <span class="n">args</span><span class="p">,</span> <span class="n">retann</span> <span class="o">=</span> <span class="n">result</span>

        <span class="k">if</span> <span class="n">args</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">args</span> <span class="o">+</span> <span class="p">((</span><span class="s1">&#39; -&gt; </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">retann</span><span class="p">)</span> <span class="k">if</span> <span class="n">retann</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add the directive header and options to the generated content.&quot;&quot;&quot;</span>
        <span class="n">domain</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;domain&#39;</span><span class="p">,</span> <span class="s1">&#39;py&#39;</span><span class="p">)</span>
        <span class="n">directive</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;directivetype&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_name</span><span class="p">()</span>
        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>

        <span class="c1"># one signature per line, indented by column</span>
        <span class="n">prefix</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;.. </span><span class="si">{</span><span class="n">domain</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">directive</span><span class="si">}</span><span class="s1">:: &#39;</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sig_line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">prefix</span><span class="si">}{</span><span class="n">name</span><span class="si">}{</span><span class="n">sig_line</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">no_index</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">noindex</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :no-index:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">no_index_entry</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :no-index-entry:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">:</span>
            <span class="c1"># Be explicit about the module, this is necessary since .. class::</span>
            <span class="c1"># etc. don&#39;t support a prepended module name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :module: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Decode and return lines of the docstring(s) for the object.</span>

<span class="sd">        When it returns None, autodoc-process-docstring will not be called for this</span>
<span class="sd">        object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">docstring</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">docstring</span><span class="p">:</span>
            <span class="n">tab_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tab_width</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">prepare_docstring</span><span class="p">(</span><span class="n">docstring</span><span class="p">,</span> <span class="n">tab_width</span><span class="p">)]</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">process_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">docstrings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">Iterator</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Let the user process the docstrings before adding them.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">docstringlines</span> <span class="ow">in</span> <span class="n">docstrings</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># let extensions preprocess docstrings</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                    <span class="s1">&#39;autodoc-process-docstring&#39;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
                    <span class="n">docstringlines</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">docstringlines</span> <span class="ow">and</span> <span class="n">docstringlines</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="c1"># append a blank line to the end of the docstring</span>
                    <span class="n">docstringlines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>

            <span class="k">yield from</span> <span class="n">docstringlines</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_sourcename</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">obj_module</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">obj_qualname</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__qualname__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj_module</span> <span class="ow">and</span> <span class="n">obj_qualname</span><span class="p">:</span>
            <span class="c1"># Get the correct location of docstring from self.object</span>
            <span class="c1"># to support inherited methods</span>
            <span class="n">fullname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__qualname__</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fullname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">srcname</span><span class="si">}</span><span class="s1">:docstring of </span><span class="si">{</span><span class="n">fullname</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;docstring of </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">fullname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add content from docstrings, attribute documentation and user.&quot;&quot;&quot;</span>
        <span class="n">docstring</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># set sourcename and add content from attribute documentation</span>
        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">:</span>
            <span class="n">attr_docs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">find_attr_docs</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">:</span>
                <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">attr_docs</span><span class="p">:</span>
                    <span class="n">docstring</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="c1"># make a copy of docstring for attributes to avoid cache</span>
                    <span class="c1"># the change of autodoc-process-docstring event.</span>
                    <span class="n">attribute_docstrings</span> <span class="o">=</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="n">attr_docs</span><span class="p">[</span><span class="n">key</span><span class="p">])]</span>

                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_doc</span><span class="p">(</span><span class="n">attribute_docstrings</span><span class="p">)):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="c1"># add content from docstrings</span>
        <span class="k">if</span> <span class="n">docstring</span><span class="p">:</span>
            <span class="n">docstrings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">docstrings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Do not call autodoc-process-docstring on get_doc() returns None.</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">docstrings</span><span class="p">:</span>
                    <span class="c1"># append at least a dummy docstring, so that the event</span>
                    <span class="c1"># autodoc-process-docstring is fired and can add some</span>
                    <span class="c1"># content if desired</span>
                    <span class="n">docstrings</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_doc</span><span class="p">(</span><span class="n">docstrings</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="c1"># add additional content (e.g. from document), if present</span>
        <span class="k">if</span> <span class="n">more_content</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">more_content</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">more_content</span><span class="o">.</span><span class="n">items</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">want_all</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ObjectMember</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return `(members_check_module, members)` where `members` is a</span>
<span class="sd">        list of `(membername, member)` pairs of the members of *self.object*.</span>

<span class="sd">        If *want_all* is True, return all members.  Else, only return those</span>
<span class="sd">        members given by *self.options.members* (which may also be None).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;must be implemented in subclasses&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">filter_members</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">members</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ObjectMember</span><span class="p">],</span> <span class="n">want_all</span><span class="p">:</span> <span class="nb">bool</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Filter the given member list.</span>

<span class="sd">        Members are skipped if</span>

<span class="sd">        - they are private (except if given explicitly or the private-members</span>
<span class="sd">          option is set)</span>
<span class="sd">        - they are special methods (except if given explicitly or the</span>
<span class="sd">          special-members option is set)</span>
<span class="sd">        - they are undocumented (except if the undoc-members option is set)</span>

<span class="sd">        The user can override the skipping decision by connecting to the</span>
<span class="sd">        ``autodoc-skip-member`` event.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">is_filtered_inherited_member</span><span class="p">(</span><span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">inherited_members</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">inherited_members</span> <span class="ow">or</span> <span class="nb">set</span><span class="p">()</span>
            <span class="n">seen</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
                <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
                        <span class="n">seen</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">in</span> <span class="n">inherited_members</span>
                        <span class="ow">and</span> <span class="bp">cls</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span>
                        <span class="ow">and</span> <span class="nb">any</span><span class="p">(</span>
                            <span class="nb">issubclass</span><span class="p">(</span><span class="n">potential_child</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span> <span class="k">for</span> <span class="n">potential_child</span> <span class="ow">in</span> <span class="n">seen</span>
                        <span class="p">)</span>
                    <span class="p">):</span>
                        <span class="c1"># given member is a member of specified *super class*</span>
                        <span class="k">return</span> <span class="kc">True</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__annotations__&#39;</span><span class="p">,</span> <span class="p">{}):</span>
                        <span class="k">return</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjectMember</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">class_</span> <span class="ow">is</span> <span class="bp">cls</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">False</span>

            <span class="k">return</span> <span class="kc">False</span>

        <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># search for members in source code too</span>
        <span class="n">namespace</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)</span>  <span class="c1"># will be empty for modules</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">:</span>
            <span class="n">attr_docs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">find_attr_docs</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attr_docs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># process members and determine which to skip</span>
        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
            <span class="n">membername</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="n">member</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">object</span>

            <span class="c1"># if isattr is True, the member is documented as an attribute</span>
            <span class="n">isattr</span> <span class="o">=</span> <span class="n">member</span> <span class="ow">is</span> <span class="n">INSTANCEATTR</span> <span class="ow">or</span> <span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">membername</span><span class="p">)</span> <span class="ow">in</span> <span class="n">attr_docs</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">doc</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span>
                    <span class="n">member</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                    <span class="n">membername</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="c1"># Ignore non-string __doc__</span>
                    <span class="n">doc</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="c1"># if the member __doc__ is the same as self&#39;s __doc__, it&#39;s just</span>
                <span class="c1"># inherited and therefore not the member&#39;s doc</span>
                <span class="bp">cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="s1">&#39;__class__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="p">:</span>
                    <span class="n">cls_doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">cls_doc</span> <span class="o">==</span> <span class="n">doc</span><span class="p">:</span>
                        <span class="n">doc</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjectMember</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">docstring</span><span class="p">:</span>
                    <span class="c1"># hack for ClassDocumenter to inject docstring via ObjectMember</span>
                    <span class="n">doc</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">docstring</span>

                <span class="n">doc</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">separate_metadata</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                <span class="n">has_doc</span> <span class="o">=</span> <span class="nb">bool</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>

                <span class="k">if</span> <span class="s1">&#39;private&#39;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
                    <span class="c1"># consider a member private if docstring has &quot;private&quot; metadata</span>
                    <span class="n">isprivate</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="s1">&#39;public&#39;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
                    <span class="c1"># consider a member public if docstring has &quot;public&quot; metadata</span>
                    <span class="n">isprivate</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">isprivate</span> <span class="o">=</span> <span class="n">membername</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>

                <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">ismock</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">membername</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">attr_docs</span><span class="p">:</span>
                    <span class="c1"># mocked module or object</span>
                    <span class="k">pass</span>
                <span class="k">elif</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">exclude_members</span>
                    <span class="ow">and</span> <span class="n">membername</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">exclude_members</span>
                <span class="p">):</span>
                    <span class="c1"># remove members given by exclude-members</span>
                    <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="n">want_all</span> <span class="ow">and</span> <span class="n">special_member_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">membername</span><span class="p">):</span>
                    <span class="c1"># special __methods__</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">special_members</span>
                        <span class="ow">and</span> <span class="n">membername</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">special_members</span>
                    <span class="p">):</span>
                        <span class="k">if</span> <span class="n">membername</span> <span class="o">==</span> <span class="s1">&#39;__doc__&#39;</span><span class="p">:</span>  <span class="c1"># NoQA: SIM114</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">elif</span> <span class="n">is_filtered_inherited_member</span><span class="p">(</span><span class="n">membername</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="n">has_doc</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">undoc_members</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">elif</span> <span class="p">(</span><span class="n">namespace</span><span class="p">,</span> <span class="n">membername</span><span class="p">)</span> <span class="ow">in</span> <span class="n">attr_docs</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">want_all</span> <span class="ow">and</span> <span class="n">isprivate</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">private_members</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="n">membername</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">private_members</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># keep documented attributes</span>
                        <span class="n">keep</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">elif</span> <span class="n">want_all</span> <span class="ow">and</span> <span class="n">isprivate</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">has_doc</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">undoc_members</span><span class="p">:</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">private_members</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># NoQA: SIM114</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">elif</span> <span class="n">is_filtered_inherited_member</span><span class="p">(</span><span class="n">membername</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">keep</span> <span class="o">=</span> <span class="n">membername</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">private_members</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">members</span> <span class="ow">is</span> <span class="n">ALL</span> <span class="ow">and</span> <span class="n">is_filtered_inherited_member</span><span class="p">(</span>
                        <span class="n">membername</span><span class="p">,</span> <span class="n">obj</span>
                    <span class="p">):</span>
                        <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># ignore undocumented members if :undoc-members: is not given</span>
                        <span class="n">keep</span> <span class="o">=</span> <span class="n">has_doc</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">undoc_members</span>

                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">ObjectMember</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">skipped</span><span class="p">:</span>
                    <span class="c1"># forcedly skipped member (ex. a module attribute not defined in __all__)</span>
                    <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>

                <span class="c1"># give the user a chance to decide whether this member</span>
                <span class="c1"># should be skipped</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># let extensions preprocess docstrings</span>
                    <span class="n">skip_user</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit_firstresult</span><span class="p">(</span>
                        <span class="s1">&#39;autodoc-skip-member&#39;</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">objtype</span><span class="p">,</span>
                        <span class="n">membername</span><span class="p">,</span>
                        <span class="n">member</span><span class="p">,</span>
                        <span class="ow">not</span> <span class="n">keep</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">skip_user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="n">keep</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">skip_user</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="n">__</span><span class="p">(</span>
                        <span class="s1">&#39;autodoc: failed to determine </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1"> (</span><span class="si">%r</span><span class="s1">) to be documented, &#39;</span>
                        <span class="s1">&#39;the following exception was raised:</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span>
                    <span class="p">),</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">membername</span><span class="p">,</span>
                    <span class="n">member</span><span class="p">,</span>
                    <span class="n">exc</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">keep</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">keep</span><span class="p">:</span>
                <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">membername</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="n">isattr</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">document_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate reST for member documentation.</span>

<span class="sd">        If *all_members* is True, document all members, else those given by</span>
<span class="sd">        *self.options.members*.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set current namespace for finding members</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="o">.</span><span class="n">autodoc_module</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="o">.</span><span class="n">autodoc_class</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">want_all</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">all_members</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">inherited_members</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">members</span> <span class="ow">is</span> <span class="n">ALL</span>
        <span class="p">)</span>
        <span class="c1"># find out which members are documentable</span>
        <span class="n">members_check_module</span><span class="p">,</span> <span class="n">members</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_object_members</span><span class="p">(</span><span class="n">want_all</span><span class="p">)</span>

        <span class="c1"># document non-skipped members</span>
        <span class="n">member_documenters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Documenter</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">mname</span><span class="p">,</span> <span class="n">member</span><span class="p">,</span> <span class="n">isattr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filter_members</span><span class="p">(</span><span class="n">members</span><span class="p">,</span> <span class="n">want_all</span><span class="p">):</span>
            <span class="n">classes</span> <span class="o">=</span> <span class="p">[</span>
                <span class="bp">cls</span>
                <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">documenters</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="n">can_document_member</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">mname</span><span class="p">,</span> <span class="n">isattr</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">classes</span><span class="p">:</span>
                <span class="c1"># don&#39;t know how to document this member</span>
                <span class="k">continue</span>
            <span class="c1"># prefer the documenter with the highest priority</span>
            <span class="n">classes</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="bp">cls</span><span class="p">:</span> <span class="bp">cls</span><span class="o">.</span><span class="n">priority</span><span class="p">)</span>
            <span class="c1"># give explicitly separated module name, so that members</span>
            <span class="c1"># of inner classes can be documented</span>
            <span class="n">full_mname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="si">}</span><span class="s1">::&#39;</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">,</span> <span class="n">mname</span><span class="p">))</span>
            <span class="n">documenter</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="p">,</span> <span class="n">full_mname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent</span><span class="p">)</span>
            <span class="n">member_documenters</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">documenter</span><span class="p">,</span> <span class="n">isattr</span><span class="p">))</span>

        <span class="n">member_order</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">member_order</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_member_order</span>
        <span class="c1"># We now try to import all objects before ordering them. This is to</span>
        <span class="c1"># avoid possible circular imports if we were to import objects after</span>
        <span class="c1"># their associated documenters have been sorted.</span>
        <span class="n">member_documenters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">documenter</span><span class="p">,</span> <span class="n">isattr</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">documenter</span><span class="p">,</span> <span class="n">isattr</span> <span class="ow">in</span> <span class="n">member_documenters</span>
            <span class="k">if</span> <span class="n">documenter</span><span class="o">.</span><span class="n">parse_name</span><span class="p">()</span> <span class="ow">and</span> <span class="n">documenter</span><span class="o">.</span><span class="n">import_object</span><span class="p">()</span>
        <span class="p">]</span>
        <span class="n">member_documenters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sort_members</span><span class="p">(</span><span class="n">member_documenters</span><span class="p">,</span> <span class="n">member_order</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">documenter</span><span class="p">,</span> <span class="n">isattr</span> <span class="ow">in</span> <span class="n">member_documenters</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">documenter</span><span class="o">.</span><span class="n">modname</span>
            <span class="c1"># We can directly call ._generate() since the documenters</span>
            <span class="c1"># already called parse_name() and import_object() before.</span>
            <span class="c1">#</span>
            <span class="c1"># Note that those two methods above do not emit events, so</span>
            <span class="c1"># whatever objects we deduced should not have changed.</span>
            <span class="n">documenter</span><span class="o">.</span><span class="n">_generate</span><span class="p">(</span>
                <span class="n">all_members</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">real_modname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">real_modname</span><span class="p">,</span>
                <span class="n">check_module</span><span class="o">=</span><span class="n">members_check_module</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">isattr</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># reset current objects</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="o">.</span><span class="n">autodoc_module</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="o">.</span><span class="n">autodoc_class</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort_members</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">documenters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Documenter</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Documenter</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sort the given member list.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;groupwise&#39;</span><span class="p">:</span>
            <span class="c1"># sort by group; alphabetically within groups</span>
            <span class="n">documenters</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="p">(</span><span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">member_order</span><span class="p">,</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">))</span>
        <span class="k">elif</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;bysource&#39;</span><span class="p">:</span>
            <span class="c1"># By default, member discovery order matches source order,</span>
            <span class="c1"># as dicts are insertion-ordered from Python 3.7.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">:</span>
                <span class="c1"># sort by source order, by virtue of the module analyzer</span>
                <span class="n">tagorder</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">tagorder</span>

                <span class="k">def</span><span class="w"> </span><span class="nf">keyfunc</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Documenter</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
                    <span class="n">fullname</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                    <span class="k">return</span> <span class="n">tagorder</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">fullname</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tagorder</span><span class="p">))</span>

                <span class="n">documenters</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">keyfunc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># alphabetical</span>
            <span class="n">documenters</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">documenters</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">real_modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">check_module</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generate reST for the object given by *self.name*, and possibly for</span>
<span class="sd">        its members.</span>

<span class="sd">        If *more_content* is given, include that content. If *real_modname* is</span>
<span class="sd">        given, use that module name to find attribute docs. If *check_module* is</span>
<span class="sd">        True, only generate if the object is defined in the module name it is</span>
<span class="sd">        imported from. If *all_members* is True, document all members.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">parse_name</span><span class="p">():</span>
            <span class="c1"># need a module to import</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span>
                    <span class="s2">&quot;don&#39;t know which module to import for autodocumenting &quot;</span>
                    <span class="s1">&#39;</span><span class="si">%r</span><span class="s1"> (try placing a &quot;module&quot; or &quot;currentmodule&quot; directive &#39;</span>
                    <span class="s1">&#39;in the document, or giving an explicit module name)&#39;</span>
                <span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># now, import the module and get object to document</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">import_object</span><span class="p">():</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_generate</span><span class="p">(</span><span class="n">more_content</span><span class="p">,</span> <span class="n">real_modname</span><span class="p">,</span> <span class="n">check_module</span><span class="p">,</span> <span class="n">all_members</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_generate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">real_modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">check_module</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If there is no real module defined, figure out which to use.</span>
        <span class="c1"># The real module is used in the module analyzer to look up the module</span>
        <span class="c1"># where the attribute documentation would actually be found in.</span>
        <span class="c1"># This is used for situations where you have a module that collects the</span>
        <span class="c1"># functions and classes of internal submodules.</span>
        <span class="n">guess_modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_real_modname</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">real_modname</span> <span class="ow">or</span> <span class="n">guess_modname</span>

        <span class="c1"># try to also get a source code analyzer for attribute docs</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">real_modname</span><span class="p">)</span>
            <span class="c1"># parse right now, to get PycodeErrors on parsing (results will</span>
            <span class="c1"># be cached anyway)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">find_attr_docs</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">PycodeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;[autodoc] module analyzer failed: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">exc</span><span class="p">)</span>
            <span class="c1"># no source file -- e.g. for builtin and C modules</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># at least add the module.__file__ as a dependency</span>
            <span class="k">if</span> <span class="n">module___file__</span> <span class="o">:=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">module</span><span class="p">,</span> <span class="s1">&#39;__file__&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">record_dependencies</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">module___file__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">record_dependencies</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">srcname</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_modname</span> <span class="o">!=</span> <span class="n">guess_modname</span><span class="p">:</span>
            <span class="c1"># Add module to dependency list if target object is defined in other module.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="n">guess_modname</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">record_dependencies</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">srcname</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">PycodeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="n">docstrings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span>
            <span class="n">operator</span><span class="o">.</span><span class="n">iadd</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span> <span class="ow">or</span> <span class="p">[],</span> <span class="p">[]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">ismock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">docstrings</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;A mocked object is detected: </span><span class="si">%r</span><span class="s1">&#39;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
                <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;mocked_object&#39;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># check __module__ of object (for members not given explicitly)</span>
        <span class="k">if</span> <span class="n">check_module</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">check_module</span><span class="p">():</span>
                <span class="k">return</span>

        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>

        <span class="c1"># make sure that the result starts with an empty line.  This is</span>
        <span class="c1"># necessary for some situations where another directive preprocesses</span>
        <span class="c1"># reST and no starting newline is present</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

        <span class="c1"># format the object&#39;s signature, if any</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_signature</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;error while formatting signature for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
                <span class="n">exc</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># generate the directive header and options, if applicable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

        <span class="c1"># e.g. the module directive doesn&#39;t have content</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">content_indent</span>

        <span class="c1"># add all content (from docstrings, attribute docs etc.)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_content</span><span class="p">(</span><span class="n">more_content</span><span class="p">)</span>

        <span class="c1"># document members, if possible</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">document_members</span><span class="p">(</span><span class="n">all_members</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ModuleDocumenter</span><span class="p">(</span><span class="n">Documenter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for modules.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;module&#39;</span>
    <span class="n">content_indent</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">_extra_indent</span> <span class="o">=</span> <span class="s1">&#39;   &#39;</span>

    <span class="n">option_spec</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">OptionSpec</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;members&#39;</span><span class="p">:</span> <span class="n">members_option</span><span class="p">,</span>
        <span class="s1">&#39;undoc-members&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;no-index&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;no-index-entry&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;inherited-members&#39;</span><span class="p">:</span> <span class="n">inherited_members_option</span><span class="p">,</span>
        <span class="s1">&#39;show-inheritance&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;synopsis&#39;</span><span class="p">:</span> <span class="n">identity</span><span class="p">,</span>
        <span class="s1">&#39;platform&#39;</span><span class="p">:</span> <span class="n">identity</span><span class="p">,</span>
        <span class="s1">&#39;deprecated&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;member-order&#39;</span><span class="p">:</span> <span class="n">member_order_option</span><span class="p">,</span>
        <span class="s1">&#39;exclude-members&#39;</span><span class="p">:</span> <span class="n">exclude_members_option</span><span class="p">,</span>
        <span class="s1">&#39;private-members&#39;</span><span class="p">:</span> <span class="n">members_option</span><span class="p">,</span>
        <span class="s1">&#39;special-members&#39;</span><span class="p">:</span> <span class="n">members_option</span><span class="p">,</span>
        <span class="s1">&#39;imported-members&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;ignore-module-all&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;no-value&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;noindex&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">merge_members_option</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__all__</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">old_indent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">indent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extra_indent</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_content</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indent</span> <span class="o">=</span> <span class="n">old_indent</span>
        <span class="k">if</span> <span class="n">more_content</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span><span class="p">,</span> <span class="n">src</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">more_content</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">more_content</span><span class="o">.</span><span class="n">items</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">src</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">src</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># don&#39;t document submodules automatically</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_name</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="n">modname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;&quot;::&quot; in automodule name doesn</span><span class="se">\&#39;</span><span class="s1">t make sense&#39;</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">path</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">base</span><span class="p">,</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">parse_name</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">parse_name</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">retann</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;signature arguments or return annotation given for automodule </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">ignore_module_all</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__all__</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getall</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># invalid __all__ found.</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span>
                    <span class="s1">&#39;__all__ should be a list of strings, not </span><span class="si">%r</span><span class="s1"> &#39;</span>
                    <span class="s1">&#39;(in module </span><span class="si">%s</span><span class="s1">) -- ignoring __all__&#39;</span>
                <span class="p">),</span>
                <span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">Documenter</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>

        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>

        <span class="c1"># add some module-specific options</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">synopsis</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :synopsis: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">synopsis</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">platform</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :platform: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">platform</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">deprecated</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :deprecated:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">no_index_entry</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :no-index-entry:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_module_members</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ObjectMember</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get members of target module.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="p">:</span>
            <span class="n">attr_docs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">attr_docs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attr_docs</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">members</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">ObjectMember</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ismock</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">undecorate</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="n">docstring</span> <span class="o">=</span> <span class="n">attr_docs</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="p">[])</span>
                <span class="n">members</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ObjectMember</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">docstring</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">continue</span>

        <span class="c1"># annotation only member (ex. attr: int)</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getannotations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
                <span class="n">docstring</span> <span class="o">=</span> <span class="n">attr_docs</span><span class="o">.</span><span class="n">get</span><span class="p">((</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="p">[])</span>
                <span class="n">members</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">ObjectMember</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span> <span class="n">INSTANCEATTR</span><span class="p">,</span> <span class="n">docstring</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">docstring</span><span class="p">)</span>
                <span class="p">)</span>

        <span class="k">return</span> <span class="n">members</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">want_all</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ObjectMember</span><span class="p">]]:</span>
        <span class="n">members</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_module_members</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">want_all</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all__</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># for implicit module members, check __module__ to avoid</span>
                <span class="c1"># documenting imported objects</span>
                <span class="k">return</span> <span class="kc">True</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">members</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">members</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="k">if</span> <span class="n">member</span><span class="o">.</span><span class="vm">__name__</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all__</span><span class="p">:</span>
                        <span class="n">member</span><span class="o">.</span><span class="n">skipped</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">members</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">memberlist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">members</span> <span class="ow">or</span> <span class="p">[]</span>
            <span class="n">ret</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">memberlist</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
                    <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">members</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="n">__</span><span class="p">(</span>
                            <span class="s1">&#39;missing attribute mentioned in :members: option: &#39;</span>
                            <span class="s1">&#39;module </span><span class="si">%s</span><span class="s1">, attribute </span><span class="si">%s</span><span class="s1">&#39;</span>
                        <span class="p">),</span>
                        <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="s1">&#39;???&#39;</span><span class="p">),</span>
                        <span class="n">name</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sort_members</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">documenters</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Documenter</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]],</span> <span class="n">order</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Documenter</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="n">order</span> <span class="o">==</span> <span class="s1">&#39;bysource&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all__</span><span class="p">:</span>
            <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="n">module_all</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__all__</span>
            <span class="n">module_all_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">module_all</span><span class="p">)</span>
            <span class="n">module_all_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">module_all</span><span class="p">)</span>

            <span class="c1"># Sort alphabetically first (for members not listed on the __all__)</span>
            <span class="n">documenters</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">e</span><span class="p">:</span> <span class="n">e</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

            <span class="c1"># Sort by __all__</span>
            <span class="k">def</span><span class="w"> </span><span class="nf">keyfunc</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Documenter</span><span class="p">,</span> <span class="nb">bool</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;::&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">module_all_set</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">module_all</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">module_all_len</span>

            <span class="n">documenters</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">keyfunc</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">documenters</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">sort_members</span><span class="p">(</span><span class="n">documenters</span><span class="p">,</span> <span class="n">order</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ModuleLevelDocumenter</span><span class="p">(</span><span class="n">Documenter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for objects on module level (functions,</span>
<span class="sd">    classes, data/constants).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_name</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="n">modname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">modname</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">parents</span><span class="p">,</span> <span class="n">base</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">modname</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">modname</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">parents</span><span class="p">,</span> <span class="n">base</span><span class="p">]</span>

        <span class="c1"># if documenting a toplevel object without explicit module,</span>
        <span class="c1"># it can be contained in another auto directive ...</span>
        <span class="n">modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="o">.</span><span class="n">autodoc_module</span>
        <span class="c1"># ... or in the scope of a module directive</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modname</span><span class="p">:</span>
            <span class="n">modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">ref_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;py:module&#39;</span><span class="p">)</span>
        <span class="c1"># ... else, it stays None, which means invalid</span>
        <span class="k">return</span> <span class="n">modname</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">parents</span><span class="p">,</span> <span class="n">base</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ClassLevelDocumenter</span><span class="p">(</span><span class="n">Documenter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for objects on class level (methods,</span>
<span class="sd">    attributes).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">resolve_name</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parents</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">base</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
        <span class="k">if</span> <span class="n">modname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">modname</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">parents</span><span class="p">,</span> <span class="n">base</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">mod_cls</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># if documenting a class-level object without path,</span>
            <span class="c1"># there must be a current class, either from a parent</span>
            <span class="c1"># auto directive ...</span>
            <span class="n">mod_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="o">.</span><span class="n">autodoc_class</span>
            <span class="c1"># ... or from a class directive</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">mod_cls</span><span class="p">:</span>
                <span class="n">mod_cls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">ref_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;py:class&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="c1"># ... if still falsy, there&#39;s no way to know</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">mod_cls</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="p">[]</span>
        <span class="n">modname</span><span class="p">,</span> <span class="n">sep</span><span class="p">,</span> <span class="bp">cls</span> <span class="o">=</span> <span class="n">mod_cls</span><span class="o">.</span><span class="n">rpartition</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">parents</span> <span class="o">=</span> <span class="p">[</span><span class="bp">cls</span><span class="p">]</span>
        <span class="c1"># if the module name is still missing, get it like above</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modname</span><span class="p">:</span>
            <span class="n">modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_document</span><span class="o">.</span><span class="n">autodoc_module</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modname</span><span class="p">:</span>
            <span class="n">modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">ref_context</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;py:module&#39;</span><span class="p">)</span>
        <span class="c1"># ... else, it stays None, which means invalid</span>
        <span class="k">return</span> <span class="n">modname</span><span class="p">,</span> <span class="p">[</span><span class="o">*</span><span class="n">parents</span><span class="p">,</span> <span class="n">base</span><span class="p">]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocstringSignatureMixin</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for FunctionDocumenter and MethodDocumenter to provide the</span>
<span class="sd">    feature of reading the signature from the docstring.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_new_docstrings</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_signatures</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># candidates of the object name</span>
        <span class="n">valid_names</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>  <span class="c1"># type: ignore[attr-defined]</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ClassDocumenter</span><span class="p">):</span>
            <span class="n">valid_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;__init__&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__mro__&#39;</span><span class="p">):</span>
                <span class="n">valid_names</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span> <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">)</span>

        <span class="n">docstrings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">docstrings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_new_docstrings</span> <span class="o">=</span> <span class="n">docstrings</span><span class="p">[:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_signatures</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">doclines</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">docstrings</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">doclines</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                    <span class="c1"># no lines in docstring, no match</span>
                    <span class="k">break</span>

                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">):</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">rstrip</span><span class="p">()</span>

                <span class="c1"># match first line of docstring against signature RE</span>
                <span class="n">match</span> <span class="o">=</span> <span class="n">py_ext_sig_re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">match</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">exmod</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">base</span><span class="p">,</span> <span class="n">tp_list</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">retann</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>

                <span class="c1"># the base name must match ours</span>
                <span class="k">if</span> <span class="n">base</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_names</span><span class="p">:</span>
                    <span class="k">break</span>

                <span class="c1"># re-prepare docstring to ignore more leading indentation</span>
                <span class="n">directive</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directive</span>  <span class="c1"># type: ignore[attr-defined]</span>
                <span class="n">tab_width</span> <span class="o">=</span> <span class="n">directive</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tab_width</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_new_docstrings</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">prepare_docstring</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">doclines</span><span class="p">[</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">:]),</span> <span class="n">tab_width</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="c1"># first signature</span>
                    <span class="n">result</span> <span class="o">=</span> <span class="n">args</span><span class="p">,</span> <span class="n">retann</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># subsequent signatures</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_signatures</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s1">) -&gt; </span><span class="si">{</span><span class="n">retann</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># finish the loop when signature found</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_docstrings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_docstrings</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>  <span class="c1"># type: ignore[misc]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_docstring_signature</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
            <span class="c1"># only act if a signature is not explicitly given already, and if</span>
            <span class="c1"># the feature is enabled</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_signature</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">retann</span> <span class="o">=</span> <span class="n">result</span>
        <span class="n">sig</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_signature</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_signatures</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">sig</span><span class="p">,</span> <span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_signatures</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">sig</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DocstringStripSignatureMixin</span><span class="p">(</span><span class="n">DocstringSignatureMixin</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for AttributeDocumenter to provide the</span>
<span class="sd">    feature of stripping any function signature from the docstring.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_docstring_signature</span><span class="p">:</span>  <span class="c1"># type: ignore[attr-defined]</span>
            <span class="c1"># only act if a signature is not explicitly given already, and if</span>
            <span class="c1"># the feature is enabled</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_signature</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Discarding _args is a only difference with</span>
                <span class="c1"># DocstringSignatureMixin.format_signature.</span>
                <span class="c1"># Documenter.format_signature use self.args value to format.</span>
                <span class="n">_args</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">retann</span> <span class="o">=</span> <span class="n">result</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_signature</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">FunctionDocumenter</span><span class="p">(</span><span class="n">DocstringSignatureMixin</span><span class="p">,</span> <span class="n">ModuleLevelDocumenter</span><span class="p">):</span>  <span class="c1"># type: ignore[misc]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for functions.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;function&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">30</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># supports functions, builtins and bound methods exported at the module level</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isbuiltin</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>
            <span class="ow">or</span> <span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">isroutine</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">ModuleDocumenter</span><span class="p">))</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">}:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;show_annotation&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;unqualified_typehints&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;short_literals&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span>
            <span class="p">)</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">stringify_signature</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Failed to get a function signature for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">exc</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">strip_signature_backslash</span><span class="p">:</span>
            <span class="c1"># escape backslashes for reST</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">document_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="n">is_coro</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="n">is_acoro</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isasyncgenfunction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_coro</span> <span class="ow">or</span> <span class="n">is_acoro</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :async:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;unqualified_typehints&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;short_literals&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">sigs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span>
            <span class="ow">and</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">overloads</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span>
        <span class="p">):</span>
            <span class="c1"># Use signatures for overloaded functions instead of the implementation function.</span>
            <span class="n">overloaded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">overloaded</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_signature</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">is_singledispatch_function</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="c1"># append signature of singledispatch&#39;ed functions</span>
            <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">is</span> <span class="nb">object</span><span class="p">:</span>
                    <span class="k">pass</span>  <span class="c1"># default implementation. skipped.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dispatchfunc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_to_first_argument</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">typ</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">dispatchfunc</span><span class="p">:</span>
                        <span class="n">documenter</span> <span class="o">=</span> <span class="n">FunctionDocumenter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                        <span class="n">documenter</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">dispatchfunc</span>
                        <span class="n">documenter</span><span class="o">.</span><span class="n">objpath</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
                        <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">documenter</span><span class="o">.</span><span class="n">format_signature</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">overloaded</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actual</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span>
            <span class="p">)</span>
            <span class="vm">__globals__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__globals__&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="n">overload</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">overloads</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)]:</span>
                <span class="n">overload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_default_value</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">overload</span><span class="p">)</span>
                <span class="n">overload</span> <span class="o">=</span> <span class="n">evaluate_signature</span><span class="p">(</span>
                    <span class="n">overload</span><span class="p">,</span> <span class="vm">__globals__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span>
                <span class="p">)</span>

                <span class="n">sig</span> <span class="o">=</span> <span class="n">stringify_signature</span><span class="p">(</span><span class="n">overload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sigs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">merge_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actual</span><span class="p">:</span> <span class="n">Signature</span><span class="p">,</span> <span class="n">overload</span><span class="p">:</span> <span class="n">Signature</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signature</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge default values of actual implementation to the overload variants.&quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">overload</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
            <span class="n">actual_param</span> <span class="o">=</span> <span class="n">actual</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">actual_param</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="o">==</span> <span class="s1">&#39;...&#39;</span><span class="p">:</span>
                <span class="n">parameters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">actual_param</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">overload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">annotate_to_first_argument</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">typ</span><span class="p">:</span> <span class="nb">type</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Annotate type hint to the first argument of function if needed.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Failed to get a function signature for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">exc</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">dummy</span><span class="p">():</span>  <span class="c1"># type: ignore[no-untyped-def]  # NoQA: ANN202</span>
            <span class="k">pass</span>

        <span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span> <span class="ow">is</span> <span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">typ</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dummy</span><span class="o">.</span><span class="n">__signature__</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>  <span class="c1"># type: ignore[attr-defined]</span>
                <span class="k">return</span> <span class="n">dummy</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="c1"># failed to update signature (ex. built-in or extension types)</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">func</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DecoratorDocumenter</span><span class="p">(</span><span class="n">FunctionDocumenter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for decorator functions.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;decorator&#39;</span>

    <span class="c1"># must be lower than FunctionDocumenter</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">args</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_args</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;,&#39;</span> <span class="ow">in</span> <span class="n">args</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">args</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>


<span class="c1"># Types which have confusing metaclass signatures it would be best not to show.</span>
<span class="c1"># These are listed by name, rather than storing the objects themselves, to avoid</span>
<span class="c1"># needing to import the modules.</span>
<span class="n">_METACLASS_CALL_BLACKLIST</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
    <span class="s1">&#39;enum.EnumType.__call__&#39;</span><span class="p">,</span>
<span class="p">})</span>


<span class="c1"># Types whose __new__ signature is a pass-through.</span>
<span class="n">_CLASS_NEW_BLACKLIST</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">({</span>
    <span class="s1">&#39;typing.Generic.__new__&#39;</span><span class="p">,</span>
<span class="p">})</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ClassDocumenter</span><span class="p">(</span><span class="n">DocstringSignatureMixin</span><span class="p">,</span> <span class="n">ModuleLevelDocumenter</span><span class="p">):</span>  <span class="c1"># type: ignore[misc]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for classes.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;class&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">option_spec</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">OptionSpec</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;members&#39;</span><span class="p">:</span> <span class="n">members_option</span><span class="p">,</span>
        <span class="s1">&#39;undoc-members&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;no-index&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;no-index-entry&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;inherited-members&#39;</span><span class="p">:</span> <span class="n">inherited_members_option</span><span class="p">,</span>
        <span class="s1">&#39;show-inheritance&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
        <span class="s1">&#39;member-order&#39;</span><span class="p">:</span> <span class="n">member_order_option</span><span class="p">,</span>
        <span class="s1">&#39;exclude-members&#39;</span><span class="p">:</span> <span class="n">exclude_members_option</span><span class="p">,</span>
        <span class="s1">&#39;private-members&#39;</span><span class="p">:</span> <span class="n">members_option</span><span class="p">,</span>
        <span class="s1">&#39;special-members&#39;</span><span class="p">:</span> <span class="n">members_option</span><span class="p">,</span>
        <span class="s1">&#39;class-doc-from&#39;</span><span class="p">:</span> <span class="n">class_doc_from_option</span><span class="p">,</span>
        <span class="s1">&#39;noindex&#39;</span><span class="p">:</span> <span class="n">bool_option</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="c1"># Must be higher than FunctionDocumenter, ClassDocumenter, and</span>
    <span class="c1"># AttributeDocumenter as NewType can be an attribute and is a class</span>
    <span class="c1"># after Python 3.10.</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">15</span>

    <span class="n">_signature_class</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">_signature_method_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_class_signature</span> <span class="o">==</span> <span class="s1">&#39;separated&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="c1"># show __init__() method</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">special_members</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;special-members&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;__new__&#39;</span><span class="p">,</span> <span class="s1">&#39;__init__&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">special_members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;__new__&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">special_members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;__init__&#39;</span><span class="p">)</span>

        <span class="n">merge_members_option</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">isattr</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">NewType</span> <span class="o">|</span> <span class="n">TypeVar</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>
        <span class="c1"># if the class is documented under another name, document it</span>
        <span class="c1"># as data/attribute</span>
        <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__name__</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">NewType</span> <span class="o">|</span> <span class="n">TypeVar</span><span class="p">):</span>
                <span class="n">modname</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">modname</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">modname</span><span class="p">):</span>
                    <span class="n">bases</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">modname</span><span class="p">)</span> <span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span> <span class="o">=</span> <span class="n">bases</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">modname</span> <span class="o">=</span> <span class="n">modname</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Any</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Signature</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">NewType</span> <span class="o">|</span> <span class="n">TypeVar</span><span class="p">):</span>
            <span class="c1"># Suppress signature</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">get_user_defined_function_or_method</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">attr</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;Get the `attr` function or method from `obj`, if it is user-defined.&quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">is_builtin_class_method</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">attr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">ismethod</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span> <span class="ow">or</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">attr</span><span class="p">)):</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">return</span> <span class="n">attr</span>

        <span class="c1"># This sequence is copied from inspect._signature_from_callable.</span>
        <span class="c1"># ValueError means that no signature could be found, so we keep going.</span>

        <span class="c1"># First, we check if obj has a __signature__ attribute</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__signature__&#39;</span><span class="p">):</span>
            <span class="n">object_sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__signature__</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_sig</span><span class="p">,</span> <span class="n">Signature</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">object_sig</span>
            <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">)}</span> <span class="ow">and</span> <span class="nb">callable</span><span class="p">(</span><span class="n">object_sig</span><span class="p">):</span>
                <span class="c1"># Support for enum.Enum.__signature__ in Python 3.12</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">object_sig_str</span> <span class="o">:=</span> <span class="n">object_sig</span><span class="p">(),</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature_from_str</span><span class="p">(</span><span class="n">object_sig_str</span><span class="p">)</span>

        <span class="c1"># Next, let&#39;s see if it has an overloaded __call__ defined</span>
        <span class="c1"># in its metaclass</span>
        <span class="n">call</span> <span class="o">=</span> <span class="n">get_user_defined_function_or_method</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">),</span> <span class="s1">&#39;__call__&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">call</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">call</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">call</span><span class="o">.</span><span class="vm">__qualname__</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">_METACLASS_CALL_BLACKLIST</span><span class="p">:</span>
                <span class="n">call</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">call</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="n">call</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                    <span class="n">call</span><span class="p">,</span>
                    <span class="n">bound_method</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">),</span> <span class="s1">&#39;__call__&#39;</span><span class="p">,</span> <span class="n">sig</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Now we check if the &#39;obj&#39; class has a &#39;__new__&#39; method</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">get_user_defined_function_or_method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__new__&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">new</span><span class="o">.</span><span class="vm">__module__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">new</span><span class="o">.</span><span class="vm">__qualname__</span><span class="si">}</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">_CLASS_NEW_BLACKLIST</span><span class="p">:</span>
                <span class="n">new</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">new</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="n">new</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                    <span class="n">new</span><span class="p">,</span>
                    <span class="n">bound_method</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__new__&#39;</span><span class="p">,</span> <span class="n">sig</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># Finally, we should have at least __init__ implemented</span>
        <span class="n">init</span> <span class="o">=</span> <span class="n">get_user_defined_function_or_method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__init__&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">init</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="n">init</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                    <span class="n">init</span><span class="p">,</span>
                    <span class="n">bound_method</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__init__&#39;</span><span class="p">,</span> <span class="n">sig</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="c1"># None of the attributes are user-defined, so fall back to let inspect</span>
        <span class="c1"># handle it.</span>
        <span class="c1"># We don&#39;t know the exact method that inspect.signature will read</span>
        <span class="c1"># the signature from, so just pass the object itself to our hook.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                <span class="n">bound_method</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">sig</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Still no signature: happens e.g. for old-style classes</span>
        <span class="c1"># with __init__ in C and no `__text_signature__`.</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">}:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;show_annotation&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;unqualified_typehints&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;short_literals&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_signature_class</span><span class="p">,</span> <span class="n">_signature_method_name</span><span class="p">,</span> <span class="n">sig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_signature</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># __signature__ attribute contained junk</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Failed to get a constructor signature for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
                <span class="n">exc</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_signature_method_name</span> <span class="o">=</span> <span class="n">_signature_method_name</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="n">sig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">return</span> <span class="n">stringify_signature</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="n">show_return_annotation</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_find_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_find_signature</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Strip a return value from signature of constructor in docstring (first entry)</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_signatures</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">sig</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39; -&gt; None&#39;</span><span class="p">):</span>
                <span class="c1"># Strip a return value from signatures of constructor in docstring (subsequent</span>
                <span class="c1"># entries)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_signatures</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[:</span><span class="o">-</span><span class="mi">8</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">result</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_class_signature</span> <span class="o">==</span> <span class="s1">&#39;separated&#39;</span><span class="p">:</span>
            <span class="c1"># do not show signatures</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;unqualified_typehints&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;short_literals&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">sig</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_signature</span><span class="p">()</span>
        <span class="n">sigs</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">overloads</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_overloaded_signatures</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">overloads</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="c1"># Use signatures for overloaded methods instead of the implementation method.</span>
            <span class="n">method</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_signature_class</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_signature_method_name</span><span class="p">,</span> <span class="kc">None</span>
            <span class="p">)</span>
            <span class="vm">__globals__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="s1">&#39;__globals__&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="n">overload</span> <span class="ow">in</span> <span class="n">overloads</span><span class="p">:</span>
                <span class="n">overload</span> <span class="o">=</span> <span class="n">evaluate_signature</span><span class="p">(</span>
                    <span class="n">overload</span><span class="p">,</span> <span class="vm">__globals__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span>
                <span class="p">)</span>

                <span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">overload</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                <span class="n">overload</span> <span class="o">=</span> <span class="n">overload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">return_annotation</span><span class="o">=</span><span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span>
                <span class="p">)</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="n">stringify_signature</span><span class="p">(</span><span class="n">overload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sigs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_overloaded_signatures</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Signature</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_signature_class</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_signature_method_name</span><span class="p">:</span>
            <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_signature_class</span><span class="o">.</span><span class="vm">__mro__</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__module__</span><span class="p">)</span>
                    <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
                    <span class="n">qualname</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__qualname__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_signature_method_name</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">qualname</span> <span class="ow">in</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">overloads</span><span class="p">:</span>
                        <span class="k">return</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">overloads</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">qualname</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="k">elif</span> <span class="n">qualname</span> <span class="ow">in</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">tagorder</span><span class="p">:</span>
                        <span class="c1"># the constructor is defined in the class, but not overridden.</span>
                        <span class="k">return</span> <span class="p">[]</span>
                <span class="k">except</span> <span class="n">PycodeError</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_canonical_fullname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">__modname__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">)</span>
        <span class="vm">__qualname__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__qualname__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="vm">__qualname__</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="vm">__qualname__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__name__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="vm">__qualname__</span> <span class="ow">and</span> <span class="s1">&#39;&lt;locals&gt;&#39;</span> <span class="ow">in</span> <span class="vm">__qualname__</span><span class="p">:</span>
            <span class="c1"># No valid qualname found if the object is defined as locals</span>
            <span class="vm">__qualname__</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">__modname__</span> <span class="ow">and</span> <span class="vm">__qualname__</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">__modname__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="vm">__qualname__</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">directivetype</span> <span class="o">=</span> <span class="s1">&#39;attribute&#39;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">NewType</span> <span class="o">|</span> <span class="n">TypeVar</span><span class="p">):</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="ow">and</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">finals</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :final:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

        <span class="n">canonical_fullname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_canonical_fullname</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span>
            <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">NewType</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">canonical_fullname</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span> <span class="o">!=</span> <span class="n">canonical_fullname</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :canonical: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">canonical_fullname</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

        <span class="c1"># add inheritance info, if wanted</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">show_inheritance</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getorigbases</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
                <span class="c1"># A subclass of generic types</span>
                <span class="c1"># refs: PEP-560 &lt;https://peps.python.org/pep-0560/&gt;</span>
                <span class="n">bases</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__orig_bases__</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__bases__&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">):</span>
                <span class="c1"># A normal class</span>
                <span class="n">bases</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__bases__</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bases</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                <span class="s1">&#39;autodoc-process-bases&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="n">bases</span>
            <span class="p">)</span>

            <span class="n">mode</span> <span class="o">=</span> <span class="n">_get_render_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span><span class="p">)</span>
            <span class="n">base_classes</span> <span class="o">=</span> <span class="p">[</span><span class="n">restify</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span> <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">bases</span><span class="p">]</span>

            <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   &#39;</span> <span class="o">+</span> <span class="n">_</span><span class="p">(</span><span class="s1">&#39;Bases: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">base_classes</span><span class="p">),</span> <span class="n">sourcename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_object_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">want_all</span><span class="p">:</span> <span class="nb">bool</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">ObjectMember</span><span class="p">]]:</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">get_class_members</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">want_all</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">[]</span>
            <span class="c1"># specific members given</span>
            <span class="n">selected</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">members</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">members</span><span class="p">:</span>
                    <span class="n">selected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">members</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                        <span class="n">__</span><span class="p">(</span><span class="s1">&#39;missing attribute </span><span class="si">%s</span><span class="s1"> in object </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span>
                        <span class="n">name</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span>
                        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="n">selected</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">inherited_members</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">members</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span><span class="p">,</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">members</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">class_</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">==</span> <span class="n">TypeVar</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span><span class="p">:</span>
            <span class="c1"># Don&#39;t show the docstring of the class when it is an alias.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable_comment</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="n">lines</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_new_docstrings&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lines</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lines</span>

        <span class="n">classdoc_from</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s1">&#39;class-doc-from&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autoclass_content</span>
        <span class="p">)</span>

        <span class="n">docstrings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">attrdocstring</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">attrdocstring</span><span class="p">:</span>
            <span class="n">docstrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">attrdocstring</span><span class="p">)</span>

        <span class="c1"># for classes, what the &quot;docstring&quot; is can be controlled via a</span>
        <span class="c1"># config value; the default is only the class docstring</span>
        <span class="k">if</span> <span class="n">classdoc_from</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">}:</span>
            <span class="fm">__init__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__init__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">initdocstring</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span>
                <span class="fm">__init__</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                <span class="s1">&#39;__init__&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># for new-style classes, no __init__ means default __init__</span>
            <span class="k">if</span> <span class="n">initdocstring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">initdocstring</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for pypy</span>
                <span class="ow">or</span> <span class="n">initdocstring</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for !pypy</span>
            <span class="p">):</span>
                <span class="n">initdocstring</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">initdocstring</span><span class="p">:</span>
                <span class="c1"># try __new__</span>
                <span class="fm">__new__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__new__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                <span class="n">initdocstring</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span>
                    <span class="fm">__new__</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                    <span class="s1">&#39;__new__&#39;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="c1"># for new-style classes, no __new__ means default __new__</span>
                <span class="k">if</span> <span class="n">initdocstring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">initdocstring</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for pypy</span>
                    <span class="ow">or</span> <span class="n">initdocstring</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for !pypy</span>
                <span class="p">):</span>
                    <span class="n">initdocstring</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">initdocstring</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">classdoc_from</span> <span class="o">==</span> <span class="s1">&#39;init&#39;</span><span class="p">:</span>
                    <span class="n">docstrings</span> <span class="o">=</span> <span class="p">[</span><span class="n">initdocstring</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">docstrings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">initdocstring</span><span class="p">)</span>

        <span class="n">tab_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tab_width</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">prepare_docstring</span><span class="p">(</span><span class="n">docstring</span><span class="p">,</span> <span class="n">tab_width</span><span class="p">)</span> <span class="k">for</span> <span class="n">docstring</span> <span class="ow">in</span> <span class="n">docstrings</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_variable_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span><span class="p">:</span>
                <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_real_modname</span><span class="p">())</span>
            <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
            <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">attr_docs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[]))</span>
        <span class="k">except</span> <span class="n">PycodeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mode</span> <span class="o">=</span> <span class="n">_get_render_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span><span class="p">)</span>
        <span class="n">short_literals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">NewType</span><span class="p">):</span>
            <span class="n">supertype</span> <span class="o">=</span> <span class="n">restify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__supertype__</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>

            <span class="n">more_content</span> <span class="o">=</span> <span class="n">StringList</span><span class="p">([</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;alias of </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">supertype</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">TypeVar</span><span class="p">):</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="p">[</span><span class="nb">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)]</span>
            <span class="n">attrs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="n">stringify_annotation</span><span class="p">(</span><span class="n">constraint</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">short_literals</span><span class="o">=</span><span class="n">short_literals</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">constraint</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__constraints__</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__bound__</span><span class="p">:</span>
                <span class="n">bound</span> <span class="o">=</span> <span class="n">restify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__bound__</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;bound=\ &#39;</span> <span class="o">+</span> <span class="n">bound</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__covariant__</span><span class="p">:</span>
                <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;covariant=True&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">__contravariant__</span><span class="p">:</span>
                <span class="n">attrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;contravariant=True&#39;</span><span class="p">)</span>

            <span class="n">more_content</span> <span class="o">=</span> <span class="n">StringList</span><span class="p">(</span>
                <span class="p">[</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;alias of TypeVar(</span><span class="si">%s</span><span class="s1">)&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">attrs</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_real_modname</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># override analyzer to obtain doccomment around its definition.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">PycodeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_variable_comment</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">alias</span> <span class="o">=</span> <span class="n">restify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
                <span class="n">more_content</span> <span class="o">=</span> <span class="n">StringList</span><span class="p">([</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;alias of </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">alias</span><span class="p">],</span> <span class="n">source</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># Invalid class object is passed.</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_content</span><span class="p">(</span><span class="n">more_content</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">document_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">doc_as_attr</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">document_members</span><span class="p">(</span><span class="n">all_members</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">real_modname</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">check_module</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Do not pass real_modname and use the name from the __module__</span>
        <span class="c1"># attribute of the class.</span>
        <span class="c1"># If a class gets imported into the module real_modname</span>
        <span class="c1"># the analyzer won&#39;t find the source of the class, if</span>
        <span class="c1"># it looks in real_modname.</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span>
            <span class="n">more_content</span><span class="o">=</span><span class="n">more_content</span><span class="p">,</span>
            <span class="n">check_module</span><span class="o">=</span><span class="n">check_module</span><span class="p">,</span>
            <span class="n">all_members</span><span class="o">=</span><span class="n">all_members</span><span class="p">,</span>
        <span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ExceptionDocumenter</span><span class="p">(</span><span class="n">ClassDocumenter</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized ClassDocumenter subclass for exceptions.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;exception&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="c1"># needs a higher priority than ClassDocumenter</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="n">ClassDocumenter</span><span class="o">.</span><span class="n">priority</span> <span class="o">+</span> <span class="mi">5</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">issubclass</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="ne">BaseException</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># It&#39;s possible for a member to be considered a type, but fail</span>
            <span class="c1"># issubclass checks due to not being a class. For example:</span>
            <span class="c1"># https://github.com/sphinx-doc/sphinx/issues/11654#issuecomment-1696790436</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> failed to discern if member </span><span class="si">{</span><span class="n">member</span><span class="si">}</span><span class="s1"> with&#39;</span>
                <span class="sa">f</span><span class="s1">&#39; membername </span><span class="si">{</span><span class="n">membername</span><span class="si">}</span><span class="s1"> is a BaseException subclass.&#39;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span> <span class="kn">from</span><span class="w"> </span><span class="nn">exc</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DataDocumenterMixinBase</span><span class="p">:</span>
    <span class="c1"># define types of instance variables</span>
    <span class="n">config</span><span class="p">:</span> <span class="n">Config</span>
    <span class="n">env</span><span class="p">:</span> <span class="n">BuildEnvironment</span>
    <span class="n">modname</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="nb">object</span><span class="p">:</span> <span class="n">Any</span>
    <span class="n">objpath</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check directive header should be suppressed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check :value: header should be suppressed.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update docstring, for example with TypeVar variance.&quot;&quot;&quot;</span>
        <span class="k">pass</span>


<span class="k">class</span><span class="w"> </span><span class="nc">GenericAliasMixin</span><span class="p">(</span><span class="n">DataDocumenterMixinBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for DataDocumenter and AttributeDocumenter to provide the feature for</span>
<span class="sd">    supporting GenericAliases.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">inspect</span><span class="o">.</span><span class="n">isgenericalias</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_directive_header</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isgenericalias</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="n">_get_render_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span><span class="p">)</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">restify</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>

            <span class="n">more_content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_</span><span class="p">(</span><span class="s1">&#39;alias of </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">alias</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">more_content</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">update_content</span><span class="p">(</span><span class="n">more_content</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">UninitializedGlobalVariableMixin</span><span class="p">(</span><span class="n">DataDocumenterMixinBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for DataDocumenter to provide the feature for supporting uninitialized</span>
<span class="sd">    (type annotation only) global variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="c1"># annotation only instance variable (PEP-526)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">mock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_mock_imports</span><span class="p">):</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">import_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">)</span>
                    <span class="n">annotations</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span>
                        <span class="n">parent</span><span class="p">,</span>
                        <span class="kc">None</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                        <span class="n">include_extras</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">UNINITIALIZED_ATTR</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
                        <span class="k">return</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">raiseerror</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;import_object&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">note_reread</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="n">UNINITIALIZED_ATTR</span> <span class="ow">or</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="n">UNINITIALIZED_ATTR</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>  <span class="c1"># type: ignore[misc]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">DataDocumenter</span><span class="p">(</span>
    <span class="n">GenericAliasMixin</span><span class="p">,</span> <span class="n">UninitializedGlobalVariableMixin</span><span class="p">,</span> <span class="n">ModuleLevelDocumenter</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for data items.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">40</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
    <span class="n">option_spec</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">OptionSpec</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ModuleLevelDocumenter</span><span class="o">.</span><span class="n">option_spec</span><span class="p">)</span>
    <span class="n">option_spec</span><span class="p">[</span><span class="s1">&#39;annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation_option</span>
    <span class="n">option_spec</span><span class="p">[</span><span class="s1">&#39;no-value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bool_option</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">ModuleDocumenter</span><span class="p">)</span> <span class="ow">and</span> <span class="n">isattr</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update __annotations__ to support type_comment and so on.&quot;&quot;&quot;</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getannotations</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
        <span class="n">parent</span><span class="o">.</span><span class="vm">__annotations__</span> <span class="o">=</span> <span class="n">annotations</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">)</span>
            <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
            <span class="k">for</span> <span class="p">(</span><span class="n">classname</span><span class="p">,</span> <span class="n">attrname</span><span class="p">),</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">annotations</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">classname</span> <span class="ow">and</span> <span class="n">attrname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
                    <span class="n">annotations</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>
        <span class="k">except</span> <span class="n">PycodeError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_annotations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span> <span class="ow">or</span> <span class="p">[]</span>
            <span class="n">docstring</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">separate_metadata</span><span class="p">(</span>
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">iadd</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="p">[]))</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;hide-value&#39;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">annotation</span> <span class="ow">is</span> <span class="n">SUPPRESS</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_suppress_directive_header</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :annotation: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
                <span class="c1"># obtain annotation for this data</span>
                <span class="n">annotations</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                    <span class="kc">None</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                    <span class="n">include_extras</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
                    <span class="n">mode</span> <span class="o">=</span> <span class="n">_get_render_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span><span class="p">)</span>
                    <span class="n">short_literals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span>
                    <span class="n">objrepr</span> <span class="o">=</span> <span class="n">stringify_annotation</span><span class="p">(</span>
                        <span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="n">mode</span><span class="p">,</span>
                        <span class="n">short_literals</span><span class="o">=</span><span class="n">short_literals</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :type: &#39;</span> <span class="o">+</span> <span class="n">objrepr</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">no_value</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">()</span>
                    <span class="ow">or</span> <span class="n">ismock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objrepr</span> <span class="o">=</span> <span class="n">object_description</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :value: &#39;</span> <span class="o">+</span> <span class="n">objrepr</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">document_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_real_modname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">real_modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">real_modname</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_module_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attrname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">)</span>
            <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
            <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">attrname</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">attr_docs</span><span class="p">:</span>
                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">attr_docs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
        <span class="k">except</span> <span class="n">PycodeError</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Check the variable has a docstring-comment</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_module_comment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">comment</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Disable analyzing variable comment on Documenter.add_content() to control it on</span>
        <span class="c1"># DataDocumenter.add_content()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">more_content</span><span class="p">:</span>
            <span class="n">more_content</span> <span class="o">=</span> <span class="n">StringList</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_content</span><span class="p">(</span><span class="n">more_content</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_content</span><span class="p">(</span><span class="n">more_content</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">MethodDocumenter</span><span class="p">(</span><span class="n">DocstringSignatureMixin</span><span class="p">,</span> <span class="n">ClassLevelDocumenter</span><span class="p">):</span>  <span class="c1"># type: ignore[misc]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for methods (normal, static and class).&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;method&#39;</span>
    <span class="n">directivetype</span> <span class="o">=</span> <span class="s1">&#39;method&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># must be more than FunctionDocumenter</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isroutine</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">ModuleDocumenter</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ret</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ret</span>

        <span class="c1"># to distinguish classmethod/staticmethod</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isstaticmethod</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">):</span>
            <span class="c1"># document static members before regular methods</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">member_order</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclassmethod</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="c1"># document class methods before static methods as</span>
            <span class="c1"># they usually behave as alternative constructors</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">member_order</span> <span class="o">-=</span> <span class="mi">2</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">}:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;show_annotation&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;unqualified_typehints&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;short_literals&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__init__</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">!=</span> <span class="nb">object</span><span class="p">:</span>  <span class="c1"># NoQA: E721</span>
                <span class="c1"># Classes not having own __init__() method are shown as no arguments.</span>
                <span class="c1">#</span>
                <span class="c1"># Note: The signature of object.__init__() is (self, /, *args, **kwargs).</span>
                <span class="c1">#       But it makes users confused.</span>
                <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;()&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isstaticmethod</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span>
                <span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="kc">False</span>
                    <span class="p">)</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                        <span class="n">bound_method</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                        <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span>
                        <span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="kc">True</span>
                    <span class="p">)</span>
                    <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                        <span class="n">bound_method</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="n">args</span> <span class="o">=</span> <span class="n">stringify_signature</span><span class="p">(</span><span class="n">sig</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Failed to get a method signature for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">exc</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">strip_signature_backslash</span><span class="p">:</span>
            <span class="c1"># escape backslashes for reST</span>
            <span class="n">args</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\\\</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">args</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isabstractmethod</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :abstractmethod:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">iscoroutinefunction</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">or</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isasyncgenfunction</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :async:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">inspect</span><span class="o">.</span><span class="n">is_classmethod_like</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="ow">or</span> <span class="n">inspect</span><span class="o">.</span><span class="n">is_singledispatch_method</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">is_classmethod_like</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">func</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :classmethod:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isstaticmethod</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :staticmethod:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="ow">and</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">finals</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :final:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">document_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_signature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span> <span class="o">==</span> <span class="s1">&#39;short&#39;</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;unqualified_typehints&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;short_literals&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">sigs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span>
            <span class="ow">and</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">overloads</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span>
        <span class="p">):</span>
            <span class="c1"># Use signatures for overloaded methods instead of the implementation method.</span>
            <span class="n">overloaded</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">overloaded</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_signature</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="n">meth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">is_singledispatch_method</span><span class="p">(</span><span class="n">meth</span><span class="p">):</span>
            <span class="c1"># append signature of singledispatch&#39;ed functions</span>
            <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">meth</span><span class="o">.</span><span class="n">dispatcher</span><span class="o">.</span><span class="n">registry</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">typ</span> <span class="ow">is</span> <span class="nb">object</span><span class="p">:</span>
                    <span class="k">pass</span>  <span class="c1"># default implementation. skipped.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclassmethod</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
                        <span class="n">func</span> <span class="o">=</span> <span class="n">func</span><span class="o">.</span><span class="vm">__func__</span>
                    <span class="n">dispatchmeth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">annotate_to_first_argument</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">typ</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">dispatchmeth</span><span class="p">:</span>
                        <span class="n">documenter</span> <span class="o">=</span> <span class="n">MethodDocumenter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                        <span class="n">documenter</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
                        <span class="n">documenter</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">dispatchmeth</span>
                        <span class="n">documenter</span><span class="o">.</span><span class="n">objpath</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
                        <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">documenter</span><span class="o">.</span><span class="n">format_signature</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">overloaded</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isstaticmethod</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span>
            <span class="p">):</span>
                <span class="n">actual</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                    <span class="n">bound_method</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">actual</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                    <span class="n">bound_method</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="vm">__globals__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__globals__&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="k">for</span> <span class="n">overload</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span><span class="o">.</span><span class="n">overloads</span><span class="p">[</span><span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">)]:</span>
                <span class="n">overload</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">merge_default_value</span><span class="p">(</span><span class="n">actual</span><span class="p">,</span> <span class="n">overload</span><span class="p">)</span>
                <span class="n">overload</span> <span class="o">=</span> <span class="n">evaluate_signature</span><span class="p">(</span>
                    <span class="n">overload</span><span class="p">,</span> <span class="vm">__globals__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isstaticmethod</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="bp">cls</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">object_name</span>
                <span class="p">):</span>
                    <span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">overload</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
                    <span class="n">overload</span> <span class="o">=</span> <span class="n">overload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
                <span class="n">sig</span> <span class="o">=</span> <span class="n">stringify_signature</span><span class="p">(</span><span class="n">overload</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">sigs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>

        <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sigs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">merge_default_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actual</span><span class="p">:</span> <span class="n">Signature</span><span class="p">,</span> <span class="n">overload</span><span class="p">:</span> <span class="n">Signature</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Signature</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Merge default values of actual implementation to the overload variants.&quot;&quot;&quot;</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">overload</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">param</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">parameters</span><span class="p">):</span>
            <span class="n">actual_param</span> <span class="o">=</span> <span class="n">actual</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">actual_param</span> <span class="ow">and</span> <span class="n">param</span><span class="o">.</span><span class="n">default</span> <span class="o">==</span> <span class="s1">&#39;...&#39;</span><span class="p">:</span>
                <span class="n">parameters</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">param</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="n">actual_param</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">overload</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">annotate_to_first_argument</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">typ</span><span class="p">:</span> <span class="nb">type</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Annotate type hint to the first argument of function if needed.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">sig</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Failed to get a method signature for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">exc</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">dummy</span><span class="p">():</span>  <span class="c1"># type: ignore[no-untyped-def]  # NoQA: ANN202</span>
            <span class="k">pass</span>

        <span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sig</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">annotation</span> <span class="ow">is</span> <span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
            <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">annotation</span><span class="o">=</span><span class="n">typ</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dummy</span><span class="o">.</span><span class="n">__signature__</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>  <span class="c1"># type: ignore[attr-defined]</span>
                    <span class="n">parameters</span><span class="o">=</span><span class="n">params</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="n">dummy</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                <span class="c1"># failed to update signature (ex. built-in or extension types)</span>
                <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">func</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_docstrings</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># docstring already returned previously, then modified by</span>
            <span class="c1"># `DocstringSignatureMixin`.  Just return the previously-computed</span>
            <span class="c1"># result, so that we don&#39;t lose the processing done by</span>
            <span class="c1"># `DocstringSignatureMixin`.</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_new_docstrings</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;__init__&#39;</span><span class="p">:</span>
            <span class="n">docstring</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">docstring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">docstring</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for pypy</span>
                <span class="ow">or</span> <span class="n">docstring</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__init__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for !pypy</span>
            <span class="p">):</span>
                <span class="n">docstring</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">docstring</span><span class="p">:</span>
                <span class="n">tab_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tab_width</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">prepare_docstring</span><span class="p">(</span><span class="n">docstring</span><span class="p">,</span> <span class="n">tabsize</span><span class="o">=</span><span class="n">tab_width</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;__new__&#39;</span><span class="p">:</span>
            <span class="n">docstring</span> <span class="o">=</span> <span class="n">getdoc</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object_name</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">docstring</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span>
                <span class="n">docstring</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for pypy</span>
                <span class="ow">or</span> <span class="n">docstring</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="o">==</span> <span class="nb">object</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__doc__</span>  <span class="c1"># for !pypy</span>
            <span class="p">):</span>
                <span class="n">docstring</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">if</span> <span class="n">docstring</span><span class="p">:</span>
                <span class="n">tab_width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">directive</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">document</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tab_width</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">prepare_docstring</span><span class="p">(</span><span class="n">docstring</span><span class="p">,</span> <span class="n">tabsize</span><span class="o">=</span><span class="n">tab_width</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>


<span class="k">class</span><span class="w"> </span><span class="nc">NonDataDescriptorMixin</span><span class="p">(</span><span class="n">DataDocumenterMixinBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for AttributeDocumenter to provide the feature for supporting non</span>
<span class="sd">    data-descriptors.</span>

<span class="sd">    .. note:: This mix-in must be inherited after other mix-ins.  Otherwise, docstring</span>
<span class="sd">              and :value: header will be suppressed unexpectedly.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
        <span class="k">if</span> <span class="n">ret</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isattributedescriptor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">non_data_descriptor</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">non_data_descriptor</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="ow">not</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;non_data_descriptor&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_directive_header</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;non_data_descriptor&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="c1"># the docstring of non datadescriptor is very probably the wrong thing</span>
            <span class="c1"># to display</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>  <span class="c1"># type: ignore[misc]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">SlotsMixin</span><span class="p">(</span><span class="n">DataDocumenterMixinBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for AttributeDocumenter to provide the feature for supporting __slots__.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">isslotsattribute</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the subject is an attribute in __slots__.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">parent___slots__</span> <span class="o">:=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getslots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">parent___slots__</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isslotsattribute</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">SLOTSATTR</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="n">SLOTSATTR</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="n">SLOTSATTR</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">parent___slots__</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getslots</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">parent___slots__</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="n">docstring</span> <span class="o">:=</span> <span class="n">parent___slots__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="p">):</span>
                    <span class="n">docstring</span> <span class="o">=</span> <span class="n">prepare_docstring</span><span class="p">(</span><span class="n">docstring</span><span class="p">)</span>
                    <span class="k">return</span> <span class="p">[</span><span class="n">docstring</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[]</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                    <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Invalid __slots__ found on </span><span class="si">%s</span><span class="s1">. Ignored.&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="vm">__qualname__</span><span class="p">,</span> <span class="n">exc</span><span class="p">),</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>  <span class="c1"># type: ignore[misc]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">RuntimeInstanceAttributeMixin</span><span class="p">(</span><span class="n">DataDocumenterMixinBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for AttributeDocumenter to provide the feature for supporting runtime</span>
<span class="sd">    instance attributes (that are defined in __init__() methods with doc-comments).</span>

<span class="sd">    Example::</span>

<span class="sd">        class Foo:</span>
<span class="sd">            def __init__(self):</span>
<span class="sd">                self.attr = None  #: This is a target of this mix-in.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RUNTIME_INSTANCE_ATTRIBUTE</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_runtime_instance_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the subject is an attribute defined in __init__().&quot;&quot;&quot;</span>
        <span class="c1"># An instance variable defined in __init__().</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_comment</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># type: ignore[attr-defined]</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_runtime_instance_attribute_not_commented</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_runtime_instance_attribute_not_commented</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the subject is an attribute defined in __init__() without comment.&quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmro</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">)</span>
                <span class="n">qualname</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__qualname__&#39;</span><span class="p">)</span>

                <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">qualname</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">qualname</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">tagorder</span><span class="p">:</span>
                        <span class="k">return</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">PycodeError</span><span class="p">):</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the existence of runtime instance attribute after failing to import the</span>
<span class="sd">        attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">with</span> <span class="n">mock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_mock_imports</span><span class="p">):</span>
                    <span class="n">ret</span> <span class="o">=</span> <span class="n">import_object</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                        <span class="s1">&#39;class&#39;</span><span class="p">,</span>
                        <span class="n">attrgetter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>  <span class="c1"># type: ignore[attr-defined]</span>
                    <span class="p">)</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_runtime_instance_attribute</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">RUNTIME_INSTANCE_ATTRIBUTE</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
                        <span class="k">return</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">raiseerror</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;import_object&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">note_reread</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">RUNTIME_INSTANCE_ATTRIBUTE</span>
            <span class="ow">or</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="bp">self</span><span class="o">.</span><span class="n">RUNTIME_INSTANCE_ATTRIBUTE</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_runtime_instance_attribute_not_commented</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>  <span class="c1"># type: ignore[misc]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">UninitializedInstanceAttributeMixin</span><span class="p">(</span><span class="n">DataDocumenterMixinBase</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mixin for AttributeDocumenter to provide the feature for supporting uninitialized</span>
<span class="sd">    instance attributes (PEP-526 styled, annotation only attributes).</span>

<span class="sd">    Example::</span>

<span class="sd">        class Foo:</span>
<span class="sd">            attr: int  #: This is a target of this mix-in.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_uninitialized_instance_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the subject is an annotation only attribute.&quot;&quot;&quot;</span>
        <span class="n">annotations</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span>
            <span class="n">parent</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span> <span class="n">include_extras</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">annotations</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the existence of uninitialized instance attribute when failed to import</span>
<span class="sd">        the attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># type: ignore[misc]</span>
        <span class="k">except</span> <span class="ne">ImportError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ret</span> <span class="o">=</span> <span class="n">import_object</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">modname</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="s1">&#39;class&#39;</span><span class="p">,</span>
                    <span class="n">attrgetter</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">,</span>  <span class="c1"># type: ignore[attr-defined]</span>
                <span class="p">)</span>
                <span class="n">parent</span> <span class="o">=</span> <span class="n">ret</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_uninitialized_instance_attribute</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">UNINITIALIZED_ATTR</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
                    <span class="k">return</span> <span class="kc">True</span>
            <span class="k">except</span> <span class="ne">ImportError</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">if</span> <span class="n">raiseerror</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="n">exc</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;autodoc&#39;</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="s1">&#39;import_object&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">note_reread</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="n">UNINITIALIZED_ATTR</span> <span class="ow">or</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">()</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="ow">is</span> <span class="n">UNINITIALIZED_ATTR</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>  <span class="c1"># type: ignore[misc]</span>


<span class="k">class</span><span class="w"> </span><span class="nc">AttributeDocumenter</span><span class="p">(</span>  <span class="c1"># type: ignore[misc]</span>
    <span class="n">GenericAliasMixin</span><span class="p">,</span>
    <span class="n">SlotsMixin</span><span class="p">,</span>
    <span class="n">RuntimeInstanceAttributeMixin</span><span class="p">,</span>
    <span class="n">UninitializedInstanceAttributeMixin</span><span class="p">,</span>
    <span class="n">NonDataDescriptorMixin</span><span class="p">,</span>
    <span class="n">DocstringStripSignatureMixin</span><span class="p">,</span>
    <span class="n">ClassLevelDocumenter</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for attributes.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;attribute&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">option_spec</span><span class="p">:</span> <span class="n">ClassVar</span><span class="p">[</span><span class="n">OptionSpec</span><span class="p">]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">ModuleLevelDocumenter</span><span class="o">.</span><span class="n">option_spec</span><span class="p">)</span>
    <span class="n">option_spec</span><span class="p">[</span><span class="s1">&#39;annotation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation_option</span>
    <span class="n">option_spec</span><span class="p">[</span><span class="s1">&#39;no-value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bool_option</span>

    <span class="c1"># must be higher than the MethodDocumenter, else it will recognize</span>
    <span class="c1"># some non-data descriptors as methods</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_function_or_method</span><span class="p">(</span><span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">inspect</span><span class="o">.</span><span class="n">isfunction</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">or</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isbuiltin</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span> <span class="ow">or</span> <span class="n">inspect</span><span class="o">.</span><span class="n">ismethod</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">ModuleDocumenter</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isattributedescriptor</span><span class="p">(</span><span class="n">member</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isroutine</span><span class="p">(</span><span class="n">member</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="nb">type</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">document_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">update_annotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update __annotations__ to support type_comment and so on.&quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">annotations</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getannotations</span><span class="p">(</span><span class="n">parent</span><span class="p">))</span>
            <span class="n">parent</span><span class="o">.</span><span class="vm">__annotations__</span> <span class="o">=</span> <span class="n">annotations</span>

            <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmro</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">module</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">)</span>
                    <span class="n">qualname</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__qualname__&#39;</span><span class="p">)</span>

                    <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                    <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
                    <span class="n">anns</span> <span class="o">=</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">annotations</span>
                    <span class="k">for</span> <span class="p">(</span><span class="n">classname</span><span class="p">,</span> <span class="n">attrname</span><span class="p">),</span> <span class="n">annotation</span> <span class="ow">in</span> <span class="n">anns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">classname</span> <span class="o">==</span> <span class="n">qualname</span> <span class="ow">and</span> <span class="n">attrname</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
                            <span class="n">annotations</span><span class="p">[</span><span class="n">attrname</span><span class="p">]</span> <span class="o">=</span> <span class="n">annotation</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">PycodeError</span><span class="p">):</span>
                    <span class="k">pass</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
            <span class="c1"># Failed to set __annotations__ (built-in, extensions, etc.)</span>
            <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isenumattribute</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">value</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_annotations</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_real_modname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">real_modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">real_modname</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">should_suppress_value_header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">doc</span><span class="p">:</span>
                <span class="n">docstring</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">separate_metadata</span><span class="p">(</span>
                    <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">iadd</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="p">[]))</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;hide-value&#39;</span> <span class="ow">in</span> <span class="n">metadata</span><span class="p">:</span>
                    <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">annotation</span> <span class="ow">is</span> <span class="n">SUPPRESS</span>
            <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_suppress_directive_header</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">annotation</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :annotation: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">annotation</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="o">!=</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
                <span class="c1"># obtain type annotation for this attribute</span>
                <span class="n">annotations</span> <span class="o">=</span> <span class="n">get_type_hints</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span>
                    <span class="kc">None</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span><span class="p">,</span>
                    <span class="n">include_extras</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">annotations</span><span class="p">:</span>
                    <span class="n">mode</span> <span class="o">=</span> <span class="n">_get_render_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span><span class="p">)</span>
                    <span class="n">short_literals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span>
                    <span class="n">objrepr</span> <span class="o">=</span> <span class="n">stringify_annotation</span><span class="p">(</span>
                        <span class="n">annotations</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span>
                        <span class="n">mode</span><span class="p">,</span>
                        <span class="n">short_literals</span><span class="o">=</span><span class="n">short_literals</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :type: &#39;</span> <span class="o">+</span> <span class="n">objrepr</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">no_value</span>
                    <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">should_suppress_value_header</span><span class="p">()</span>
                    <span class="ow">or</span> <span class="n">ismock</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                <span class="p">):</span>
                    <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">objrepr</span> <span class="o">=</span> <span class="n">object_description</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :value: &#39;</span> <span class="o">+</span> <span class="n">objrepr</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_attribute_comment</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">attrname</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="bp">cls</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmro</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">module</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">)</span>
                <span class="n">qualname</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__qualname__&#39;</span><span class="p">)</span>

                <span class="n">analyzer</span> <span class="o">=</span> <span class="n">ModuleAnalyzer</span><span class="o">.</span><span class="n">for_module</span><span class="p">(</span><span class="n">module</span><span class="p">)</span>
                <span class="n">analyzer</span><span class="o">.</span><span class="n">analyze</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">qualname</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">:</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">qualname</span><span class="p">,</span> <span class="n">attrname</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">analyzer</span><span class="o">.</span><span class="n">attr_docs</span><span class="p">:</span>
                        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">analyzer</span><span class="o">.</span><span class="n">attr_docs</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">AttributeError</span><span class="p">,</span> <span class="n">PycodeError</span><span class="p">):</span>
                <span class="k">pass</span>

        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_doc</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Check the attribute has a docstring-comment</span>
        <span class="n">comment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attribute_comment</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">comment</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">comment</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Disable `autodoc_inherit_docstring` temporarily to avoid to obtain</span>
            <span class="c1"># a docstring from the value which descriptor returns unexpectedly.</span>
            <span class="c1"># See: https://github.com/sphinx-doc/sphinx/issues/7805</span>
            <span class="n">orig</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">get_doc</span><span class="p">()</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_inherit_docstrings</span> <span class="o">=</span> <span class="n">orig</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">more_content</span><span class="p">:</span> <span class="n">StringList</span> <span class="o">|</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Disable analyzing attribute comment on Documenter.add_content() to control it on</span>
        <span class="c1"># AttributeDocumenter.add_content()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analyzer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">more_content</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">more_content</span> <span class="o">=</span> <span class="n">StringList</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_content</span><span class="p">(</span><span class="n">more_content</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_content</span><span class="p">(</span><span class="n">more_content</span><span class="p">)</span>


<span class="k">class</span><span class="w"> </span><span class="nc">PropertyDocumenter</span><span class="p">(</span><span class="n">DocstringStripSignatureMixin</span><span class="p">,</span> <span class="n">ClassLevelDocumenter</span><span class="p">):</span>  <span class="c1"># type: ignore[misc]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specialized Documenter subclass for properties.&quot;&quot;&quot;</span>

    <span class="n">objtype</span> <span class="o">=</span> <span class="s1">&#39;property&#39;</span>
    <span class="n">member_order</span> <span class="o">=</span> <span class="mi">60</span>

    <span class="c1"># before AttributeDocumenter</span>
    <span class="n">priority</span> <span class="o">=</span> <span class="n">AttributeDocumenter</span><span class="o">.</span><span class="n">priority</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">can_document_member</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Documenter</span><span class="p">],</span> <span class="n">member</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">membername</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">isattr</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Any</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">ClassDocumenter</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isproperty</span><span class="p">(</span><span class="n">member</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="vm">__dict__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__dict__&#39;</span><span class="p">,</span> <span class="p">{})</span>
                <span class="n">obj</span> <span class="o">=</span> <span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">membername</span><span class="p">)</span>
                <span class="k">return</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">classmethod</span><span class="p">)</span> <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isproperty</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__func__</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">import_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raiseerror</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Check the existence of uninitialized instance attribute when failed to import</span>
<span class="sd">        the attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">import_object</span><span class="p">(</span><span class="n">raiseerror</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ret</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isproperty</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="vm">__dict__</span> <span class="o">=</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">,</span> <span class="s1">&#39;__dict__&#39;</span><span class="p">,</span> <span class="p">{})</span>
            <span class="n">obj</span> <span class="o">=</span> <span class="vm">__dict__</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">objpath</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="nb">classmethod</span><span class="p">)</span> <span class="ow">and</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isproperty</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="vm">__func__</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">object</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__func__</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">isclassmethod</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">isclassmethod</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">ret</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">format_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property_getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;&#39;</span>

        <span class="c1"># update the annotations of the property getter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_events</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="c1"># correctly format the arguments for a property</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">format_args</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">document_members</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">all_members</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_real_modname</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">real_modname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_attr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;__module__&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">real_modname</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">modname</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_directive_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sig</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">add_directive_header</span><span class="p">(</span><span class="n">sig</span><span class="p">)</span>
        <span class="n">sourcename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_sourcename</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isabstractmethod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :abstractmethod:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isclassmethod</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :classmethod:&#39;</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>

        <span class="n">func</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_property_getter</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">func</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints</span> <span class="o">==</span> <span class="s1">&#39;none&#39;</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">signature</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span>
                <span class="n">func</span><span class="p">,</span> <span class="n">type_aliases</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_type_aliases</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">signature</span><span class="o">.</span><span class="n">return_annotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">Parameter</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                <span class="n">mode</span> <span class="o">=</span> <span class="n">_get_render_mode</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">autodoc_typehints_format</span><span class="p">)</span>
                <span class="n">short_literals</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">python_display_short_literal_types</span>
                <span class="n">objrepr</span> <span class="o">=</span> <span class="n">stringify_annotation</span><span class="p">(</span>
                    <span class="n">signature</span><span class="o">.</span><span class="n">return_annotation</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">short_literals</span><span class="o">=</span><span class="n">short_literals</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_line</span><span class="p">(</span><span class="s1">&#39;   :type: &#39;</span> <span class="o">+</span> <span class="n">objrepr</span><span class="p">,</span> <span class="n">sourcename</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
                <span class="n">__</span><span class="p">(</span><span class="s1">&#39;Failed to get a function signature for </span><span class="si">%s</span><span class="s1">: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">fullname</span><span class="p">,</span> <span class="n">exc</span>
            <span class="p">)</span>
            <span class="k">pass</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_property_getter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;fget&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># property</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">fget</span>
        <span class="k">if</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="p">,</span> <span class="s1">&#39;func&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>  <span class="c1"># cached_property</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">func</span>
        <span class="k">return</span> <span class="kc">None</span>


<span class="k">def</span><span class="w"> </span><span class="nf">autodoc_attrgetter</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">*</span><span class="n">defargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">,</span> <span class="n">registry</span><span class="p">:</span> <span class="n">SphinxComponentRegistry</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Alternative getattr() for types&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">typ</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="n">registry</span><span class="o">.</span><span class="n">autodoc_attrgetters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">typ</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">defargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">safe_getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="o">*</span><span class="n">defargs</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="n">app</span><span class="p">:</span> <span class="n">Sphinx</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExtensionMetadata</span><span class="p">:</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">ModuleDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">ClassDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">ExceptionDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">DataDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">FunctionDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">DecoratorDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">MethodDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">AttributeDocumenter</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_autodocumenter</span><span class="p">(</span><span class="n">PropertyDocumenter</span><span class="p">)</span>

    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autoclass_content&#39;</span><span class="p">,</span>
        <span class="s1">&#39;class&#39;</span><span class="p">,</span>
        <span class="s1">&#39;env&#39;</span><span class="p">,</span>
        <span class="n">types</span><span class="o">=</span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;init&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_member_order&#39;</span><span class="p">,</span>
        <span class="s1">&#39;alphabetical&#39;</span><span class="p">,</span>
        <span class="s1">&#39;env&#39;</span><span class="p">,</span>
        <span class="n">types</span><span class="o">=</span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;alphabetical&#39;</span><span class="p">,</span> <span class="s1">&#39;bysource&#39;</span><span class="p">,</span> <span class="s1">&#39;groupwise&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_class_signature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;mixed&#39;</span><span class="p">,</span>
        <span class="s1">&#39;env&#39;</span><span class="p">,</span>
        <span class="n">types</span><span class="o">=</span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;mixed&#39;</span><span class="p">,</span> <span class="s1">&#39;separated&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span><span class="s1">&#39;autodoc_default_options&#39;</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">({</span><span class="nb">dict</span><span class="p">}))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_docstring_signature&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">({</span><span class="nb">bool</span><span class="p">})</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_mock_imports&#39;</span><span class="p">,</span> <span class="p">[],</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">({</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">})</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_typehints&#39;</span><span class="p">,</span>
        <span class="s1">&#39;signature&#39;</span><span class="p">,</span>
        <span class="s1">&#39;env&#39;</span><span class="p">,</span>
        <span class="n">types</span><span class="o">=</span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;signature&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_typehints_description_target&#39;</span><span class="p">,</span>
        <span class="s1">&#39;all&#39;</span><span class="p">,</span>
        <span class="s1">&#39;env&#39;</span><span class="p">,</span>
        <span class="n">types</span><span class="o">=</span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="s1">&#39;documented&#39;</span><span class="p">,</span> <span class="s1">&#39;documented_params&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span><span class="s1">&#39;autodoc_type_aliases&#39;</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">({</span><span class="nb">dict</span><span class="p">}))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_typehints_format&#39;</span><span class="p">,</span>
        <span class="s1">&#39;short&#39;</span><span class="p">,</span>
        <span class="s1">&#39;env&#39;</span><span class="p">,</span>
        <span class="n">types</span><span class="o">=</span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;fully-qualified&#39;</span><span class="p">,</span> <span class="s1">&#39;short&#39;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span><span class="s1">&#39;autodoc_warningiserror&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">({</span><span class="nb">bool</span><span class="p">}))</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_config_value</span><span class="p">(</span>
        <span class="s1">&#39;autodoc_inherit_docstrings&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;env&#39;</span><span class="p">,</span> <span class="n">types</span><span class="o">=</span><span class="nb">frozenset</span><span class="p">({</span><span class="nb">bool</span><span class="p">})</span>
    <span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">&#39;autodoc-before-process-signature&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">&#39;autodoc-process-docstring&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">&#39;autodoc-process-signature&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">&#39;autodoc-skip-member&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">add_event</span><span class="p">(</span><span class="s1">&#39;autodoc-process-bases&#39;</span><span class="p">)</span>

    <span class="n">app</span><span class="o">.</span><span class="n">setup_extension</span><span class="p">(</span><span class="s1">&#39;sphinx.ext.autodoc.preserve_defaults&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">setup_extension</span><span class="p">(</span><span class="s1">&#39;sphinx.ext.autodoc.type_comment&#39;</span><span class="p">)</span>
    <span class="n">app</span><span class="o">.</span><span class="n">setup_extension</span><span class="p">(</span><span class="s1">&#39;sphinx.ext.autodoc.typehints&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="n">sphinx</span><span class="o">.</span><span class="n">__display_version__</span><span class="p">,</span>
        <span class="s1">&#39;parallel_read_safe&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">}</span>
</pre></div>

    
  <div class="related-pages" role="navigation" aria-label="Related">
    
    <div></div>
    
  </div>

  </div>
</div>
<div class="footer" role="contentinfo">
  
    &#169; 版權所有 2007-2026, the Sphinx developers.
  使用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3 建立。
</div>
  </body>
</html>